(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[45],{Danc:function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"q-pa-md"},[n("q-btn",{attrs:{label:"test"},on:{click:e.test2}}),n("q-chip",{staticClass:"q-title q-mt-md",attrs:{detail:"",square:"",icon:"timeline"}},[e._v("Hit Rates")]),n("div",{staticClass:"flex"},[n("div",{staticClass:"row inline"},[n("div",{staticClass:"col-11 q-ma-md"},[n("q-list",{attrs:{"inset-separator":"",link:""}},[n("q-list-header",[e._v("Events")]),e._l(e.getEventsWithSeason,function(t){return n("q-item",{key:t[".key"]},[n("div",{on:{click:function(n){e.clickEvent(t)}}},[n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v(e._s(t.eventName))])],1)],1)])})],2)],1)]),n("div",{staticClass:"col q-ma-md"},[n("q-table",{attrs:{id:"content",grid:"","hide-header":"",data:e.getDataTable,columns:e.columns,filter:e.filter,"no-data-label":"No Batches Yet","row-key":"name","hide-bottom":""},scopedSlots:e._u([{key:"top-left",fn:function(t){return["seasonType"===e.reportType?n("span",{staticClass:"q-title"},[e._v(e._s(e.selectedEvent.eventName))]):e._e(),("batchType"===e.reportType||t.inFullscreen,e._e()),!t.inFullscreen?e._e():n("p",{staticClass:"q-headline"},[e._v(e._s(e.selectedEvent.eventName)+" - "+e._s(e.selectedSeason))])]}},{key:"top-right",fn:function(t){return[t.inFullscreen?e._e():n("q-select",{staticStyle:{width:"110px"},attrs:{"stack-label":"Report Type",options:e.reportTypeOpt},model:{value:e.reportType,callback:function(t){e.reportType=t},expression:"reportType"}}),n("div",{staticClass:"noprint"},[n("q-btn",{attrs:{flat:"",dense:"",label:"Print",icon:"print"},on:{click:function(n){e.isPrint(t)}}}),!t.inFullscreen?e._e():n("q-btn",{attrs:{flat:"",dense:"",icon:"close",label:"close"},on:{click:t.toggleFullscreen}})],1)]}},{key:"item",fn:function(t){return n("div",{staticClass:"q-pa-xs col-xs-12 col-sm-6 col-md-4 transition-generic",style:t.selected?"transform: scale(0.95);":""},[n("q-card",{staticClass:"transition-generic cursor-pointer",class:t.selected?"bg-grey-2":"",nativeOn:{click:function(e){t.selected=!t.selected}}},[n("q-card-title",{staticClass:"relative-position"},["seasonType"===e.reportType?n("span",{staticClass:"q-title"},[e._v("Season "+e._s(t.row.seasonNumber))]):e._e(),"batchType"===e.reportType?n("span",{staticClass:"q-subtitle"},[e._v("Batch "+e._s(t.row.batchNumber))]):e._e()]),n("q-card-separator"),n("q-card-main",{staticClass:"q-pa-none"},[n("q-list",{attrs:{"no-border":""}},e._l(t.cols.filter(function(e){return"desc"!==e.name}),function(s){return n("q-item",{key:s.name},[n("q-item-main",[n("q-item-tile",{attrs:{label:""}},[e._v(e._s(s.label))])],1),n("q-item-side",{attrs:{right:""}},["registrants"===s.name?n("q-item-tile",[e._v(e._s(e.getRegistrantsLength(t)))]):e._e(),"showUps"===s.name?n("q-item-tile",[e._v(e._s(e.getShowUp(t)))]):e._e(),"noShow"===s.name?n("q-item-tile",[e._v(e._s(e.getNoShow(t)))]):e._e(),"signed"===s.name?n("q-item-tile",[e._v(e._s(e.getSigned(t)))]):e._e(),"hitrateShowUp"===s.name?n("q-item-tile",[e._v(e._s(e.getHitShowUp(t))+" %")]):e._e(),"hitrateSigned"===s.name?n("q-item-tile",[e._v(e._s(e.getHitSigned(t))+" %")]):e._e()],1)],1)}))],1)],1)],1)}}])})],1)])],1)},a=[],i=(n("a1Th"),n("rGqo"),n("5JmO")),o=n("TruH");i.vfs=o.pdfMake.vfs;var r="",l=new XMLHttpRequest;l.open("GET","assets/mma.png",!0),l.responseType="blob",l.onload=function(e){var t=new FileReader;t.onload=function(e){r=e.target.result};var n=this.response;t.readAsDataURL(n)},l.send();var c={created:function(){if(this.loadSelectEvent(),this.$q.localStorage.has("user")){var e=this.$q.localStorage.get.item("user");this.$bindAsArray("userLoggedIn",this.$database.ref("users").orderByKey().equalTo(e))}},mounted:function(){this.$bindAsArray("events",this.$database.ref("events")),this.$store.state.startUp.events=this.events,this.$bindAsArray("models",this.$database.ref("models")),this.$bindAsArray("schedules",this.$database.ref("event_schedules")),this.$bindAsArray("contractSigned",this.$database.ref("contractSigned")),this.$bindAsArray("showUpModels",this.$database.ref("showUpModels")),console.log("store in state",this.$store.state.startUp.events),this.selectedEvent=this.$store.state.startUp.events[0],this.loadSelectEvent()},watch:{timeNow:{handler:function(e,t){console.log("newd",e),console.log("oldD",t),this.selectedEvent&&this.loadSelectEvent()},deep:!0}},computed:{getEventsWithSeason:function(){var e=this,t=new Array;return this.$lodash.forEach(this.events,function(n){e.$lodash.has(n,"seasons")&&t.push(n)}),t},timeNow:function(){return Date.now()},getDataTable:function(){return"batchType"===this.reportType?this.getEventBatches:this.getEventSeasons},eventSeasonsOpt:function(){try{console.log("seasons",this.selectedEvent);var e=this.$lodash.map(this.selectedEvent.seasons,function(e){return{label:"Season ".concat(e.seasonNumber),value:e.seasonName}});console.log("map season",e);var t=this.$lodash.orderBy(e,["label"],["desc"]);return t}catch(e){return[]}},getEventSeasons:function(){return console.log("event seasons in select",this.selectedEvent.seasons),this.selectedEvent.seasons},getEventBatches:function(){var e=this;try{console.log("sched",this.schedules);var t=this.$lodash.filter(this.schedules,function(t){return t.eventKey===e.selectedEvent[".key"]&&t.seasonName===e.selectedSeason});return console.log("filterBatches",t),t}catch(e){return[]}}},data:function(){return{userLoggedIn:[],selectedSeason:"",selectedEvent:{},events:[],schedules:[],contractSigned:[],models:[],showUpModels:[],reportType:"batchType",reportTypeOpt:[{label:"Batch",value:"batchType"},{label:"Season",value:"seasonType"}],filter:"",columns:[{name:"registrants",required:!0,label:"No. of Registrants",align:"left",field:"registrants"},{name:"showUps",required:!0,label:"No. of Show Up",align:"left",field:"showUps"},{name:"noShow",required:!0,label:"No. of No Show",align:"left"},{name:"signed",required:!0,label:"No. of Signed",align:"left"},{name:"hitrateShowUp",required:!0,label:"Hitrate % ShowUps",align:"left"},{name:"hitrateSigned",required:!0,label:"Hitrate % Signed",align:"left"}],tableData:[{name:"a",calories:"100",fat:"50",carbs:"10",protien:"20",sodium:"30",calcium:"40",iron:"60"},{name:"b",calories:"100",fat:"50",carbs:"10",protien:"20",sodium:"30",calcium:"40",iron:"60"},{name:"c",calories:"100",fat:"50",carbs:"10",protien:"20",sodium:"30",calcium:"40",iron:"60"}]}},methods:{isPrint:function(e){this.printPdf()},isEmpty:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},getLatestSeason:function(e){var t=e.seasons[e.seasons.length-1];return t},loadSelectEvent:function(){try{this.selectedEvent=this.$store.state.startUp.events[0],console.log("selected event",this.$store.state.startUp.events[0]),this.selectedSeason=this.getLatestSeason(this.selectedEvent).seasonName}catch(e){this.selectedEvent={}}},clickEvent:function(e){console.log("event",e),this.selectedEvent=e,this.selectedSeason=this.getLatestSeason(e).seasonName},getRegistrantsLength:function(e){try{if("batchType"===this.reportType){var t=e.row[".key"],n=this.$lodash.filter(this.models,function(e){return e.batchKey===t}),s=this.$lodash.filter(this.showUpModels,function(e){return e.batchKey===t}),a=this.$lodash.filter(this.contractSigned,function(e){return e.batchKey===t}),i=n.length+s.length+a.length;return i}console.log("p",e);var o=e.row.seasonName,r=this.$lodash.filter(this.models,function(e){return e.seasonName===o}),l=this.$lodash.filter(this.showUpModels,function(e){return e.seasonName===o}),c=this.$lodash.filter(this.contractSigned,function(e){return e.seasonName===o}),h=r.length+l.length+c.length;return h}catch(e){return 0}},getShowUp:function(e){try{if("batchType"===this.reportType){var t=e.row[".key"],n=this.$lodash.filter(this.showUpModels,function(e){return e.batchKey===t}),s=this.$lodash.filter(this.contractSigned,function(e){return e.batchKey===t}),a=n.length+s.length;return a}var i=e.row.seasonName,o=this.$lodash.filter(this.showUpModels,function(e){return e.seasonName===i}),r=this.$lodash.filter(this.contractSigned,function(e){return e.seasonName===i}),l=o.length+r.length;return l}catch(e){return 0}},getNoShow:function(e){try{var t=this.getRegistrantsLength(e),n=this.getShowUp(e);return t-n}catch(e){return 0}},getSigned:function(e){if("batchType"===this.reportType){var t=e.row[".key"],n=this.$lodash.filter(this.contractSigned,function(e){return e.batchKey===t});return n.length}var s=e.row.seasonName,a=this.$lodash.filter(this.contractSigned,function(e){return e.seasonName===s});return a.length},getHitShowUp:function(e){try{var t=this.getRegistrantsLength(e),n=this.getShowUp(e),s=parseFloat(n)/parseFloat(t),a=100*s||0;return a.toFixed(2)}catch(e){return 0}},getHitSigned:function(e){try{var t=this.getSigned(e),n=this.getShowUp(e),s=parseFloat(t)/parseFloat(n),a=100*s||0;return a.toFixed(2)}catch(e){return 0}},test:function(){},printPdf:function(){var e=this,t=this.$lodash.map(this.columns,function(e){return{text:e.label}}),n="seasonType"===this.reportType?"Season":"Batch";t.splice(0,0,{text:n}),console.log("columns",t);var s=[],a=[],o=[],l=[],c=[],h=[];this.$lodash.forEach(this.getDataTable,function(t){var n={};n.row=t,s.push(e.getRegistrantsLength(n)),a.push(e.getShowUp(n)),o.push(e.getNoShow(n)),l.push(e.getSigned(n)),c.push(e.getHitShowUp(n)),h.push(e.getHitSigned(n))}),console.log("regLen",s,a,o,l,c,h);for(var d=[],u=0;u<this.getDataTable.length;u++){var g=[u+1,s[u],a[u],o[u],l[u],c[u],h[u]];d.push(g)}console.log("toBody",d);for(var p=this,f=r,m={pageMargins:[40,40,40,60],footer:function(e,t){return{table:{widths:"*",body:[[{text:"Date prepared: ".concat(p.$moment(new Date).format("lll")),margin:[40,0,0,0]},{text:"",alignment:"left",style:"normalText",aligment:"right"}],[{text:"Prepared By: ".concat(p.userLoggedIn[0].lastName,", ").concat(p.userLoggedIn[0].firstName),margin:[40,0,0,0]},{text:"",alignment:"left",style:"normalText",aligment:"right"}],[{text:"Approved By: ",margin:[40,0,0,0]},{text:"Page "+e.toString()+" of "+t,alignment:"right",style:"normalText",aligment:"right",margin:[0,0,40,0]}]]},layout:"noBorders"}},content:[{image:f,width:100,height:70,alignment:"center"},{text:"3rd Floor Forab Building Kamuning Quezon City",alignment:"center",margin:[5,5,5,5]},{text:"".concat(this.getDataTable[0].eventName," Season ").concat(this.getDataTable[0].seasonNumber),style:"header",margin:[10,10,10,10]},{text:"Hit Rate Reports",alignment:"left",margin:[5,5,5,5]},{style:"tableExample",table:{headerRows:1,body:[t]},layout:{hLineWidth:function(e,t){return 0===e||e===t.table.body.length?2:1},vLineWidth:function(e,t){return 0===e||e===t.table.widths.length?2:1},hLineColor:function(e,t){return 0===e||e===t.table.body.length?"black":"gray"},vLineColor:function(e,t){return 0===e||e===t.table.widths.length?"black":"gray"},fillColor:function(e,t){return e%2===0?"#CCCCCC":null}}}],styles:{header:{fontSize:12,bold:!0,margin:[0,0,0,10]},tableExample:{fontSize:8,margin:[30,1,30,10]}}},v=0;v<d.length;v++)m.content[4].table.body.push(d[v]);i.createPdf(m).download("HitRate_".concat(p.$moment(new Date).format("lll")))},test2:function(){console.log("this.userLoggedIn",this.userLoggedIn)}}},h=c,d=(n("gkOh"),n("KHd+")),u=Object(d["a"])(h,s,a,!1,null,null,null);t["default"]=u.exports},Zx49:function(e,t,n){},gkOh:function(e,t,n){"use strict";var s=n("Zx49"),a=n.n(s);a.a}}]);