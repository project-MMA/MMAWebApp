(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[48],{fpFE:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-page",{staticClass:"q-pa-md"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-4-md q-px-md"},[a("p",{staticClass:"q-headline"},[t._v("Total Sales: "+t._s(t._f("currency")(t.getTotalSales)))]),a("p",{staticClass:"q-title"},[t._v("Sales Percent (%): "+t._s(t.getSalesPercent)+"%")]),a("apexcharts",{staticStyle:{"min-width":"250px"},attrs:{width:"450",height:"200",type:"line",options:t.getSalesChartData.chartOpt,series:t.getSalesChartData.series}})],1),a("div",{staticClass:"col-md"},[a("q-btn",{attrs:{icon:"print",label:"Print"},on:{click:function(e){t.print()}}}),a("q-table",{staticStyle:{"border-radius":"20px"},attrs:{title:"Top Events",data:t.topEventTable,columns:t.columns,"row-key":"name","hide-bottom":""},scopedSlots:t._u([{key:"body-cell-index",fn:function(e){return a("q-td",{attrs:{props:e}},[a("p",[t._v(t._s(e.row.__index+1))])])}}])})],1)])])},s=[],o=(a("91GP"),a("lSNA")),r=a.n(o),i=(a("a1Th"),a("pIFo"),a("rGqo"),a("yt8O"),a("RIqP")),l=a.n(i),c=a("EyHm"),d=a.n(c),h=a("5JmO"),u=a("TruH");h.vfs=u.pdfMake.vfs;var m="",g=new XMLHttpRequest;g.open("GET","assets/mma.png",!0),g.responseType="blob",g.onload=function(t){var e=new FileReader;e.onload=function(t){m=t.target.result};var a=this.response;e.readAsDataURL(a)},g.send();var f={components:{apexcharts:d.a},created:function(){if(this.$q.localStorage.has("user")){var t=this.$q.localStorage.get.item("user");this.$bindAsArray("userLoggedIn",this.$database.ref("users").orderByKey().equalTo(t))}},mounted:function(){this.$bindAsArray("events",this.$database.ref("events")),this.$bindAsArray("contractSigned",this.$database.ref("contractSigned")),this.$bindAsArray("schedules",this.$database.ref("event_schedules")),this.$bindAsArray("models",this.$database.ref("models")),this.$bindAsArray("showUps",this.$database.ref("showUpModels")),this.$bindAsArray("payments",this.$database.ref("payment_transactions"))},computed:{topEventTable:function(){var t=this,e=this.$lodash.groupBy(this.contractSigned,"eventName"),a=this.$lodash.map(e,function(e,a,n){console.log("obj[key]",n[a][0].eventKey);var s={totalSales:t.getTotalSales2(n[a][0].eventKey),models:n[a].length,eventName:a};return s});return console.log("dataMap",a),this.$lodash.orderBy(a,"models","desc")},getSalesPercent:function(){var t=this;try{console.log("payments",this.payments);var e=l()(this.payments),a=this.$lodash.map(e,function(e){var a=t.$moment(new Date(e.create_time),"YYYY-MM-DD").format("MMMM");return e.dateMonthAdded=a,e}),n=this.$lodash.groupBy(a,"dateMonthAdded"),s=(this.$lodash.keys(n),this.$lodash.map(n,function(e,a,n){return t.$lodash.forEach(e,function(t){t.transaction_amount=parseFloat(t.transaction_amount)}),n[a]=t.$lodash.sumBy(e,"transaction_amount"),n[a]})),o=s.length,r=s[o-2],i=s[o-1];if("undefined"===typeof r)return 100;var c=parseFloat(r)/parseFloat(i)*100;return c.toFixed(2)}catch(t){return 0}},getSalesChartData:function(){var t=this;try{var e=l()(this.payments),a=this.$lodash.map(e,function(e){var a=t.$moment(new Date(e.create_time),"YYYY-MM-DD").format("MMMM");return e.dateMonthAdded=a,e}),n=this.$lodash.groupBy(a,"dateMonthAdded"),s=this.$lodash.keys(n),o=this.$lodash.map(n,function(e,a,n){return t.$lodash.forEach(e,function(t){t.transaction_amount=parseFloat(t.transaction_amount)}),n[a]=t.$lodash.sumBy(e,"transaction_amount"),n[a]}),r={chart:{id:"HitRateChart"},xaxis:{categories:s}},i=[{name:"HitRate",data:l()(o)}],c={chartOpt:r,series:i};return c}catch(t){return[]}},getTotalSales:function(){var t=this;try{var e=l()(this.payments),a=this.$lodash.map(e,function(e){var a=t.$moment(new Date(e.create_time),"YYYY-MM-DD").format("YYYY");return e.dateYearAdded=a,e}),n=this.$lodash.groupBy(a,"dateYearAdded"),s=this.$lodash.keys(n);console.log("years",s);var o=this.$lodash.map(n,function(e,a,n){return t.$lodash.forEach(e,function(t){t.transaction_amount=parseFloat(t.transaction_amount)}),n[a]=t.$lodash.sumBy(e,"transaction_amount"),n}),r=this.$moment(new Date,"YYYY-MM-DD").format("YYYY");return o[0][r]}catch(t){return 0}},getEventsWithSeason:function(){var t=this,e=new Array;return this.$lodash.forEach(this.events,function(a){t.$lodash.has(a,"seasons")&&e.push(a)}),e},getEventSeasons:function(){return console.log("event seasons in select",this.selectedEvent.seasons),this.selectedEvent.seasons}},data:function(){return{showUps:[],selectedEvent:{},graphSeasons:[],payments:[],data:[{name:"Teen Fashion Festival",data:{Season1:10032,Season2:1001492,Season3:100150,Season4:100500}}],events:[],models:[],schedules:[],contractSigned:[],showUpModels:[],paymentTransactions:[],columns:[{name:"index",required:!0,align:"left",field:"__index",label:"No.",sortable:!0,classes:"my-class",style:"width: 500px"},{name:"eventName",required:!0,align:"left",label:"Event",field:"eventName",sortable:!0},{name:"models",required:!0,align:"center",label:"Models",field:"models",sortable:!0},{name:"totalSales",required:!0,align:"center",label:"Total Sales",field:"totalSales",sortable:!0}],tableData:[{name:"Frozen Yogurt",calories:159,fat:6,carbs:24,protein:4,sodium:87,calcium:"14%",iron:"1%"},{name:"Frozen Yogurts",calories:159,fat:6,carbs:24,protein:4,sodium:87,calcium:"14%",iron:"1%"}]}},methods:{getTotalSales2:function(t){var e=this.$lodash.filter(this.payments,function(e){return e.eventKey===t}),a=this.$lodash.sumBy(e,"transaction_amount");return"P "+a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},getGrossSales:function(t){console.log("p",t);var e=t.row.seasonName,a=this.$lodash.filter(this.paymentTransactions,function(t){return t.seasonName===e}),n=this.$lodash.sumBy(a,function(t){return t.transaction_amount=parseFloat(t.transaction_amount),t.transaction_amount});return console.log("filter trans",n),n},getFullPaid:function(t){var e=t.row.seasonName,a=this.$lodash.filter(this.contractSigned,function(t){return t.seasonName===e}),n=this.$lodash.filter(a,function(t){return"full"===t.paymentTerms});return console.log("fullterm",n),n.length},getInstallment:function(t){var e=t.row.seasonName,a=this.$lodash.filter(this.contractSigned,function(t){return t.seasonName===e}),n=this.$lodash.filter(a,function(t){return"installment"===t.paymentTerms});return n.length},loadSelectedEvent:function(){this.selectedEvent=this.$store.state.startUp.events[0],this.test()},getContractSigned:function(t){var e=t.row.seasonName,a=this.$lodash.filter(this.contractSigned,function(t){return t.seasonName===e});return a.length},clickEvent:function(t){this.selectedEvent=t,this.test(),console.log("event",this.selectedEvent)},getGrossSales2:function(t){console.log("p",t);var e=this,a=t.seasonName,n=e.$lodash.filter(e.paymentTransactions,function(t){return t.seasonName===a}),s=e.$lodash.sumBy(n,function(t){return t.transaction_amount=parseFloat(t.transaction_amount),t.transaction_amount});return console.log("filter trans",s),s},print:function(){var t=this.$lodash.map(this.columns,function(t){return{text:t.label,style:"header"}});this.eventName;console.log("columns",t);for(var e=[],a=l()(this.topEventTable),n=0;n<a.length;n++){a[n].paymentTerms&&a[n].paymentTerms;var s=[n+1,a[n].eventName,a[n].models,a[n].totalSales];e.push(s)}for(var o=this,r=this.$moment(new Date,"YYYY-MM-DD").format("YYYY"),i={pageMargins:[40,40,40,60],footer:function(t,e){return{table:{widths:"*",body:[[{text:"Date prepared: ".concat(o.$moment(new Date).format("lll")),margin:[40,0,0,0]},{text:"",alignment:"left",style:"normalText",aligment:"right"}],[{text:"Prepared By: ".concat(o.userLoggedIn[0].lastName,", ").concat(o.userLoggedIn[0].firstName),margin:[40,0,0,0]},{text:"",alignment:"left",style:"normalText",aligment:"right"}],[{text:"Approved By: ",margin:[40,0,0,0]},{text:"Page "+t.toString()+" of "+e,alignment:"right",style:"normalText",aligment:"right",margin:[0,0,40,0]}]]},layout:"noBorders"}},content:[{image:m,width:100,height:70,alignment:"center"},{text:"3rd Floor Forab Building Kamuning Quezon City",alignment:"center",margin:[5,5,5,5]},{text:"Sales Report: ".concat(r),alignment:"left",margin:[5,5,5,5]},{style:"tableExample",table:{headerRows:1,body:[t]},layout:{hLineWidth:function(t,e){return 0===t||t===e.table.body.length?2:1},vLineWidth:function(t,e){return 0===t||t===e.table.widths.length?2:1},hLineColor:function(t,e){return 0===t||t===e.table.body.length?"black":"gray"},vLineColor:function(t,e){return 0===t||t===e.table.widths.length?"black":"gray"}}},{text:"Total Sales: P ".concat(o.getTotalSales.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")),alignment:"left",margin:[1,1,1,1]},{text:"Sales Percent (%): ".concat(o.getSalesPercent,"%"),alignment:"left",margin:[1,1,1,1]}],styles:{header:{fontSize:12,bold:!0,margin:[0,0,0,10]},tableExample:{alignment:"center",fontSize:8,margin:[140,1,0,10]}}},c=0;c<e.length;c++)i.content[3].table.body.push(e[c]);console.log("dd",i),h.createPdf(i).download("SalesReport_".concat(r))},test:function(){var t=this,e=this.$lodash.map(this.selectedEvent.seasons,function(e){var a="Season".concat(e.seasonNumber),n=t.getGrossSales2(e);return console.log("name gross",a,n),r()({},a,n)}),a=new Array,n={name:this.selectedEvent.eventName,data:Object.assign({},e[0])};a.push(n),this.graphSeasons=a},test2:function(){console.log("getTotalSales",this.getTotalSales())}}},p=f,v=a("KHd+"),y=Object(v["a"])(p,n,s,!1,null,null,null);e["default"]=y.exports}}]);