(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[39],{BmqP:function(t,e,a){"use strict";var n=a("Q2gK"),i=a.n(n);i.a},Q2gK:function(t,e,a){},"eZ/2":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.byBatchShow?a("div",{staticClass:"col-3 q-ma-md"},[a("q-table",{attrs:{title:"",data:t.ByBatchTableData,loading:t.tableLoading,columns:t.columns,pagination:t.pagination,separator:"cell","no-data-label":"Empty Activities","row-key":"id",filter:t.filter},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"top-right",fn:function(e){return[a("q-btn-group",{staticClass:"q-ma-sm",attrs:{rounded:""}},[a("q-btn",{attrs:{color:"primary",rounded:"",label:"By Batch"},on:{click:t.showByBatch}}),a("q-btn",{attrs:{color:"secondary",rounded:"",label:"By Day"},on:{click:t.showFullDay}})],1),a("q-select",{staticClass:"text-white",staticStyle:{"min-width":"150px"},attrs:{inverted:"",color:"dark",options:t.mapActivities,"stack-label":"Activities"},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})]}},{key:"top-left",fn:function(e){return[a("h4",{staticClass:"q-mr-lg"},[t._v("Upcoming Schedule")]),a("q-toggle",{attrs:{label:"See All Schedules","checked-icon":"visibility","unchecked-icon":"visibility_off"},model:{value:t.seeAll,callback:function(e){t.seeAll=e},expression:"seeAll"}})]}},{key:"body-cell-activity",fn:function(e){return a("q-td",{attrs:{props:e}},[t._v("\r\n            "+t._s(e.row.upcomingAct)+"\r\n        ")])}},{key:"body-cell-date",fn:function(e){return a("q-td",{attrs:{props:e}},[t._v("\r\n            "+t._s(t.$moment(e.row.date).format("ll"))+"\r\n            ")])}},{key:"body-cell-time",fn:function(e){return a("q-td",{attrs:{props:e}},[t._v("\r\n            "+t._s(t.$moment(e.row.forSort).format("LT"))+"\r\n            ")])}},{key:"body-cell-action",fn:function(e){return a("q-td",{attrs:{props:e}},[a("q-btn",{attrs:{color:"primary",to:{name:"attendanceList",params:{id:e.row.key,title:e.row.id,type:e.row.upcomingAct}}}},[t._v("\r\n              attendance List\r\n            ")]),a("q-btn",{staticClass:"q-ml-sm",attrs:{color:"secondary",icon:"print"},on:{click:function(a){t.selectedAttendancePrint(e.row)}}})],1)}}])})],1):t._e(),t.fullDayShow?a("div",{staticClass:"col-3 q-ma-md"},[a("q-table",{attrs:{data:t.getFullDayTableData,loading:t.tableLoading,columns:t.fullDayColumns,pagination:t.pagination,separator:"cell","no-data-label":"Empty Activities","row-key":".key",filter:t.filter},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"top-right",fn:function(e){return[a("q-btn-group",{staticClass:"q-ma-sm",attrs:{rounded:""}},[a("q-btn",{attrs:{color:"primary",rounded:"",label:"By Batch"},on:{click:t.showByBatch}}),a("q-btn",{attrs:{color:"secondary",rounded:"",label:"By Day"},on:{click:t.showFullDay}})],1),a("q-select",{staticClass:"text-white",staticStyle:{"min-width":"150px"},attrs:{inverted:"",color:"dark",options:t.mapActivities,"stack-label":"Activities"},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})]}},{key:"top-left",fn:function(e){return[a("h4",{staticClass:"q-mr-lg"},[t._v("Upcoming Schedule"),a("span",{staticClass:"text-secondary text-weight-bold"},[t._v(" Day View")])]),a("q-toggle",{attrs:{label:"See All Schedules","checked-icon":"visibility","unchecked-icon":"visibility_off"},model:{value:t.seeAllFullDay,callback:function(e){t.seeAllFullDay=e},expression:"seeAllFullDay"}})]}},{key:"body-cell-date",fn:function(e){return a("q-td",{attrs:{props:e}},[t._v("\r\n            "+t._s(t.$moment(e.row.date).format("ll"))+"\r\n            ")])}},{key:"body-cell-batches",fn:function(e){return a("q-td",{attrs:{props:e}},t._l(e.row.batchTitles,function(e){return a("q-list",{key:e,staticClass:"no-border",attrs:{dense:""}},[a("q-item",{staticClass:"q-caption align-center"},[t._v(t._s(e))])],1)}))}},{key:"body-cell-action",fn:function(e){return a("q-td",{attrs:{props:e}},[a("q-btn",{attrs:{color:"primary",to:{name:"attendanceFullDay",params:{id:e.row.routerParam,date:e.row.date,type:e.row.type}}}},[t._v("\r\n              attendance List\r\n            ")]),a("q-btn",{staticClass:"q-ml-sm",attrs:{color:"secondary",icon:"print"},on:{click:function(a){t.selectedFullAttendancePrint(e.row)}}})],1)}}])})],1):t._e(),a("q-modal",{attrs:{"content-css":{minWidth:"100vw",minHeight:"100vh"},maximized:""},model:{value:t.showPrintModal,callback:function(e){t.showPrintModal=e},expression:"showPrintModal"}},[a("q-modal-layout",{staticClass:"text-center"},[a("q-toolbar",{staticClass:"noprint",attrs:{slot:"header",color:"dark"},slot:"header"},[a("q-btn",{staticClass:"fixed-right q-ma-sm",attrs:{flat:"",round:"",dense:"",icon:"clear"},on:{click:function(e){t.showPrintModal=!1}}}),a("q-btn",{attrs:{"icon-right":"print",color:"secondary",label:"print"},on:{click:function(e){t.printPdf()}}}),a("q-toolbar-title",[a("span",{staticClass:"capitalize"},[t._v(t._s(t.selectedAttendance.id))])])],1),a("div",{staticClass:"absolute-center row modal_size text-center q-mt-lg"},[a("q-table",{staticClass:"no-shadow",staticStyle:{width:"95vw",height:"95vh"},attrs:{title:"",data:t.getModels,loading:t.tableLoading,columns:t.Modelcolumns,pagination:t.Modelpagination,separator:"cell","hide-bottom":"","row-key":".key",filter:t.filter},on:{"update:pagination":function(e){t.Modelpagination=e}},scopedSlots:t._u([{key:"top",fn:function(e){return[a("span",{staticClass:"capitalize q-display-1"},[t._v(t._s(t.selectedAttendance.seasonName)+"  - Batch "+t._s(t.selectedAttendance.batchNumber)+" "+t._s(t.selectedAttendance.upcomingAct))])]}},{key:"body-cell-fullname",fn:function(e){return a("q-td",{attrs:{props:e}},[a("span",{staticClass:"q-title capitalize"},[t._v(t._s(e.row.firstName)+" "+t._s(e.row.lastName))])])}}])})],1)],1)],1),a("q-modal",{attrs:{"content-css":{minWidth:"100vw",minHeight:"100vh"},maximized:""},model:{value:t.showFullPrintModal,callback:function(e){t.showFullPrintModal=e},expression:"showFullPrintModal"}},[a("q-modal-layout",{staticClass:"text-center"},[a("q-toolbar",{staticClass:"noprint",attrs:{slot:"header",color:"dark"},slot:"header"},[a("q-btn",{staticClass:"fixed-right q-ma-sm",attrs:{flat:"",round:"",dense:"",icon:"clear"},on:{click:function(e){t.showFullPrintModal=!1}}}),a("q-btn",{attrs:{"icon-right":"print",color:"secondary",label:"print"},on:{click:function(e){t.printPdf()}}}),a("q-toolbar-title",[a("span",{staticClass:"capitalize"},[t._v(t._s(t.selectedFull.date))])])],1),a("div",{staticClass:"absolute-center row modal_size text-center q-mt-lg"},[a("q-table",{staticClass:"no-shadow",staticStyle:{width:"95vw",height:"95vh"},attrs:{title:"",data:t.getModelsFull,loading:t.tableLoading,"rows-per-page-options":t.RowsPage,columns:t.ModelFullcolumns,pagination:t.Modelpagination,separator:"cell","hide-bottom":"","row-key":"accountNumber",filter:t.filter},on:{"update:pagination":function(e){t.Modelpagination=e}},scopedSlots:t._u([{key:"top",fn:function(e){return t._l(t.selectedFull.batchTitles,function(e){return a("div",{key:e.value,staticClass:"full-width"},[a("h6",{staticClass:"q-ma-xs"},[t._v(t._s(e))])])})}},{key:"body-cell-fullname",fn:function(e){return a("q-td",{attrs:{props:e}},[a("span",{staticClass:"q-title capitalize"},[t._v(t._s(e.row.firstName)+" "+t._s(e.row.lastName))])])}},{key:"body-cell-event",fn:function(e){return a("q-td",{attrs:{props:e}},[a("span",{staticClass:"q-title capitalize"},[t._v(t._s(e.row.seasonName))])])}},{key:"body-cell-time",fn:function(e){return a("q-td",{attrs:{props:e}},[a("span",{staticClass:"q-title capitalize"},[t._v(t._s(t.$moment(e.row.activityTime).format("LT")))])])}}])})],1)],1)],1)],1)},i=[],l=a("J4zp"),s=a.n(l),o=(a("f3/d"),a("dRSK"),a("Vd3H"),a("MVZn")),r=a.n(o),c=(a("KKXr"),a("cDf5")),u=a.n(c),d=(a("rGqo"),a("RIqP")),h=a.n(d),f={mounted:function(){this.$bindAsArray("event_schedules",this.$database.ref("event_schedules")),this.$bindAsArray("model_list",this.$database.ref("models")),this.$bindAsArray("events",this.$database.ref("events")),this.$bindAsArray("courses",this.$database.ref("settings/courses")),this.$bindAsArray("attendance",this.$database.ref("attendance")),this.$bindAsArray("batch",this.$database.ref("event_schedules")),this.$store.state.schedules.allActivities=this.event_schedules},computed:{getActivities:function(){var t=this,e=new Array,a=h()(this.event_schedules);return this.$lodash.forEach(a,function(a){t.$lodash.forEach(a.activities,function(t){t.batchKey=a[".key"],e.push(t)})}),e},getEvents:function(){return this.events},getStartDate:function(t){new Date(t.row.startDate)},mapActivities:function(){for(var t=this,e=this.$lodash.filter(this.courses,function(t){return t}),a=[],n=0;n<e.length;n++)for(var i=e[n].activities,l=0;l<i.length;l++)if("Payment"!==i[l].label){var s=i[l].label;a.push(s)}var o=this.$lodash.uniq(a),r=this.$lodash.map(o,function(e){return{label:e,value:t.$lodash.lowerCase(e)}}),c=[],u={label:"All",value:""};c.push(u);for(var d=0;d<r.length;d++){var h=r[d];c.push(h)}return this.filter="",this.mapEventActivities,c},mapEventActivities:function(){var t=[];this.$lodash.map(this.getActivities,function(e){return"payment"!=e.type&&t.push(e),e});return console.log("filtered payments",t),t},getMapActivities:function(){var t=this,e=this.$lodash.map(this.event_schedules,function(e){return{key:e[".key"],eventName:e.eventName,eventKey:e.eventKey,seasonName:e.seasonName,batchNumber:e.batchNumber,id:t.upcomingActivity(e.activities).id,upcomingAct:t.upcomingActivity(e.activities).type,date:t.$moment(t.upcomingActivity(e.activities).startDate).format("ll"),forSort:new Date(t.upcomingActivity(e.activities).startDate),time:t.$moment(t.upcomingActivity(e.activities).startDate).format("LT"),models:t.returnModels(e[".key"],t.upcomingActivity(e.activities).id,t.upcomingActivity(e.activities).type)}});return e},getAllAttendance:function(){try{for(var t=this.mapEventActivities,e=this.OpenSeasonOnly,a=this.batch,n=[],i=[],l=0;l<a.length;l++)for(var s=0;s<e.length;s++)a[l].seasonName===e[s].seasonName?n.push(a[l]):i.push(a[l]);for(var o=[],r=[],c=0;c<t.length;c++)for(var u=0;u<n.length;u++)if(t[c].batchKey===n[u][".key"]){var d={key:n[u][".key"],upcomingAct:t[c].type,eventKey:n[u].eventKey,forSort:new Date(t[c].startDate),eventName:n[u].eventName,seasonName:n[u].seasonName,batchNumber:n[u].batchNumber,id:t[c].id,date:this.$moment(t[c].startDate).format("ll"),time:this.$moment(t[c].startDate).format("LT"),models:this.returnModels(n[u][".key"],t[c].id,t[c].type)};o.push(d)}else r.push(t[c]);var h=this.$lodash.orderBy(o,"forSort","asc");return h}catch(t){return console.log("err",t),[]}},getFilteredActivities:function(){if(!0===this.seeAllFullDay){var t=this.$lodash.groupBy(this.getAllAttendance,function(t){return t.date+t.upcomingAct}),e=this.$lodash.filter(t,function(t,e,a){return t[".key"]=e,a});return console.log("filteredUNIQ",e),e}var a=this.$lodash.groupBy(this.FilterActivitiesOpenSeason,function(t){return t.date+t.upcomingAct}),n=this.$lodash.filter(a,function(t,e,a){return t[".key"]=e,a});return n},getFullDayTableData:function(){for(var t=[],e=0;e<this.getFilteredActivities.length;e++){var a=this.getFilteredActivities[e];t.push({date:this.getDateForTable(a),type:this.getTypeForTable(a),batchKeys:this.getBatchesPerDate(a),batchTitles:this.getBatchNameForTable(a),routerParam:this.getRouterLink(a),sortDate:this.getSortableDate(a)})}return t},OpenSeasonOnly:function(){try{for(var t=this.events,e=[],a=[],n=this.$lodash.filter(t,function(t){return t.seasons}),i=0;i<n.length;i++)for(var l=0;l<n[i].seasons.length;l++)"open"===n[i].seasons[l].status?e.push(n[i].seasons[l]):a.push(n[i].seasons[l]);return e}catch(t){return console.log(t),[]}},FilterActivitiesOpenSeason:function(){try{for(var t=this.getMapActivities,e=this.OpenSeasonOnly,a=[],n=[],i=0;i<t.length;i++)for(var l=0;l<e.length;l++)t[i].seasonName===e[l].seasonName?a.push(t[i]):n.push(t[i]);var s=this.$lodash.orderBy(a,"forSort","asc");return s}catch(t){return console.log(t),[]}},ByBatchTableData:function(){try{var t=this.getAllAttendance,e=this.FilterActivitiesOpenSeason;return!0===this.seeAll?t:e}catch(t){return console.log("err",t),[]}},getModels:function(){try{var t=this.selectedAttendance.key,e=this.selectedAttendance.id,a=this.selectedAttendance.upcomingAct;if("orientation"!==a)return console.log("activity models",this.returnAttendanceList(t,e)),this.returnAttendanceList(t,e);var n=this.$lodash.filter(this.model_list,function(e){return e.batchKey===t});return console.log("modellist",n),n}catch(t){return[]}},getModelsFull:function(){var t=this;try{if(void 0===u()(this.selectedFull))return[];if("orientation"!==this.selectedFull.type){var e=this.selectedFull.routerParam,a=this.$lodash.split(e,"$"),n=this.selectedFull.date,i=this.selectedFull.type;console.log("activityDate",n),console.log("split batches",a);var l=[];return this.$lodash.forEach(a,function(e){var a=e;console.log("key NOT orientation",a);var s=t.returnBatchActivity(a),o=[],c="",u=null,d=t.$moment(new Date(n)).format("ll");t.$lodash.map(s,function(e){var a=t.$moment(new Date(e.startDate)).format("ll");e.type===i&&d===a?(c=e.id,u=new Date(e.startDate)):o.push(e)});console.log("key",a),console.log("titles",c);for(var h=t.returnAttendanceList(a,c),f=0;f<h.length;f++){var m=r()({},h[f]);m.activityID=c,m.activityTime=u,l.push(m)}}),console.log("modelsBatch",l),l}var s,o,c=function(){var e=t.selectedFull.routerParam,a=t.$lodash.split(e,"$"),n=t.selectedFull.sortDate,i=t.selectedFull.type;console.log("activityDate",n),console.log("split batches orientation",a);var l=[],r=function(){var e=a[s],r=t.returnBatchActivity(e),c=[],u="",d=null,h=t.$moment(new Date(n)).format("ll");t.$lodash.map(r,function(e){var a=t.$moment(new Date(e.startDate)).format("ll");e.type===i&&h===a?(u=e.id,d=new Date(e.startDate)):c.push(e)});for(o=0;o<t.model_list.length;o++)if(t.model_list[o].batchKey===a[s]){var f=t.model_list[o];f.activityID=u,f.activityTime=d,l.push(f)}};for(s=0;s<a.length;s++)r();return console.log("all models in batches",l),{v:l}}();if("object"===u()(c))return c.v}catch(t){return[]}}},data:function(){return{batchActivity:[],attendanceListFull:[],batchActivity2:[],RowsPage:[0],selectedAttendance:{},selectedFull:{},showPrintModal:!1,showFullPrintModal:!1,seeAll:!1,seeAllFullDay:!1,fullDayShow:!1,byBatchShow:!0,filter:"",activities:[],selectActivity:"",events:[],event_schedules:[],model_list:[],tableLoading:!1,findTitle:"",findKey:"",columns:[{name:"eventName",required:!0,label:"Event Name",align:"left",field:"eventName",sortable:!0},{name:"season",required:!0,label:"Season",align:"left",field:"seasonName",sortable:!0},{name:"batch",required:!0,label:"Batch",align:"left",field:"batchNumber",sortable:!0},{name:"activity",required:!0,label:"Upcoming Activity",align:"left",sortable:!0,field:"upcomingAct"},{name:"date",required:!0,label:"Date",align:"left",sortable:!0,field:"forSort"},{name:"time",required:!0,label:"Time",align:"left",sortable:!0,field:"forSort"},{name:"action",required:!0,label:"Action",align:"center",sortable:!0}],fullDayColumns:[{name:"date",required:!0,label:"Date",align:"left",sortable:!0,field:"sortDate"},{name:"type",required:!0,label:"Activity Type",align:"left",sortable:!0,field:"type"},{name:"batches",required:!0,label:"Batches",align:"left"},{name:"action",required:!0,label:"Action",align:"center",sortable:!0}],eventOpt:[{label:"test",value:"test"}],Modelcolumns:[{name:"fullname",required:!0,label:"Full Name",align:"left"},{name:"signature",required:!0,label:"Signature",align:"left"}],ModelFullcolumns:[{name:"fullname",required:!0,label:"Full Name",align:"left"},{name:"event",required:!0,label:"Event",align:"left"},{name:"time",required:!0,label:"Time",align:"left"},{name:"signature",required:!0,label:"Signature",align:"left"}],pagination:{sortBy:null,descending:!1,page:1,rowsPerPage:10},Modelpagination:{sortBy:null,descending:!1,page:1,rowsPerPage:0}}},methods:{getBatchesPerDate:function(t){for(var e=t,a=[],n=0;n<e.length;n++){var i=e[n].key;a.push(i)}var l=this.$lodash.join(a,"$"),s=this.$lodash.split(l,"$");return s},getRouterLink:function(t){for(var e=t,a=[],n=0;n<e.length;n++){var i=e[n].key;a.push(i)}var l=this.$lodash.join(a,"$");this.$lodash.split(l,"$");return l},getBatchNameForTable:function(t){for(var e=t,a=[],n=0;n<e.length;n++){var i=e[n].id,l=e[n].seasonName,s=this.$moment(e[n].forSort).format("LT"),o=this.$lodash.join([l,i,s]," / ");a.push(o)}var r=this.$lodash.join(a,"$"),c=this.$lodash.split(r,"$");return c},getDateForTable:function(t){var e=t[0].date;return e},getSortableDate:function(t){var e=t[0].forSort;return e},getTypeForTable:function(t){var e=t[0].upcomingAct;return e},showByBatch:function(){this.fullDayShow=!1,this.byBatchShow=!0},showFullDay:function(){this.fullDayShow=!0,this.byBatchShow=!1},upcomingActivity:function(t){for(var e=t,a=new Date,n=[],i=0;i<e.length;i++){var l=this.$mathMixin.dayDiff(a,new Date(e[i].startDate));l>=0&&"payment"!=e[i].type&&n.push(e[i])}var s=n.sort(function(t,e){var a=new Date(t.startDate),n=new Date(e.startDate);return a-n});return s[0]},showSeason:function(t){console.log("show season",t)},getTitle:function(t){var e=t.row.activities;this.$lodash.map(e,function(t){return t.title})},mySort:function(t,e,a){var n=this.computedCols.find(function(t){return t.name===e});if(null===n||void 0===n.field)return t;var i=a?-1:1,l="function"===typeof n.field?function(t){return n.field(t)}:function(t){return t[n.field]};return t.sort(function(t,e){var a=l(t),o=l(e);if(null===a||void 0===a)return-1*i;if(null===o||void 0===o)return 1*i;if(n.sort)return n.sort(a,o)*i;if(isNumber(a)&&isNumber(o))return(a-o)*i;if(isDate(a)&&isDate(o))return sortDate(a,o)*i;if("boolean"===typeof a&&"boolean"===typeof o)return(t-e)*i;var r=[a,o].map(function(t){return(t+"").toLowerCase()}),c=s()(r,2);return a=c[0],o=c[1],a<o?-1*i:a===o?0:i})},selectedAttendancePrint:function(t){this.selectedAttendance=t,console.log("for print",t),this.showPrintModal=!0},printPdf:function(){window.print()},selectedFullAttendancePrint:function(t){this.selectedFull=t,console.log("for print",t),this.showFullPrintModal=!0},returnBatchActivity:function(t){var e=[];this.$lodash.forEach(this.event_schedules,function(a){a[".key"]===t&&e.push(a)});var a=[];return this.$lodash.forEach(e,function(t){a.push(t.activities)}),console.log("found",e),console.log("activities",a),a[0]},returnAttendanceList:function(t,e){var a=[];if(this.$lodash.forEach(this.attendance,function(e){e[".key"]===t&&a.push(e)}),"undefined"===typeof a[0])return[];console.log("keyfound",a[0]),console.log("title",e);var n=a[0],i=[];return console.log("zero",n[e].models),this.$lodash.map(n[e].models,function(t,e,a){t[".key"]=e,i.push(t)}),console.log("models",i),i},returnModels:function(t,e,a){try{var n=t,i=e,l=a;if("orientation"!==l)return this.returnAttendanceList(n,i);var s=this.$lodash.filter(this.model_list,function(t){return t.batchKey===n});return s}catch(t){return[]}}}},m=f,p=(a("BmqP"),a("KHd+")),v=Object(p["a"])(m,n,i,!1,null,null,null);e["default"]=v.exports}}]);