(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[26],{"+Oer":function(t,i,e){"use strict";e.r(i);var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("q-toolbar",{attrs:{color:"faded"}},[e("q-toolbar-title",[t._v("\n\t\t\t\tSchedules\n\t\t\t")]),t.isEdit?t._e():e("q-btn",{staticClass:"q-mx-md",attrs:{rounded:"",inverted:"",color:"secondary"},on:{click:function(i){t.editMode(!0)}}},[t._v("Edit Schedules")]),t.isEdit?e("div",[e("q-btn",{staticClass:"q-mx-md",attrs:{rounded:"",inverted:"",color:"secondary"},on:{click:t.saveChanges}},[t._v("Save")]),e("q-btn",{staticClass:"q-mx-md",attrs:{rounded:"",inverted:"",color:"negative"},on:{click:t.cancelEdit}},[t._v("Cancel")])],1):t._e(),t.isEdit?t._e():e("q-btn",{attrs:{rounded:"",inverted:"",color:"primary"},on:{click:function(i){t.$router.push("/schedules")}}},[t._v("New Batch")])],1),e("div",{staticClass:"row"},[e("div",{staticClass:"col calendar-parent",staticStyle:{"max-height":"100vw",height:"70vw"}},[e("calendar-view",{staticClass:"theme-default holiday-us-traditional q-mr-md",attrs:{"show-date":t.showDate,events:t.getAllActivities,"show-event-times":t.showEventTimes,enableDragDrop:t.enableDragDrop,startingDayOfWeek:t.startingDayOfWeek},on:{"show-date-change":t.setShowDate,"click-date":t.clickDate,"click-event":t.clickEvent,"drop-on-date":t.dropOnDate}})],1)]),e("q-modal",{attrs:{"content-css":{minWidth:"30vw",minHeight:"50vh"}},on:{hide:function(t){}},model:{value:t.activityModal,callback:function(i){t.activityModal=i},expression:"activityModal"}},[e("q-modal-layout",{attrs:{"content-class":"{'bg-primary': isPrimary}","footer-class":"bg-primary some-class","footer-style":"{fontSize: '24px', fontWeight: 'bold'}"}},[e("q-toolbar",[e("q-toolbar-title",[t._v("\n            Activity Details\n          ")]),e("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:function(i){t.activityModal=!1}}})],1),e("div",[e("q-select",{staticClass:"textBox",attrs:{readonly:"","float-label":"Activity",options:t.activityList},model:{value:t.activity.activityType,callback:function(i){t.$set(t.activity,"activityType",i)},expression:"activity.activityType"}}),t.actComponents.time||t.actComponents.dueDate?e("q-datetime",{staticClass:"textBox",attrs:{format:t.isPhotoLikingDateFormat,min:t.isPhotoLikingMinDate,"stack-label":t.isPhotoLikingLabel,type:t.isPhotoLiking},model:{value:t.activity.time,callback:function(i){t.$set(t.activity,"time",i)},expression:"activity.time"}}):t._e(),t.actComponents.capacity?e("q-input",{staticClass:"textBox",attrs:{type:"number","stack-label":"Capacity"},model:{value:t.activity.capacity,callback:function(i){t.$set(t.activity,"capacity",i)},expression:"activity.capacity"}}):t._e(),t.actComponents.location?e("q-input",{staticClass:"textBox",attrs:{type:"textarea","stack-label":"Location",rows:"7"},model:{value:t.activity.location,callback:function(i){t.$set(t.activity,"location",i)},expression:"activity.location"}}):t._e()],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("q-btn",{staticClass:"full-width",attrs:{color:"primary"},on:{click:t.saveActivity}},[t._v("save")])],1)],1)],1)],1)},s=[],o=e("RIqP"),n=e.n(o),c=(e("INYr"),e("91GP"),e("a1Th"),e("kv6+")),l=e("VVcl"),r=e.n(l),d=(e("+diE"),{name:"allSchedules",components:{CalendarView:r.a,CalendarAgenda:c["b"],CalendarAgendaEvent:c["c"],Calendar:c["a"]},created:function(){var t=this;window.addEventListener("beforeunload",function(){if(t.isEdit){t.$q.localStorage.set("editMode",t.isEdit);for(var i=0;i<t.allAct.length;i++)t.allAct[i].startDate=t.allAct[i].startDate.toString(),t.allAct[i].endDate=t.allAct[i].endDate.toString();t.$q.localStorage.set("allActivities",t.allAct)}},!1)},mounted:function(){this.$bindAsArray("allActivities",this.$database.ref("event_schedules")),this.$bindAsArray("activities",this.$database.ref("settings/activityList")),this.$bindAsArray("courses",this.$database.ref("settings/courses")),this.$bindAsArray("events",this.$database.ref("events")),this.$bindAsArray("draftEdit",this.$database.ref("draftEdit")),this.$store.commit("schedules/updateAllActivities",this.allActivities)},computed:{getAllActivities:function(){if(console.log("is recovery",this.$q.localStorage.has("editMode")),this.$q.localStorage.has("editMode")){console.log("on recovery mode"),this.isEdit=!0;for(var t=Object.assign([],this.$q.localStorage.get.item("allActivities")),i=0;i<t.length;i++)t[i].startDate=new Date(t[i].startDate),t[i].endDate=new Date(t[i].endDate);this.allAct=t,this.$forceUpdate()}else{console.log("on viewing");var e=Object.assign([],this.$store.getters["schedules/getAllActivities"]);this.allAct=e}return this.allAct},getAgendaActivities:function(){return this.$store.getters["schedules/getAgendaActivities"]},activityList:function(){var t=this.activities;if(!0===this.isEdit){var i=[];this.$lodash.map(t,function(t){return i.push({label:t.label,value:t.value,visible:!0}),t});return this.isActComponent,i}var e=[],a=(this.$lodash.map(t,function(t){return!0===t.visible&&e.push({label:t.label,value:t.value,visible:t.visible}),t}),this.$lodash.orderBy(e,[function(t){return t.label}],["asc"]));return this.isActComponent,a},isPhotoLiking:function(){return"photoliking"===this.activity.activityType?"date":"time"},isPhotoLikingLabel:function(){return"photoliking"===this.activityType?"PhotoLiking Due Date":"Time"},isPhotoLikingMinDate:function(){if("photoliking"===this.activity.activityType)return this.activity.startDate},isPhotoLikingDateFormat:function(){return"photoliking"===this.activity.activityType?"YYYY-MM-DD":"h:mm A"},isPhotoLikingDueDate:function(){return"photoliking"===this.activity.activityType?this.activityTime:this.setActivityTime},isActComponent:function(){var t=this;if(""!=this.activity.activityType){var i=this.$lodash.filter(this.events,function(i){return i[".key"]===t.activity.eventKey}),e=this.$lodash.filter(this.courses,function(t){return t[".key"]===i[0].course}),a=this.$lodash.findIndex(e[0].activities,function(i){return i.value===t.activity.activityType});this.actComponents.time=e[0].activities[a].time,this.actComponents.location=e[0].activities[a].location,this.actComponents.capacity=e[0].activities[a].capacity,this.actComponents.dueDate=e[0].activities[a].dueDate}}},data:function(){return{allAct:[],isEdit:!1,activityModal:!1,activity:{scheduleKey:"",eventKey:"",seasonName:"",batchNumber:0,colorCode:"",activityType:"",endDate:"",time:"",location:"",capacity:"",startDate:"",title:""},actComponents:{time:!1,location:!1,capacity:!1,dueDate:!1},dateNow:new Date("2018-08-08"),agendas:"myAgendas",events:[],draftEdit:[],allActivities:[],activities:[],courses:[],dateFormat:"h:m A",startingDayOfWeek:0,enableDragDrop:!0,showEventTimes:!0,showDate:new Date,someEventObject:[{id:1,summary:"Test event",description:"Some extra info goes here",location:"Office of the Divine Randomness, 1232 Main St., Denver, CO",start:{dateTime:"2018-08-08T14:00:00"},end:{dateTime:"2018-08-08T16:30:00"},color:"positive",attendees:[{id:5,email:"somebody@somewhere.com",displayName:"John Q. Public",organizer:!1,self:!1,resource:!1}]},{id:7,summary:"Test event",description:"Some extra info goes here",location:"Office of the Divine Randomness, 1232 Main St., Denver, CO",start:{dateTime:"2018-08-17T18:00:00"},end:{dateTime:"2018-08-20T20:30:00"},color:"positive",attendees:[{id:5,email:"somebody@somewhere.com",displayName:"John Q. Public",organizer:!1,self:!1,resource:!1}]},{id:10,summary:"Test all-day event",description:"Some extra info goes here",start:{date:"2018-08-16"},end:{date:"2018-08-19"}}]}},methods:{setShowDate:function(t){this.showDate=t},editMode:function(t){this.isEdit=t;var i=Object.assign([],this.$store.getters["schedules/getAllActivities"]);this.allAct=i},cancelEdit:function(){this.isEdit=!1,this.$bindAsArray("allActivities",this.$database.ref("event_schedules")),this.$store.commit("schedules/updateAllActivities",this.allActivities);var t=Object.assign([],this.$store.getters["schedules/getAllActivities"]);this.allAct=t,this.$q.localStorage.clear(),console.log("allaAct",this.allAct),this.$forceUpdate()},saveChanges:function(){console.log("all act",this.allAct),console.log("event_schedules",this.allActivities);for(var t=Object.assign([],this.allActivities),i=Object.assign([],this.allAct),e=0;e<i.length;e++){i[e].batchNumber;var a=i[e].scheduleID,s=i[e].scheduleKey,o=this.$lodash.findIndex(t,function(t){return t[".key"]===s}),n=this.$lodash.findIndex(t[o].activities,function(t){return t.id?t.id===a:t.scheduleID===a});i[e].startDate=i[e].startDate.toString(),i[e].endDate=i[e].endDate.toString(),t[o].activities[n]=i[e],console.log("activityindex",n),console.log("newact",i[e]),console.log("to update",t[o])}console.log("oldActivities",t),this.$store.dispatch("schedules/saveChanges",t),this.cancelEdit},clickDate:function(t){this.test},clickEvent:function(t){var i=this.$mathMixin.dayDiff(this.showDate,t.startDate),e=t.originalEvent;this.isEdit&&i>=1&&(this.activity.classes=e.classes,this.activity.capacity=e.capacity,this.activity.endDate=e.endDate,this.activity.eventKey=e.eventKey,this.activity.amount=e.amount,this.activity.batchNumber=e.batchNumber,this.activity.location=e.location,this.activity.scheduleKey=e.scheduleKey,this.activity.startDate=e.startDate,this.activity.title=e.title,this.activity.activityType=e.type,this.activity.time=e.startDate,this.activityModal=!0)},dropOnDate:function(t,i){var e=this.$mathMixin.dayDiff(this.showDate,t.startDate);if(console.log("event dragged",e),this.isEdit&&e>=1){var a=t.originalEvent,s=n()(this.allAct),o=this.$mathMixin.dayDiff(t.startDate,i),c=this.$mathMixin.dayDiff(this.showDate,i);if(c>=1){var l=this.$mathMixin.addDays(t.startDate,o),r=this.$mathMixin.addDays(t.endDate,o);console.log("new s",l),console.log("new e",r),console.log("allActivities",this.allAct),console.log("this event act",a);var d=this.$lodash.findIndex(s,function(t){return t.scheduleID===a.scheduleID&&t.batchNumber===a.batchNumber});console.log("all act",d),s[d].startDate=l,s[d].endDate=r}}},setActivityTime:function(){if(""===this.activity.time)return console.log("start",this.activity.startDate),this.activity.startDate;var t=new Date(this.activity.time),i=t.getHours(),e=t.getMinutes(),a=new Date(this.activity.startDate);return a.setHours(i),a.setMinutes(e),console.log("end",a),a.toString()},saveActivity:function(){var t=this;console.log("act",this.activity);var i=this.$lodash.filter(this.allActivities,function(i){return i[".key"]===t.activity.scheduleKey}),e=this.$lodash.filter(i[0].activities,function(i){return i.type===t.activity.activityType});e[0].capacity=this.activity.capacity,"photoliking"===this.activity.activityType?(e[0].endDate=this.activity.startDate,e[0].endDate=this.activity.time):(e[0].startDate=this.activity.time,e[0].endDate=this.activity.time),e[0].location=this.activity.location,this.$store.dispatch("schedules/updateActivity",{payload:e[0],fireb:this.$database,_:this.$lodash,quasu:this.$q}),this.activityModal=!1}},deactivated:function(){},beforeDestroy:function(){},destroyed:function(){}}),h=d,v=(e("fRXH"),e("KHd+")),u=Object(v["a"])(h,a,s,!1,null,null,null);i["default"]=u.exports},AVqX:function(t,i,e){},fRXH:function(t,i,e){"use strict";var a=e("AVqX"),s=e.n(a);s.a}}]);