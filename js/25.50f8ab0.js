(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[25],{VIM0:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"row"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.schedules.isCreateNewBatch,expression:"$store.state.schedules.isCreateNewBatch"}],staticClass:"col-3"},[i("q-page-sticky",{attrs:{offset:[10,0],expand:"",position:"bottom-left"}}),i("q-list",{staticClass:"q-ma-md",attrs:{highlight:"","inset-separator":""}},[i("q-list-header",[t._v("Scheduled")]),t._l(t.$store.state.schedules.activities,function(e){return i("q-item",{key:e.eventKey},[i("q-item-main",[i("q-item-tile",{attrs:{label:""}},[t._v(t._s(e.title))]),"photoliking"===e.type?i("q-item-tile",{attrs:{sublabel:""}},[t._v(t._s(t.$moment(e.startDate).format("l"))+" to "+t._s(t.$moment(e.endDate).format("l")))]):t._e(),"photoliking"!==e.type?i("q-item-tile",{attrs:{sublabel:""}},[t._v(t._s(t.$moment(e.startDate).format("llll")))]):t._e()],1)],1)})],2),t._l(t.taskList2,function(e){return i("div",{key:e.value},[i("q-chip",{attrs:{floating:"",color:"red"}},[t._v("122")]),e.visible?i("q-chip",{attrs:{icon:"check",color:"primary"}},[t._v(t._s(e.label)+t._s(t.getRemainingAmount(e)))]):t._e()],1)})],2),i("div",{staticClass:"col"},[i("div",{staticClass:"calendar-parent q-ml-md",staticStyle:{"max-height":"100vw",height:"70vw"}},[i("calendar-view",{staticClass:"theme-default holiday-us-traditional q-mr-md",attrs:{"show-date":t.showDate,events:t.activitiesToggle,"show-event-times":t.showEventTimes,enableDragDrop:t.enableDragDrop,startingDayOfWeek:t.startingDayOfWeek},on:{"show-date-change":t.setShowDate,"click-date":t.clickDate,"click-event":t.clickEvent,"drop-on-date":t.dropOnDate}})],1)])]),i("q-modal",{attrs:{"content-css":{minWidth:"50vw",minHeight:"45vh"}},on:{hide:t.clearBatchModal},model:{value:t.newBatchModal,callback:function(e){t.newBatchModal=e},expression:"newBatchModal"}},[i("q-modal-layout",{attrs:{"header-style":"min-height: 100px","content-class":"{'bg-primary': isPrimary, 'some-class': someBoolean}","footer-class":"bg-primary some-class","footer-style":"{fontSize: '24px', fontWeight: 'bold'}"}},[i("q-toolbar",[i("q-toolbar-title",[t._v("\n            Batch Details\n          ")]),i("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:function(e){t.$store.commit("schedules/updateNewBatchModal",!1)}}})],1),i("div",[i("q-select",{staticClass:"textBox",attrs:{"float-label":"Events",options:t.eventOpt},model:{value:t.selectedEvent,callback:function(e){t.selectedEvent=e},expression:"selectedEvent"}}),i("q-input",{staticClass:"textBox",attrs:{readonly:"",type:"text","stack-label":"Season"},model:{value:t.getSeason,callback:function(e){t.getSeason=e},expression:"getSeason"}}),i("q-input",{staticClass:"textBox",attrs:{readonly:"",min:"1",type:"number","stack-label":"Batch Number"},model:{value:t.batchNumber,callback:function(e){t.batchNumber=e},expression:"batchNumber"}}),i("q-select",{staticClass:"textBox",attrs:{readonly:t.isColorCode,"float-label":"Color Code",options:t.colorOpt},model:{value:t.eventColor,callback:function(e){t.eventColor=e},expression:"eventColor"}})],1),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("q-btn",{staticClass:"full-width",attrs:{color:"primary"},on:{click:t.saveBatch}},[t._v("OK")])],1)],1)],1),i("q-modal",{attrs:{"content-css":{minWidth:"30vw",minHeight:"50vh"}},on:{hide:t.clearActivityModal},model:{value:t.newActivityModal,callback:function(e){t.newActivityModal=e},expression:"newActivityModal"}},[i("q-modal-layout",{attrs:{"content-class":"{'bg-primary': isPrimary}","footer-class":"bg-primary some-class","footer-style":"{fontSize: '24px', fontWeight: 'bold'}"}},[i("q-toolbar",[i("q-toolbar-title",[t._v("\n            Activity Details\n          ")]),i("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:function(e){t.newActivityModal=!1}}})],1),i("div",[i("q-select",{staticClass:"textBox",attrs:{"float-label":"Activity",options:t.activityList2},model:{value:t.activityType,callback:function(e){t.activityType=e},expression:"activityType"}}),"payment"===t.activityType?i("q-input",{staticClass:"textBox",attrs:{prefix:"P",type:"number","stack-label":"Amount"},model:{value:t.paymentAmount,callback:function(e){t.paymentAmount=e},expression:"paymentAmount"}}):t._e(),t.actComponents.time||t.actComponents.dueDate?i("q-datetime",{staticClass:"textBox",attrs:{format:t.isPhotoLikingDateFormat,min:t.isPhotoLikingMinDate,"stack-label":t.isPhotoLikingLabel,type:t.isPhotoLiking},model:{value:t.activityTime,callback:function(e){t.activityTime=e},expression:"activityTime"}}):t._e(),t.actComponents.capacity?i("q-input",{staticClass:"textBox",attrs:{type:"number","stack-label":"Capacity"},model:{value:t.activityCapacity,callback:function(e){t.activityCapacity=e},expression:"activityCapacity"}}):t._e(),t.actComponents.location?i("q-input",{staticClass:"textBox",attrs:{type:"textarea","stack-label":"Location",rows:"7"},model:{value:t.activityLocation,callback:function(e){t.activityLocation=e},expression:"activityLocation"}}):t._e()],1),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("q-btn",{staticClass:"full-width",attrs:{color:"primary"},on:{click:t.saveActivity}},[t._v("OK")]),t.isEdit?i("q-btn",{staticClass:"full-width",attrs:{color:"negative"},on:{click:t.removeActivity}},[t._v("Delete")]):t._e()],1)],1)],1)],1)},a=[],o=i("MVZn"),n=i.n(o),c=(i("a1Th"),i("pIFo"),i("INYr"),i("VVcl")),l=i.n(c),h={components:{CalendarView:l.a},computed:{event:function(){return this.$store.state.schedules.event},activitiesToggle:function(){try{return this.$store.state.schedules.isViewAllSched?this.$store.getters["schedules/getSeeAllSchedules"]:this.$store.state.schedules.activities}catch(t){}},activities:function(){try{return this.$store.state.schedules.activities}catch(t){}},batchNumber:function(){var t=this;try{var e=this.$lodash.filter(this.allActivities,function(e){return e.eventKey===t.selectedEvent}),i=this.$store.getters["schedules/isEventBatchExist"](e);return isFinite(i)?(console.log("batch",e[0]),this.eventColor=e[0].colorCode,++i):(this.eventColor="",1)}catch(t){}},isColorCode:function(){return""!==this.eventColor},colorOpt:function(){if(this.batchNumber<=1)for(var t=0;t<this.$store.state.schedules.allActivities.length;t++)for(var e=0;e<this.$store.state.schedules.colorOpt.length;e++)this.$store.state.schedules.allActivities[t].colorCode===this.$store.state.schedules.colorOpt[e].value?this.$store.state.schedules.colorOpt[e].visible=!1:this.$store.state.schedules.colorOpt[e].visible=!0;else for(var i=0;i<this.$store.state.schedules.colorOpt.length;i++)this.$store.state.schedules.colorOpt[i].visible=!0;var s=this.$lodash.filter(this.$store.getters["schedules/getColorOpt"],function(t){return!0===t.visible});return s},eventOpt:function(){var t=[];try{for(var e=0;e<this.events.length;e++){var i=this.events[e].seasons;i&&"standby"===i[0].status&&t.push(this.events[e])}}catch(t){}var s=this.$lodash.map(t,function(t){return{label:t.eventName,value:t[".key"],seasons:t.seasons}});return s},activityList2:function(){var t=this.kidsFashionCourse;if(!0===this.isEdit){console.log("is edit");var e=[];this.$lodash.map(t,function(t){return e.push({label:t.label,value:t.value,visible:!0}),t});return this.isActComponent,e}var i=[],s=(this.$lodash.map(t,function(t){return"workshop"===t.value&&(t.visible=!0),!0===t.visible&&i.push({label:t.label,value:t.value,visible:t.visible}),t}),this.$lodash.orderBy(i,[function(t){return t.label}],["asc"]));return this.isActComponent,console.log("sorted",s),s},isActComponent:function(){var t=this;if(""!=this.activityType){var e=this.$lodash.findIndex(this.kidsFashionCourse,function(e){return e.value===t.activityType});this.actComponents.time=this.kidsFashionCourse[e].time,this.actComponents.location=this.kidsFashionCourse[e].location,this.actComponents.capacity=this.kidsFashionCourse[e].capacity,this.actComponents.dueDate=this.kidsFashionCourse[e].dueDate}},activityOpt:function(){if(0===this.$store.state.schedules.activities.length)return this.activityList=[],this.activityList=[{label:"Orientation",value:"orientation",hidden:!0},{label:"Payment",value:"payment"},{label:"Photoshoot",value:"photoshoot"},{label:"PhotoLiking",value:"photoliking"},{label:"Workshop",value:"workshop"},{label:"General Rehersal",value:"generalRehersal"},{label:"Final Rehersal",value:"finalRehersal"}],this.activityList;if(this.isEdit){var t=[{label:"Orientation",value:"orientation",hidden:!0},{label:"Payment",value:"payment"},{label:"Photoshoot",value:"photoshoot"},{label:"PhotoLiking",value:"photoliking"},{label:"Workshop",value:"workshop"},{label:"General Rehersal",value:"generalRehersal"},{label:"Final Rehersal",value:"finalRehersal"}];return t}return this.activityList},taskList2:function(){return this.$store.getters["schedules/taskList2"]},taskList:function(){return this.$store.state.schedules.taskList2},getSeason:function(){var t=this;try{var e=this.$lodash.filter(this.events,function(e){return e[".key"]===t.selectedEvent}),i=e[0].seasons.length,s=e[0].seasons[i-1].seasonName;return s}catch(t){}},newBatchModal:{get:function(){return this.$store.state.schedules.newBatchModal},set:function(t){this.$store.commit("schedules/updateNewBatchModal",t)}},isLocation:function(){return"payment"!==this.activityType&&"photoliking"!==this.activityType},isCapacity:function(){return"workshop"===this.activityType},setActivityTime:function(){if(""===this.activityTime)return this.activityDate;var t=new Date(this.activityTime),e=t.getHours(),i=t.getMinutes(),s=new Date(this.activityDate);return s.setHours(e),s.setMinutes(i),s},isPhotoLiking:function(){return"photoliking"===this.activityType?"date":"time"},isPhotoLikingLabel:function(){return"photoliking"===this.activityType?"PhotoLiking Due Date":"Time"},isPhotoLikingMinDate:function(){if("photoliking"===this.activityType)return this.activityDate},isPhotoLikingDateFormat:function(){return"photoliking"===this.activityType?"YYYY-MM-DD":"h:mm A"},isPhotoLikingDueDate:function(){return"photoliking"===this.activityType?this.activityTime:this.setActivityTime},paymentCount:function(){var t=this.$lodash.filter(this.activities,function(t){return"payment"===t.type});return 0===t.length?1:t.length},workshopCount:function(){var t=this.$lodash.filter(this.activities,function(t){return"workshop"===t.type});return console.log("workshops",t),t.length},getTotal:function(){for(var t=0,e=0;e<this.$store.state.schedules.activities.length;e++)"payment"===this.$store.state.schedules.activities[e].type&&(t+=this.$store.state.schedules.activities[e].amount);return console.log("t",t),this.amountRemaining-t}},mounted:function(){this.$bindAsArray("events",this.$database.ref("events")),this.$bindAsArray("allActivities",this.$database.ref("event_schedules")),this.$bindAsArray("courses",this.$database.ref("settings/courses")),this.$store.commit("schedules/updateEvents",this.events),this.$store.commit("schedules/updateAllActivities",this.allActivities)},data:function(){return{amountRemaining:0,paymentAmount:0,kidsFashionCourse:[],kidFashion:[],basicCourse:[],fullCourse:[],courses:[],task:[],actComponents:{time:!1,location:!1,capacity:!1,dueDate:!1},allActivities:[],activityList:[{label:"Orientation",value:"orientation"},{label:"Payment",value:"payment"},{label:"Photoshoot",value:"photoshoot"},{label:"PhotoLiking",value:"photoliking"},{label:"Workshop",value:"workshop"},{label:"General Rehersal",value:"generalRehersal"},{label:"Final Rehersal",value:"finalRehersal"}],newActivityModal:!1,isEdit:!1,editIndex:-1,events:[],selectedEvent:"",eventSeason:"",batch:1,eventColor:"",activityType:"",activityDate:"",activityTime:"",activityCapacity:"",activityLocation:"",dateFormat:"h:m A",startingDayOfWeek:0,enableDragDrop:!0,showEventTimes:!0,showDate:new Date}},watch:{activities:function(){this.getTotalPayments}},methods:{getRemainingAmount:function(t){if("Payment"===t.label)return"- Remaining Amount: P"+this.amountRemaining.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},isPhotoLikingSubLabel:function(t){return!0},clearBatchModal:function(){this.selectedEvent=""},clearActivityModal:function(){this.activityType="",this.activityTime="",this.activityCapacity="",this.activityLocation="",this.paymentAmount=0,this.isEdit=!1},saveBatch:function(){var t=this,e=this.$lodash.filter(this.events,function(e){return e[".key"]===t.selectedEvent});console.log(e),e[0].eventColor=this.eventColor;var i=this.$lodash.findIndex(this.courses,function(t){return t[".key"]===e[0].course}),s=this.courses[i].activities;this.kidsFashionCourse=s;n()({},s);this.task=s,this.amountRemaining=e[0].seasons[0].totalAmount,this.$store.state.schedules.amountRemaining=e[0].seasons[0].totalAmount,console.log("list",this.kidsFashionCourse),this.$store.commit("schedules/updateTaskList2",this.task),this.$store.commit("schedules/updateEvent",e[0]),this.$store.commit("schedules/updateEventSeason",this.getSeason),this.$store.commit("schedules/updateBatchNumber",this.batchNumber),this.$store.commit("schedules/updateIsCreateNewBatch",!0),this.$store.commit("schedules/updateNewBatchModal",!1),this.$store.getters["schedules/includeSchedule"](this.$lodash)},saveActivity:function(){var t=this,e=this.$store.state.schedules.batchNumber;if(this.isEdit)if(console.log("type",this.activityType),console.log("fix",this.activities),this.activities[this.editIndex].type===this.activityType)console.log("same lng no changes"),this.activities[this.editIndex].type=this.activityType,this.activities[this.editIndex].startDate=this.setActivityTime,"photoliking"===this.activityType?this.activities[this.editIndex].endDate=this.isPhotoLikingDueDate:this.activities[this.editIndex].endDate=this.setActivityTime,this.activities[this.editIndex].title="".concat(this.event.eventCode).concat(e,"_").concat(this.activityType),this.activities[this.editIndex].capacity=this.activityCapacity,this.activities[this.editIndex].location=this.activityLocation,this.activities[this.editIndex].id=this.event.eventCode+e+this.activityType,"payment"!==this.activityType&&"workshop"!==this.activityType||("payment"===this.activityType?(this.amountRemaining+=this.activities[this.editIndex].amount,this.activities[this.editIndex].amount=this.paymentAmount,this.amountRemaining-=this.activities[this.editIndex].amount,this.$store.state.schedules.amountRemaining=this.amountRemaining,this.activities[this.editIndex].title="".concat(this.event.eventCode).concat(e,"_").concat(this.activityType,"_").concat(this.paymentCount),this.activities[this.editIndex].id="".concat(this.event.eventCode).concat(this.activityType,"_").concat(this.paymentCount)):(this.activities[this.editIndex].title="".concat(this.event.eventCode).concat(e,"_").concat(this.activityType,"_").concat(this.workshopCount),this.activities[this.editIndex].id="".concat(this.event.eventCode).concat(this.activityType,"_").concat(this.workshopCount))),this.getRemainingAmount;else{console.log("mag kaiba check kung existing pag meron replace then delete ung current");var i=this.$lodash.findIndex(this.activities,function(e){return e.type===t.activityType});console.log("getindex",i);var s={eventkey:this.event[".key"],type:this.activityType,startDate:this.setActivityTime,endDate:this.isPhotoLikingDueDate,title:"".concat(this.event.eventCode).concat(e,"_").concat(this.activityType),capacity:this.activityCapacity,location:this.activityLocation,id:this.event.eventCode+this.activityType,classes:this.$store.state.schedules.event.eventColor};if("payment"!==this.activityType&&"workshop"!==this.activityType||("payment"===this.activityType?(s.amount=this.paymentAmount,this.amountRemaining-=this.payments,this.$store.state.schedules.amountRemaining=this.amountRemaining,s.title="".concat(this.event.eventCode).concat(e,"_").concat(this.activityType,"_").concat(this.paymentCount),s.id="".concat(this.event.eventCode).concat(this.activityType,"_").concat(this.paymentCount)):(s.title="".concat(this.event.eventCode).concat(e,"_").concat(this.activityType,"_").concat(this.workshopCount),s.id="".concat(this.event.eventCode).concat(this.activityType,"_").concat(this.workshopCount))),i>=0){var a=this.activities[this.editIndex].type;this.activities.splice(this.editIndex,1);var o=this.$lodash.findIndex(this.activities,function(e){return e.type===t.activityType});this.activities.splice(o,1),this.$store.commit("schedules/addNewActivity",s),console.log("type",this.activityType),console.log("currenttype",a);var n=this.$lodash.findIndex(this.kidsFashionCourse,function(t){return t.value===a});n>=0&&(this.kidsFashionCourse[n].visible=!0)}else console.log("less than 0"),this.activities.splice(this.editIndex,1),this.$store.commit("schedules/addNewActivity",s)}else{console.log("batch number",this.$store.state.schedules.batchNumber);var c=this.$store.state.schedules.batchNumber,l={eventkey:this.event[".key"],type:this.activityType,startDate:this.setActivityTime,endDate:this.isPhotoLikingDueDate,title:"".concat(this.event.eventCode).concat(c,"_").concat(this.activityType),capacity:this.activityCapacity,location:this.activityLocation,id:this.event.eventCode+this.activityType,classes:this.$store.state.schedules.event.eventColor};if(this.$store.commit("schedules/addNewActivity",l),"payment"===this.activityType||"workshop"===this.activityType){"payment"===this.activityType?(l.amount=this.paymentAmount,this.amountRemaining-=this.paymentAmount,this.$store.state.schedules.amountRemaining=this.amountRemaining,console.log("store amount",this.$store.state.schedules.amountRemaining),l.title="".concat(this.event.eventCode).concat(c,"_").concat(this.activityType,"_").concat(this.paymentCount),l.id="".concat(this.event.eventCode).concat(this.activityType,"_").concat(this.paymentCount)):(l.title="".concat(this.event.eventCode).concat(c,"_").concat(this.activityType,"_").concat(this.workshopCount),l.id="".concat(this.event.eventCode).concat(this.activityType,"_").concat(this.workshopCount));var h=this.$lodash.findIndex(this.kidsFashionCourse,function(t){return t.value===l.type});h>=0&&(this.kidsFashionCourse[h].visible=!0)}else{var r=this.$lodash.findIndex(this.kidsFashionCourse,function(t){return t.value===l.type});console.log("activity type",this.activityType),r>=0&&(this.kidsFashionCourse[r].visible=!1)}}this.getRemainingAmount("payments"),this.newActivityModal=!1,this.$store.getters["schedules/getSeeAllSchedules"]},removeActivity:function(){var t=this.$store.state.schedules.activities[this.editIndex].type;console.log("type",t);var e=this.$lodash.findIndex(this.kidsFashionCourse,function(e){return e.value===t});console.log("index",e),this.kidsFashionCourse[e].visible=!0,"orientation"===t?this.activityList.push({label:"Orientation",value:"orientation"}):"photoshoot"===t?this.activityList.push({label:"Photoshoot",value:"photoshoot"}):"photoliking"===t?this.activityList.push({label:"PhotoLiking",value:"photoliking"}):"generalRehersal"===t?this.activityList.push({label:"General Rehersal",value:"generalRehersal"}):this.activityList.push({label:"Final Rehersal",value:"finalRehersal"}),console.log("remove act",this.$store.state.schedules.activities[this.editIndex]),"payment"===t&&(this.amountRemaining+=this.$store.state.schedules.activities[this.editIndex].amount,this.$store.state.schedules.amountRemaining=this.amountRemaining),this.$store.commit("schedules/removeActivity",this.editIndex),this.$store.commit("schedules/updateTaskList",t),this.newActivityModal=!1},thisMonth:function(t,e,i){var s=new Date;return new Date(s.getFullYear(),s.getMonth(),t,e||0,i||0)},setShowDate:function(t){this.showDate=t},clickDate:function(t){if(this.$store.state.schedules.isCreateNewBatch){var e=new Date,i=this.$mathMixin.dayDiff(e,t);console.log("elen",i),i>=1&&(this.activityDate=t,this.newActivityModal=!0)}else this.$q.notify({message:"Please add new batch",type:"warning",color:"warning",textColor:"white",position:"bottom-left",icon:"info",timeout:2e3})},clickEvent:function(t){var e=this;console.log("date",t);var i=t.originalEvent.batchKey;if(!i){this.isEdit=!0,this.selectedEvent=t,this.activityType=t.originalEvent.type,this.activityTime=t.originalEvent.startDate,this.activityDate=t.originalEvent.startDate,this.activityCapactiy=t.originalEvent.capacity,this.activityLocation=t.originalEvent.location,this.paymentAmount=t.originalEvent.amount,this.editIndex=this.$lodash.findIndex(this.activities,function(e){return e.id===t.id});var s=this.$lodash.findIndex(this.kidsFashionCourse,function(t){return t.value===e.activityType});this.actComponents.time=this.kidsFashionCourse[s].time,this.actComponents.location=this.kidsFashionCourse[s].location,this.actComponents.capacity=this.kidsFashionCourse[s].capacity,this.actComponents.dueDate=this.kidsFashionCourse[s].dueDate,console.log("components",this.actComponents),this.newActivityModal=!0}},dropOnDate:function(t,e){var i=this.$mathMixin.dayDiff(t.startDate,e),s=this.$mathMixin.dayDiff(this.showDate,e);console.log("elength2",s),console.log("elength",i),s>=1&&(t.originalEvent.startDate=this.$mathMixin.addDays(t.startDate,i),t.originalEvent.endDate=this.$mathMixin.addDays(t.endDate,i),console.log("this",this.events))}},beforeRouteLeave:function(t,e,i){if(console.log("activities",this.activities),null===this.activities||0===this.activities.length)console.log("no changes"),i();else{console.log("has changes");var s=window.confirm("Do you really want to leave? you have unsaved changes!");s?(this.$store.commit("schedules/clearActivities"),this.$store.commit("schedules/restoreTaskList"),this.$store.commit("schedules/updateIsCreateNewBatch",!1),i()):(console.log("false"),i(!1))}}},r=h,v=(i("ci3j"),i("KHd+")),u=Object(v["a"])(r,s,a,!1,null,null,null);e["default"]=u.exports},ci3j:function(t,e,i){"use strict";var s=i("v85C"),a=i.n(s);a.a},v85C:function(t,e,i){}}]);