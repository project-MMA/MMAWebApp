(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{MjWO:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-page",[s("q-toolbar",{attrs:{color:"faded"}},[s("q-toolbar-title",[s("span",{staticClass:"q-title"},[t._v(t._s(t.getEventName))]),s("q-breadcrumbs",{attrs:{color:"white","active-color":"info",separator:">"}},[s("q-breadcrumbs-el",{staticClass:"q-subheading text-weight-bold",attrs:{active:"",color:"info",label:"Events",to:"/events"}}),s("q-breadcrumbs-el",{staticClass:"q-subheading text-weight-bold",attrs:{active:"",color:"info",label:"Seasons",to:{name:"eventSeason",params:{id:t.eventKey}}}}),s("q-breadcrumbs-el",{staticClass:"q-subheading text-weight-bold",attrs:{active:"",color:"info",label:"Batch"}})],1)],1),t.isNewBatch||t.$store.state.users.isNewSeasonActivities||t.editMode?t._e():s("div",[s("span",{staticClass:"q-caption"},[t._v("View Mode: ")]),s("q-btn-toggle",{staticClass:"q-mx-md",attrs:{rounded:"",size:"sm","toggle-color":"primary",options:[{label:"Batch",value:"batchMode"},{label:"Calendar",value:"calendarMode"},{label:"Agenda",value:"agendaMode"}]},on:{click:t.switchMode},model:{value:t.viewMode,callback:function(e){t.viewMode=e},expression:"viewMode"}})],1),s("div",{staticClass:"q-mr-md\t"},[t.isNewBatch?s("q-toggle",{attrs:{label:"All Batches"},model:{value:t.viewAllBatches,callback:function(e){t.viewAllBatches=e},expression:"viewAllBatches"}}):t._e()],1),t.$store.state.users.isNewSeasonActivities||t.isNewBatch||t.editMode?s("div",[s("q-btn",{staticClass:"q-my-md",attrs:{size:"sm",rounded:"",inverted:"",color:"secondary"},on:{click:t.saveSeasonActivities}},[t._v("Save")]),s("q-btn",{staticClass:"q-my-md",attrs:{size:"sm",rounded:"",inverted:"",color:"negative"},on:{click:t.cancel}},[t._v("Cancel")])],1):t._e(),s("q-btn-group",{attrs:{outline:""}},[t.$store.state.users.isNewSeasonActivities||t.isNewBatch||t.editMode?t._e():s("q-btn",{attrs:{color:"positive",size:"sm",rounded:""},on:{click:function(e){t.checkIfCompleteDetails()}}},[t._v("New Batch")]),t.$store.state.users.isNewSeasonActivities||t.isNewBatch||t.editMode?t._e():s("q-btn",{attrs:{color:"primary",rounded:"",size:"sm",label:"Edit Batch"},on:{click:t.editBatch}})],1),t.isCalendarView||t.isNewBatch||t.$store.state.users.isNewSeasonActivities?s("q-btn",{staticClass:"q-ml-md",attrs:{icon:"keyboard_arrow_left",size:"sm",color:"info",rounded:"",label:"activity list"},on:{click:function(e){t.showRight=!t.showRight,t.generateBatchNodes()}}}):t._e()],1),s("div"),s("div",{staticClass:"q-ma-md"},[t.$store.state.users.isNewSeasonActivities||t.isNewBatch||t.isCalendarView||t.isAgendaView?t._e():s("q-table",{attrs:{data:t.customBatches,columns:t.customColumns,pagination:t.pagination,separator:"cell",title:"Batches","no-data-label":"No Batch Yet","row-key":"batch"},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"top-right",fn:function(t){}},{key:"body-cell-batch",fn:function(e){return s("q-td",{attrs:{props:e}},[t._v("\n\t\t\t\t\t"+t._s(t.getBatch(e.row))+"\n\t\t\t\t")])}},{key:"body-cell-signedModels",fn:function(e){return s("q-td",{staticStyle:{width:"100px"},attrs:{props:e}},[t._v("\n\t\t\t\t\t"+t._s(t.getNumOfSignedModels(e.row))+"\n\t\t\t\t")])}},{key:"body-cell-action",fn:function(e){return s("q-td",{attrs:{props:e}},[t.isAbleToRemove(e)?s("q-btn",{attrs:{icon:"delete",round:"",color:"negative"},on:{click:function(s){t.removeBatch(e)}}}):t._e()],1)}}])})],1),t.$store.state.users.isNewSeasonActivities||t.isNewBatch||t.isCalendarView?s("div",{staticClass:"col calendar-parent",staticStyle:{"max-height":"100vw",height:"70vw"}},[s("calendar-view",{key:Date.now(),staticClass:"theme-default holiday-us-traditional q-ma-md",attrs:{"show-date":t.showDate,events:t.switchCalendarEvent,"show-event-times":t.showEventTimes,enableDragDrop:t.enableDragDrop,timeFormatOptions:{hour:"numeric",minute:"numeric",hour12:!0},startingDayOfWeek:t.startingDayOfWeek},on:{"show-date-change":t.setShowDate,"click-date":t.clickDate,"click-event":t.clickEvent,"drop-on-date":t.dropOnDate}})],1):t._e(),t.isAgendaView?s("div",[s("calendar-agenda",{staticClass:"q-ma-md",attrs:{"start-date":t.showDate,"event-array":t.agendaActivities,"allow-editing":!1}})],1):t._e(),s("q-modal",{attrs:{"content-css":{minWidth:"30vw",minHeight:"50vh"}},on:{hide:t.clearActivityModal},model:{value:t.activityModal,callback:function(e){t.activityModal=e},expression:"activityModal"}},[s("q-modal-layout",{attrs:{"content-class":"{'bg-primary': true}","footer-class":"","footer-style":"{fontSize: '24px', fontWeight: 'bold'}"}},[s("q-toolbar",[s("q-toolbar-title",[t._v("\n\t\t\t\t\t\t"+t._s(t.activity.originalEvent.title)+"\n          ")]),s("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:function(e){t.activityModal=!1}}})],1),s("div",[s("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",type:"text","stack-label":"Activity"},model:{value:t.activity.originalEvent.type,callback:function(e){t.$set(t.activity.originalEvent,"type",e)},expression:"activity.originalEvent.type"}}),t.activity.originalEvent.startDate&&"orientation"!==t.activity.originalEvent.type&&t.activity.originalEvent.type!==t.getBatchFinalEvent.type?s("q-datetime",{staticClass:"q-ma-md",attrs:{disable:"",min:t.getStartDateMin(t.activity.originalEvent),format:"MMM-DD-YYYY","stack-label":"Date",type:"date"},model:{value:t.activity.originalEvent.startDate,callback:function(e){t.$set(t.activity.originalEvent,"startDate",e)},expression:"activity.originalEvent.startDate"}}):t._e(),"payment"===t.activity.originalEvent.type?s("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",prefix:"P",type:"number","stack-label":"Amount"},model:{value:t.activity.originalEvent.amount,callback:function(e){t.$set(t.activity.originalEvent,"amount",e)},expression:"activity.originalEvent.amount"}}):t._e(),t.activity.originalEvent.time?s("q-datetime",{staticClass:"q-ma-md",attrs:{disable:!t.editMode&&!t.isNewBatch,format:"h:mm A","stack-label":"Time",type:"time"},model:{value:t.activity.originalEvent.time,callback:function(e){t.$set(t.activity.originalEvent,"time",e)},expression:"activity.originalEvent.time"}}):t._e(),t.activity.originalEvent.dueDate?s("q-datetime",{staticClass:"q-ma-md",attrs:{disable:!t.editMode&&!t.isNewBatch,format:"MMM-DD-YYYY",min:t.$mathMixin.addDays(new Date(t.activity.originalEvent.startDate),1),"stack-label":"Due Date",type:"date"},model:{value:t.activity.originalEvent.dueDate,callback:function(e){t.$set(t.activity.originalEvent,"dueDate",e)},expression:"activity.originalEvent.dueDate"}}):t._e(),""!==t.activity.originalEvent.location&&!t.activity.originalEvent.location||t.activity.originalEvent.dueDate||t.activity.originalEvent.amount?t._e():s("q-input",{staticClass:"q-ma-md",attrs:{disable:!t.editMode&&!t.isNewBatch,type:"textarea","stack-label":"Location",rows:"7"},model:{value:t.activity.originalEvent.location,callback:function(e){t.$set(t.activity.originalEvent,"location",e)},expression:"activity.originalEvent.location"}},[s("q-autocomplete",{attrs:{"min-characters":0,debounce:700},on:{search:t.searchLocation,selected:t.selected}})],1),""!==t.activity.originalEvent.details&&!t.activity.originalEvent.details||t.activity.originalEvent.dueDate||t.activity.originalEvent.amount?t._e():s("q-input",{staticClass:"q-ma-md",attrs:{disable:!t.editMode&&!t.isNewBatch,type:"textarea","stack-label":"Details",rows:"7"},model:{value:t.activity.originalEvent.details,callback:function(e){t.$set(t.activity.originalEvent,"details",e)},expression:"activity.originalEvent.details"}},[s("q-autocomplete",{attrs:{"min-characters":0,debounce:700},on:{search:t.searchDetails,selected:t.selected}})],1)],1),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("q-btn",{staticClass:"full-width",attrs:{color:"primary"},on:{click:t.saveActivity}},[t._v("OK")])],1)],1)],1),s("q-modal",{attrs:{"content-css":{minWidth:"50vw",minHeight:"50vh"}},on:{hide:t.clearNewBatch},model:{value:t.newBatchModal,callback:function(e){t.newBatchModal=e},expression:"newBatchModal"}},[s("q-modal-layout",{attrs:{"content-class":"{'bg-primary': true}","footer-class":"","footer-style":"{fontSize: '24px', fontWeight: 'bold'}"}},[s("q-toolbar",[s("q-toolbar-title",[t._v("\n            New Batch\n          ")]),s("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:function(e){t.activityModal=!1}}})],1),s("div",[s("q-datetime",{staticClass:"q-ma-md",attrs:{disable:"",min:t.getLastBatchOrientation,max:t.getBatchFinalEvent.startDate,format:"MMM-DD-YYYY","stack-label":"Batch Start",type:"date"},model:{value:t.newBatchStartDate,callback:function(e){t.newBatchStartDate=e},expression:"newBatchStartDate"}}),t.newBatchStartDate?s("div",[t.is4BatchMax?s("q-field",{staticClass:"q-mx-md",attrs:{orientation:"vertical"}},t._l(t.getWorkshopActivity,function(e,i){return s("div",{key:i,staticClass:"q-my-md"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("span",{staticClass:"caption q-my-md"},[t._v("Workshop "+t._s(i+1))]),s("q-datetime",{attrs:{disable:"",max:new Date(t.getSeasonEnd),format:"MMM-DD-YYYY","stack-label":"Date",type:"date"},model:{value:t.workshops.startDate[i],callback:function(e){t.$set(t.workshops.startDate,i,e)},expression:"workshops.startDate[i]"}}),s("q-datetime",{attrs:{format:"h:mm A","stack-label":"Time",type:"time"},model:{value:t.workshops.time[i],callback:function(e){t.$set(t.workshops.time,i,e)},expression:"workshops.time[i]"}}),s("q-input",{attrs:{"float-label":"Location","max-height":100,rows:"7",type:"textarea"},model:{value:t.workshops.location[i],callback:function(e){t.$set(t.workshops.location,i,e)},expression:"workshops.location[i]"}},[s("q-autocomplete",{attrs:{"min-characters":0,debounce:700},on:{search:t.searchLocation,selected:t.selected}})],1),t.getWorkshop.details?s("q-input",{attrs:{"float-label":"Details",type:"textarea","max-height":50,rows:"5"},model:{value:t.workshops.details[i],callback:function(e){t.$set(t.workshops.details,i,e)},expression:"workshops.details[i]"}},[s("q-autocomplete",{attrs:{"min-characters":0,debounce:700},on:{search:t.searchDetails,selected:t.selected}})],1):t._e()],1)]),s("q-item-separator")],1)})):t._e()],1):t._e()],1),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("q-btn",{staticClass:"full-width",attrs:{color:"primary"},on:{click:function(e){t.confirmNewBatch()}}},[t._v("OK")])],1)],1)],1),s("q-modal",{attrs:{"content-css":{minWidth:"50vw",minHeight:"50vh"}},on:{hide:t.clearNewBatch},model:{value:t.batchNodeActivityModal,callback:function(e){t.batchNodeActivityModal=e},expression:"batchNodeActivityModal"}},[s("q-modal-layout",{attrs:{"content-class":"{'bg-primary': true}","footer-class":"","footer-style":"{fontSize: '24px', fontWeight: 'bold'}"}})],1)],1),s("q-layout-drawer",{attrs:{"content-class":"bg-grey-3 flex ","content-style":{padding:"10px"},side:"right"},model:{value:t.showRight,callback:function(e){t.showRight=e},expression:"showRight"}},[s("div",[s("q-btn",{staticClass:"flex flex-right",attrs:{rounded:"",color:"info",label:"hide",icon:"keyboard_arrow_right",size:"xs"},on:{click:function(e){t.showRight=!t.showRight}}}),s("div",[s("span",{staticClass:"q-title text-weight-bold q-ma-md"},[t._v(t._s(t.getEventName))]),s("br"),s("span",{staticClass:"q-title q-mx-md"},[t._v("Season "+t._s(t.seasonNumber))]),s("q-tree",{attrs:{nodes:t.batchNode,"node-key":"label",accordion:"",selected:t.selectNode,"default-expand-all":""},on:{"update:selected":function(e){t.selectNode=e}},scopedSlots:t._u([{key:"default-header",fn:function(e){return s("div",{staticClass:"row items-center",on:{click:function(s){t.clickBatchNode(e)}}},[t.isBatchMissingDetails(e)?s("q-icon",{staticClass:"q-mr-sm",attrs:{name:"warning",color:"orange",size:"28px"}}):t._e(),s("div",{staticClass:"text-weight-bold text-primary"},[t.isMissingDetails(e)?s("q-icon",{staticClass:"q-mr-sm",attrs:{name:"warning",color:"orange",size:"28px"}}):t._e(),t._v("\n\t\t\t\t\t\t"+t._s(e.node.label))],1)],1)}},{key:"default-body",fn:function(e){return s("div",{},[e.node.startDate?s("div",[s("span",{staticClass:"text-weight-bold"},[t._v("Date")]),t._v(": "+t._s(t.$moment(e.node.startDate).format("ll"))+"\n\t\t\t\t\t\t")]):t._e(),e.node.amount?s("div",[s("span",{staticClass:"text-weight-bold"},[t._v("Amount")]),t._v(": "+t._s(t._f("currency")(e.node.amount))+"\n\t\t\t\t\t\t")]):t._e(),e.node.dueDate?s("div",[s("span",{staticClass:"text-weight-bold"},[t._v("Date End")]),t._v(": "+t._s(t.$moment(e.node.dueDate).format("ll"))+"\n\t\t\t\t\t\t")]):t._e()])}}])})],1)],1)])],1)},a=[],n=(s("rGqo"),s("yt8O"),s("RW0V"),s("91GP"),s("INYr"),s("a1Th"),s("MVZn")),o=s.n(n),r=(s("SRfc"),s("RIqP")),c=s.n(r),h=s("VVcl"),l=s.n(h),d=s("kv6+"),v=s("wdPS"),u={created:function(){this.eventKey=this.$route.params.id,this.viewMode="batchMode",this.seasonNumber=this.$route.params.seasonNumber,this.$store.state.users.isNewSeasonActivities&&(this.editMode=!0,this.setShowDate(new Date(this.$store.state.users.newSeasonActivities[0].startDate)))},mounted:function(){this.$bindAsArray("schedules2",this.$database.ref("event_schedules")),this.$store.state.startUp.schedules=this.schedules2},components:{CalendarView:l.a,CalendarAgenda:d["b"]},watch:{isCalendarView:{handler:function(t,e){if(t){for(var s=[],i=0;i<this.getSeasonBatches.length;i++)for(var a=0;a<this.getSeasonBatches[i].activities.length;a++)s.push(this.getSeasonBatches[i].activities[a]);for(var n=0;n<s.length;n++)s[n].startDate=new Date(s[n].startDate),s[n].endDate=new Date(s[n].endDate),s[n].dueDate=s[n].dueDate?new Date(s[n].dueDate):"",s[n].time=s[n].time?new Date(s[n].time):"";this.$store.state.users.newSeasonActivities=s,this.setShowDate(new Date(s[0].startDate)),this.generateBatchNodes()}else this.$store.state.users.newSeasonActivities=[],this.$store.state.users.batchNode=[]},deep:!0},isAgendaView:{handler:function(t,e){if(t){var s=this.getSeasonBatchesActivities;console.log("activities",s);var i=this.$lodash.map(s,function(t){if("payment"!==t.type)return{id:t.id,summary:t.title,description:t.details?t.details:"",location:t.location?t.location:"",start:{dateTime:new Date(t.startDate).toISOString()},end:{dateTime:new Date(t.endDate).toISOString()},color:"faded"}});this.agendaActivities=this.$lodash.compact(i),this.setShowDate(new Date(s[0].startDate))}else this.agendaActivities=[]},deep:!0},viewAllBatches:function(){if(console.log("watching viewall",this.viewAllBatches),this.viewAllBatches){console.log("batches",this.getSeasonBatches),console.log("newSeasonActivities",this.$store.state.users.newSeasonActivities);for(var t=this.getSeasonBatches,e=c()(this.$store.state.users.newSeasonActivities),s=0;s<t.length;s++)for(var i=0;i<t[s].activities.length;i++)t[s].activities[i].startDate=new Date(t[s].activities[i].startDate),t[s].activities[i].endDate=new Date(t[s].activities[i].endDate),t[s].activities[i].dueDate=t[s].activities[i].dueDate?new Date(t[s].activities[i].dueDate):"",t[s].activities[i].time=t[s].activities[i].time?new Date(t[s].activities[i].time):"",e.push(t[s].activities[i]);console.log("newSeasonAct",e),this.$store.state.users.seeAllBatch=e}else this.$store.state.users.seeAllBatch=[]},isNewSeasonActivities:function(){this.isNewSeasonActivities&&(this.viewMode="calendarMode")}},computed:{isCanAddAnotherBatch:function(){var t=this;if(this.is4BatchMax){for(var e=this.$lodash.filter(this.getLastBatch.activities,function(t){return"payment"===t.type})[2],s=this.$lodash.filter(this.getLastBatch.activities,function(e){return e.type===t.getOtherActivities[0].label})[0],i=this.$store.getters["startUp/getUpcomingWeekEnds"]({startDate:new Date(e.startDate),weekEnd:"sundays"}),a=new Array,n=0;n<i.length;n++){var o=this.$mathMixin.dayDiff(new Date(e.startDate),new Date(i[n]));o>0&&a.push(i[n])}a.splice(0,this.getWorkshopActivity.length);var r=new Array;for(n=0;n<a.length;n++){var c=this.$mathMixin.dayDiff(new Date(s.startDate),new Date(a[n]));c<0&&r.push(a[n])}return r.length>=this.getWorkshopActivity.length&&(r.length%this.getWorkshopActivity.length===0?(console.log("can add another 4 batch",r.length%this.getWorkshopActivity.length),!0):(console.log("bawal na mag add ng 4 batch"),!1))}return!0},getOtherActivities:function(){for(var t=[],e=c()(this.getCourse.activities),s=0;s<e.length;s++)"orientation"!==e[s].value&&"payment"!==e[s].value&&"photoshoot"!==e[s].value&&"photoliking"!==e[s].value&&"workshop"!==e[s].value&&e[s].value!==this.getFinalActivity.value&&t.push(e[s]);return t},getFinalActivity:function(){try{var t=this.getCourse.activities[this.getCourse.activities.length-1];return t}catch(t){return{}}},getCourse:function(){var t=this,e=this.$lodash.filter(this.$store.state.startUp.courses,function(e){return e[".key"]===t.getLastBatch.course});return e[0]},getLastBatch:function(){var t=this.$lodash.maxBy(this.getSeasonBatches,function(t){return t.batchNumber});return t},otherActivities:function(){for(var t=[],e=c()(this.course.activities),s=0;s<e.length;s++)"orientation"!==e[s].value&&"payment"!==e[s].value&&"photoshoot"!==e[s].value&&"photoliking"!==e[s].value&&"workshop"!==e[s].value&&e[s].value!==this.getFinalActivity.value&&t.push(e[s]);for(var i=0;i<t.length;i++)this.otherActivity.value.push(t[i].value),this.otherActivity.label.push(t[i].label);return this.otherActivities2=t,t},getSeasonBatchesActivities:function(){for(var t=this.getSeasonBatches,e=new Array,s=0;s<t.length;s++)for(var i=0;i<t[s].activities.length;i++)e.push(t[s].activities[i]);return e},seasonBatchContractSigned:function(){var t=this,e=this.$lodash.filter(this.contractSigned,function(e){var s=parseInt(e.seasonName.match(/\d+/g)[0]);return e.eventKey===t.eventKey&&s===parseInt(t.seasonNumber)});return e},contractSigned:{get:function(){return this.$store.state.startUp.contractSigned},set:function(t){this.$store.state.startUp.contractSigned=t}},switchCalendarEvent:function(){return this.viewAllBatches?this.$store.state.users.seeAllBatch:this.$store.state.users.newSeasonActivities},isWorkshopIsAhead:function(){if(!this.$store.state.users.isNewSeasonActivities){this.batch0=o()({},this.getSeasonBatches[0]);for(var t=this.$store.getters["startUp/getPlainValue"](this.getSeasonBatches[0]),e=this.getSeasonBatches.length,s=0;s<t.activities.length;s++)t.activities[s].startDate=t.activities[s].startDate.toString(),t.activities[s].endDate=t.activities[s].endDate.toString();++e;var i=this.$lodash.findIndex(t.activities,function(t){return"orientation"===t.type});t.activities[i].startDate=new Date(this.newBatchStartDate),t.activities[i].endDate=new Date(this.newBatchStartDate),t.activities[i].startDate.setHours(0,0,0,0),t.activities[i].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_orientation"),t.activities[i].title="Batch(".concat(e,")_orientation");for(var a=this.$store.getters["users/convertToDays"]({dateType:this.getPaymentCourseActivity.dayAfter.dateType,dateNumber:this.getPaymentCourseActivity.dayAfter.dateNumber}),n=this.$lodash.filter(t.activities,function(t){return"payment"===t.type}),r=0;r<n.length;r++)0===r?(n[r].startDate=this.$mathMixin.addDays(new Date(this.newBatchStartDate),3),n[r].endDate=this.$mathMixin.addDays(new Date(this.newBatchStartDate),3),n[r].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_payment(").concat(r+1,")"),n[r].title="Batch(".concat(e,")_payment(").concat(r+1,")")):(n[r].startDate=this.$mathMixin.addDays(new Date(n[r-1].startDate),a),n[r].endDate=this.$mathMixin.addDays(new Date(n[r-1].startDate),a),n[r].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_payment(").concat(r+1,")"),n[r].title="Batch(".concat(e,")_payment(").concat(r+1,")"));var c=this.$store.getters["users/convertToDays"]({dateType:this.getPhotoshootCourseActivity.dayAfter.dateType,dateNumber:this.getPhotoshootCourseActivity.dayAfter.dateNumber}),h=this.$lodash.findIndex(t.activities,function(t){return"photoshoot"===t.type});t.activities[h].startDate=this.$mathMixin.addDays(new Date(n[0].startDate),c),t.activities[h].endDate=this.$mathMixin.addDays(new Date(n[0].startDate),c),t.activities[h].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_photoshoot"),t.activities[h].title="Batch(".concat(e,")_photoshoot");this.$store.getters["users/convertToDays"]({dateType:this.getPhotolikingCourseActivity.dayAfter.dateType,dateNumber:this.getPhotolikingCourseActivity.dayAfter.dateNumber});var l=this.$lodash.findIndex(t.activities,function(t){return"photoliking"===t.type});t.activities[l].startDate=this.$mathMixin.addDays(new Date(n[1].startDate),c),t.activities[l].endDate=this.$mathMixin.addDays(new Date(n[1].startDate),14),t.activities[l].dueDate=this.$mathMixin.addDays(new Date(n[1].startDate),14),t.activities[l].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_photoliking"),t.activities[l].title="Batch(".concat(e,")_photoliking");for(var d=0,v=0;v<t.activities.length;v++)"orientation"!==t.activities[v].type&&"payment"!==t.activities[v].type&&"photoshoot"!==t.activities[v].type&&"photoliking"!==t.activities[v].type&&(t.activities[v].startDate=new Date(t.activities[v].startDate),t.activities[v].endDate=new Date(t.activities[v].endDate),t.activities[v].time=t.activities[v].time?new Date(t.activities[v].time):"",t.activities[v].dueDate=t.activities[v].dueDate?new Date(t.activities[v].dueDate):"",t.activities[v].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_").concat(t.activities[v].type),t.activities[v].title="Batch(".concat(e,")_").concat(t.activities[v].type),"workshop"===t.activities[v].type&&(d++,console.log("found workshop",d),t.activities[v].startDate=new Date(t.activities[v].startDate),t.activities[v].endDate=new Date(t.activities[v].endDate),t.activities[v].time=new Date(t.activities[v].startDate),t.activities[v].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_").concat(t.activities[v].type,"(").concat(d,")"),t.activities[v].title="Batch(".concat(e,")_").concat(t.activities[v].type,"(").concat(d,")")));for(var u=new Array,g=0;g<n.length;g++)g<=3&&u.push(n[g]);var y=u[u.length-1],p=this.$lodash.filter(t.activities,function(t){return"workshop"===t.type});if(0===p.length)return!1;var f=this.$mathMixin.dayDiff(new Date(y.startDate),new Date(p[0].startDate));return this.generatedBatchActivities=o()({},t),f>0?(console.log("ahead pa ung workshop"),!1):(console.log("di na ahead ung workshop"),!0)}},getSeasonStatus:function(){try{return this.$store.getters["startUp/getSeason"]({eventKey:this.eventKey,seasonNumber:this.seasonNumber}).status}catch(t){}},batchNodeActivityModal:{get:function(){return this.$store.state.users.batchNodeActivityModal},set:function(t){this.$store.state.users.batchNodeActivityModal=t}},parseDetails:function(){return this.$store.getters["startUp/parseDetails"]},parseLocations:function(){return this.$store.getters["startUp/parseLocations2"]},upcomingSundays:function(){try{var t=this.$store.getters["users/getLastOf3Payment"](this.generatedBatchActivities.activities);return this.$store.getters["startUp/getUpcomingSundays2"](t.startDate)}catch(t){return[]}},batchNode:{get:function(){return this.$store.state.users.batchesNode},set:function(t){this.$store.state.users.batchesNode=t}},viewMode:{get:function(){return this.$store.state.users.viewMode},set:function(t){this.$store.state.users.viewMode=t}},isCalendarView:function(){return"calendarMode"===this.viewMode},isAgendaView:function(){return"agendaMode"===this.viewMode},mergeBatches:function(){for(var t=[],e=0;e<this.getSeasonBatches.length;e++)for(var s=0;s<this.getSeasonBatches[e].activities.length;s++)t.push(this.getSeasonBatches[e].activities[e]);for(var i=0;i<t.length;i++)t[i].startDate=new Date(t[i].startDate),t[i].endDate=new Date(t[i].endDate);console.log("merge batches to calendar",t),this.$store.state.users.newSeasonActivities=t},getBatchNewOrientation:function(){return this.$store.state.users.newSeasonActivities[0]},activityModal:{get:function(){return this.$store.state.users.activityModal2},set:function(t){this.$store.state.users.activityModal2=t}},activity:{get:function(){return this.$store.state.users.activity},set:function(t){return this.$store.state.users.activity=t}},showRight:{get:function(){return this.$store.state.users.showRight},set:function(t){return this.$store.state.users.showRight=t}},is4BatchMax:function(){return this.getSeasonBatches.length%4===0?(this.generateWorkshopScheds(),console.log("found modulo of 4"),!0):(console.log("is not 4 batch max"),!1)},getWorkshopActivity:function(){try{console.log("getWorkshopActivity",this.getSeasonBatches);var t=this.getSeasonBatches.length,e=o()({},this.getSeasonBatches[t-1]),s=this.$lodash.filter(e.activities,function(t){return"workshop"===t.type}),i=Object.assign([],s);console.log("worksho",i);for(var a=0;a<i.length;a++)i[a].newStartDate="";return i}catch(t){return[]}},course:function(){return this.$store.getters["startUp/getCourse"](this.getSeasonBatches[0].course)},getWorkshop:function(){try{var t=this.$lodash.findIndex(this.course.activities,function(t){return"workshop"===t.value});return this.course.activities[t]}catch(t){return{}}},getSeasonEnd:function(){try{return this.getSeasonBatches[0].seasonEnd}catch(t){return""}},getEventName:function(){try{return this.$store.getters["startUp/getEvent"](this.eventKey).eventName}catch(t){return""}},getBatchFinalEvent:function(){try{var t=this.getSeasonBatches[0].activities.length-1;return this.getSeasonBatches[0].activities[t]}catch(t){return""}},getLastBatchOrientation:function(){try{return this.$mathMixin.addDays(new Date(this.getSeasonBatches[this.getSeasonBatches.length-1].activities[0].startDate),1).toString()}catch(t){return""}},newBatchModal:{get:function(){return this.$store.state.users.newBatchModal},set:function(t){this.$store.state.users.newBatchModal=t}},getColumnsActivities:function(){for(var t=[],e=0,s=0,i=0;i<this.getSeasonBatches[0].activities.length;i++){var a={};"payment"===this.getSeasonBatches[0].activities[i].type.toLowerCase()?(e++,a[this.getSeasonBatches[0].activities[i].type+e]={startDate:this.getSeasonBatches[0].activities[i].startDate,endDate:this.getSeasonBatches[0].activities[i].endDate,dueDate:this.getSeasonBatches[0].activities[i].dueDate,location:this.getSeasonBatches[0].activities[i].location,time:this.getSeasonBatches[0].activities[i].time,amount:this.getSeasonBatches[0].activities[i].amount,type:this.getSeasonBatches[0].activities[i].type,name:this.getSeasonBatches[0].activities[i].id,classes:this.getSeasonBatches[0].activities[i].classes,title:this.getSeasonBatches[0].activities[i].title}):"workshop"===this.getSeasonBatches[0].activities[i].type.toLowerCase()?(s++,a[this.getSeasonBatches[0].activities[i].type+s]={startDate:this.getSeasonBatches[0].activities[i].startDate,endDate:this.getSeasonBatches[0].activities[i].endDate,dueDate:this.getSeasonBatches[0].activities[i].dueDate,location:this.getSeasonBatches[0].activities[i].location,time:this.getSeasonBatches[0].activities[i].time,amount:this.getSeasonBatches[0].activities[i].amount,type:this.getSeasonBatches[0].activities[i].type,name:this.getSeasonBatches[0].activities[i].id,classes:this.getSeasonBatches[0].activities[i].classes,title:this.getSeasonBatches[0].activities[i].title}):a[this.getSeasonBatches[0].activities[i].type.toLowerCase()]={startDate:this.getSeasonBatches[0].activities[i].startDate,endDate:this.getSeasonBatches[0].activities[i].endDate,dueDate:this.getSeasonBatches[0].activities[i].dueDate,location:this.getSeasonBatches[0].activities[i].location,time:this.getSeasonBatches[0].activities[i].time,amount:this.getSeasonBatches[0].activities[i].amount,type:this.getSeasonBatches[0].activities[i].type,name:this.getSeasonBatches[0].activities[i].id,classes:this.getSeasonBatches[0].activities[i].classes,title:this.getSeasonBatches[0].activities[i].title},t.push(a)}return t},customColumns:function(){var t=this;try{var e=0,s=0,i=this.$lodash.map(this.getSeasonBatches[0].activities,function(i){return"payment"===i.type?(e++,{align:"center",label:t.$store.getters["settings/titleCase"]("".concat(i.type," ").concat(e)),name:"".concat(i.type.toLowerCase()).concat(e),field:"".concat(i.type.toLowerCase()).concat(e),type:i.type,required:!0}):"workshop"===i.type?(s++,{align:"center",label:t.$store.getters["settings/titleCase"]("".concat(i.type," ").concat(s)),name:"".concat(i.type.toLowerCase()).concat(s),field:"".concat(i.type.toLowerCase()).concat(s),type:i.type,required:!0}):{align:"center",label:t.$store.getters["settings/titleCase"](i.type),name:i.type.toLowerCase(),type:i.type,field:"".concat(i.type.toLowerCase()),required:!0}});i.splice(0,0,{align:"center",label:"Batch",name:"batch",required:!0}),e=0,s=0,i=c()(i);var a={align:"center",label:"No. of Signed Models",name:"signedModels",style:"width: 500px"},n={align:"center",label:"Action",name:"action"};return i.push(a),i.push(n),i}catch(t){return[]}},customBatches:function(){for(var t=[],e=0,s=0,i=[],a=0;a<this.getSeasonBatches.length;a++){for(var n=0;n<this.getSeasonBatches[a].activities.length;n++){var o={};if("payment"===this.getSeasonBatches[a].activities[n].type.toLowerCase()){e++;var r=this.$moment(this.getSeasonBatches[a].activities[n].startDate).format("ll");o[this.getSeasonBatches[a].activities[n].type+e]=r}else if("workshop"===this.getSeasonBatches[a].activities[n].type.toLowerCase()){s++;r=this.$moment(this.getSeasonBatches[a].activities[n].startDate).format("ll");o[this.getSeasonBatches[a].activities[n].type+s]=r}else{r=this.$moment(this.getSeasonBatches[a].activities[n].startDate).format("ll");o[this.getSeasonBatches[a].activities[n].type.toLowerCase()]=r}t.push(o)}var c={};for(n=0;n<t.length;n++){var h=t[n];for(var l in h)"function"!=typeof h[l]&&(c[l]=h[l])}e=0,s=0,i.push(c)}return i},schedules:{get:function(){return this.$store.state.startUp.schedules},set:function(t){this.$store.state.startUp.schedules}},getBatches:function(){var t=this,e=this.$lodash.filter(this.schedules,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===parseInt(t.seasonNumber)});return e},getSeasonBatches:{get:function(){var t=this,e=c()(this.$store.state.startUp.schedules),s=this.$lodash.filter(e,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===parseInt(t.seasonNumber)});return this.batches=s,s},set:function(t){this.batches=t}},newSeason:function(){return this.$store.state.users.newSeason},newSeasonActivities:{get:function(){return this.$store.state.users.newSeasonActivities},set:function(t){this.$store.state.users.newSeasonActivities=t}},getPaymentCourseActivity:function(){var t=this,e=this.$store.getters["startUp/getEvent"](this.eventKey),s=this.$lodash.findIndex(this.$store.state.startUp.courses,function(s){return s[".key"]===e.seasons[t.seasonNumber-1].course}),i=this.$lodash.findIndex(this.$store.state.startUp.courses[s].activities,function(t){return"payment"===t.value});return this.$store.state.startUp.courses[s].activities[i]},getPhotoshootCourseActivity:function(){var t=this,e=this.$store.getters["startUp/getEvent"](this.eventKey),s=this.$lodash.findIndex(this.$store.state.startUp.courses,function(s){return s[".key"]===e.seasons[t.seasonNumber-1].course}),i=this.$lodash.findIndex(this.$store.state.startUp.courses[s].activities,function(t){return"photoshoot"===t.value});return this.$store.state.startUp.courses[s].activities[i]},getPhotolikingCourseActivity:function(){var t=this,e=this.$store.getters["startUp/getEvent"](this.eventKey),s=this.$lodash.findIndex(this.$store.state.startUp.courses,function(s){return s[".key"]===e.seasons[t.seasonNumber-1].course});console.log("i",s);var i=this.$lodash.findIndex(this.$store.state.startUp.courses[s].activities,function(t){return"photoliking"===t.value});return this.$store.state.startUp.courses[s].activities[i]}},data:function(){return{agendaActivities:[],someEventObject:[{id:1,summary:"Test event",description:"Some extra info goes here",location:"Office of the Divine Randomness, 1232 Main St., Denver, CO",start:{dateTime:"2018-10-14T00:00:00.000Z"},end:{dateTime:"2018-10-14T00:00:00.000Z"},color:"positive",attendees:[{id:5,email:"somebody@somewhere.com",displayName:"John Q. Public",organizer:!1,self:!1,resource:!1}]},{id:2,summary:"Test event",description:"Some extra info goes here",location:"Office of the Divine Randomness, 1232 Main St., Denver, CO",start:{dateTime:"2018-11-16T10:00:00"},end:{dateTime:"2018-11-16T10:00:00"},color:"positive",attendees:[{id:5,email:"somebody@somewhere.com",displayName:"John Q. Public",organizer:!1,self:!1,resource:!1}]}],viewAllBatches:"",editMode:!1,generatedBatchActivities:[],selectedNode:"",workshops:{startDate:[],endDate:[],location:[],details:[],time:[]},workshopLength:1,batch0:{},batches:[],messages:[],schedules2:[],isNewBatch:!1,newBatch:{batchNumber:"",startDate:""},newBatchStartDate:"",eventKey:"",seasonNumber:"",getAllActivities:[],showDate:new Date,showEventTimes:!0,enableDragDrop:!1,startingDayOfWeek:0,columns:[{name:"batch",required:!0,label:"batch",field:"batchNumber",align:"left"},{name:"orientation",required:!0,label:"Orientation",align:"left"},{name:"payments",required:!0,label:"Payment",align:"left"},{name:"photoshoot",required:!0,label:"Photoshoot",align:"left"},{name:"photoliking",required:!0,label:"Photoliking",align:"center"},{name:"workshops",required:!0,label:"Workshops",align:"center"},{name:"otherActivities",required:!0,label:"Other Activities",align:"center"},{name:"finalEvent",required:!0,label:"Final event",align:"left"}],pagination:{sortBy:null,descending:!1,page:1,rowsPerPage:0}}},methods:{isMissingDetails:function(t){var e="undefined"!==typeof t.node.location&&t.node.location,s="undefined"!==typeof t.node.details&&t.node.details;return(""===e||""===s)&&"payment"!==t.node.type&&"photoliking"!==t.node.type&&"orientation"!==t.node.type},isBatchMissingDetails:function(t){if(t.node.children)for(var e=t.node.children,s=0;s<e.length;s++)if((""===e[s].location||""===e[s].details)&&"payment"!==e[s].type&&"photoliking"!==e[s].type&&"orientation"!==e[s].type)return!0;return!1},routeToSeason:function(){this.$router.push("/eventseason/".concat(eventKey))},getSignedModelInBatch:function(t){console.log("getSignedModelInBatch",t)},activityType:function(t){return this.$store.getters["startUp/titleCase"](t)},editBatch:function(){this.editMode=!this.editMode,this.viewMode="calendarMode"},selected:function(t){console.log("item selected",t)},searchDetails:function(t,e){var s=this;setTimeout(function(){e(Object(v["a"])(t,{field:"value",list:s.parseDetails}))},1e3)},searchLocation:function(t,e){var s=this;setTimeout(function(){e(Object(v["a"])(t,{field:"value",list:s.parseLocations}))},500)},selectUpcomingDate:function(t,e){this.workshops.startDate[t]=e,this.$forceUpdate()},alreadySelected:function(t){try{var e=new Date(t);e.setHours(0,0,0,0);var s=this.$store.getters["users/getLastOf3Payment"](this.generatedBatchActivities.activities),i=this.$mathMixin.dayDiff(new Date(this.getBatchFinalEvent.startDate),e);i+=14;var a=this.$mathMixin.dayDiff(s.startDate,e);if(i>=0)return!1;if(a<=0)return!1;if(0!=this.workshops.startDate.length)for(var n=0;n<this.workshops.startDate.length;n++){var o=this.$mathMixin.dayDiff(new Date(this.workshops.startDate[n]),e);if(o<=0)return!1}return!0}catch(t){return!0}},generateBatchNodes:function(){this.batchNode=[];var t=new Array;if(this.isNewBatch){this.batchNode=[];for(var e=c()(this.getSeasonBatches),s=new Array,i=0;i<e.length;i++)s.push(e[i].activities);s.push(this.$store.state.users.newSeasonActivities);for(var a=0;a<s.length;a++){var n=a;n++;for(var o={label:"Batch "+n,children:new Array},r=new Array,h=0;h<s[a].length;h++){var l={label:this.$store.getters["startUp/hasNumber"](this.$store.getters["startUp/get3rdAfterUnderline"](s[a][h].id))?this.$store.getters["startUp/titleCase"](this.$store.getters["startUp/get3rdAfterUnderline"](s[a][h].id)):this.$store.getters["startUp/titleCase"](s[a][h].type),startDate:s[a][h].startDate.toString(),endDate:s[a][h].endDate.toString(),amount:s[a][h].amount?s[a][h].amount:"",dueDate:s[a][h].dueDate?s[a][h].dueDate:"",time:s[a][h].time?s[a][h].time:"",location:s[a][h].location?s[a][h].location:"",details:s[a][h].details?s[a][h].details:"",batch:s[a][h].batch,classes:s[a][h].classes,eventKey:s[a][h].eventKey,id:s[a][h].id,title:s[a][h].title,type:s[a][h].type};r.push(l)}o.children=r,t.push(o)}this.batchNode=t}else if(this.$store.state.users.isNewSeasonActivities){console.log("new season activities");var d=this.$store.state.users.newSeasonActivities,v={label:"Batch 1",children:new Array},u=new Array;for(h=0;h<d.length;h++){var g={label:this.$store.getters["startUp/hasNumber"](this.$store.getters["startUp/get3rdAfterUnderline"](d[h].id))?this.$store.getters["startUp/titleCase"](this.$store.getters["startUp/get3rdAfterUnderline"](d[h].id)):this.$store.getters["startUp/titleCase"](d[h].type),startDate:d[h].startDate.toString(),endDate:d[h].endDate.toString(),amount:d[h].amount?d[h].amount:"",dueDate:d[h].dueDate?d[h].dueDate:"",time:d[h].time?d[h].time:"",location:d[h].location?d[h].location:"",details:d[h].details?d[h].details:"",batch:d[h].batch,classes:d[h].classes,eventKey:d[h].eventKey,id:d[h].id,title:d[h].title,type:d[h].type};u.push(g)}v.children=u,t.push(v),this.batchNode=t}else{new Array;var y=this.$store.state.users.newSeasonActivities,p=new Array;for(i=1;i<=this.getSeasonBatches.length;i++){var f=this.$lodash.filter(y,function(t){return t.batch===i});p.push(f)}for(a=0;a<p.length;a++){n=a;n++;var m={label:"Batch "+n,children:new Array},D=new Array;for(h=0;h<p[a].length;h++){var w={label:this.$store.getters["startUp/hasNumber"](this.$store.getters["startUp/get3rdAfterUnderline"](p[a][h].id))?this.$store.getters["startUp/titleCase"](this.$store.getters["startUp/get3rdAfterUnderline"](p[a][h].id)):this.$store.getters["startUp/titleCase"](p[a][h].type),startDate:p[a][h].startDate.toString(),endDate:p[a][h].endDate.toString(),amount:p[a][h].amount?p[a][h].amount:"",dueDate:p[a][h].dueDate?p[a][h].dueDate:"",time:p[a][h].time?p[a][h].time:"",location:p[a][h].location?p[a][h].location:"",details:p[a][h].details?p[a][h].details:"",batch:p[a][h].batch,classes:p[a][h].classes,eventKey:p[a][h].eventKey,id:p[a][h].id,title:p[a][h].title,type:p[a][h].type};D.push(w)}m.children=D,t.push(m)}this.batchNode=t}},selectNode:function(t){console.log("n",t)},switchMode:function(){console.log("allAct",this.mergeBatches)},getStartDateMin:function(t){try{return this.$store.state.users.newSeasonActivities[0].startDate}catch(t){return""}},removeWorkshop:function(t){try{"undefined"!==typeof this.workshops.startDate[t]&&this.workshops.startDate.splice(t,1),"undefined"!==typeof this.workshops.location[t]&&this.workshops.location.splice(t,1),"undefined"!==typeof this.workshops.details[t]&&this.workshops.details.splice(t,1)}catch(t){}this.workshopLength--},workshopMinDate:function(t){try{if(!(t<2))return this.$mathMixin.addDays(new Date(this.workshops.startDate[t-1]),1).toString();if(0!=this.workshops.startDate.length){var e=this.$store.getters["users/getLastOf3Payment"](this.generatedBatchActivities.activities);return e.startDate}}catch(t){return""}},getSeasonBatches2:function(t,e){var s=this.$lodash.filter(this.schedules,function(s){return s.eventKey===t&&s.seasonNumber===parseInt(e)});return s},clearNewBatch:function(){this.newBatch.batchNumber="",this.newBatchStartDate="",this.workshops={startDate:[],endDate:[],location:[],details:[],time:[]},this.workshopLength=1},getField:function(t){for(var e=Object.keys(t),s=0;s<e.length;s++)return console.log("k",e[s]),"body-cell-".concat(e[s])},getNumberOfPayments:function(){return!1},getBatch:function(t){var e=o()({},t);return++e.__index},getOrientation:function(t){console.log("b",t.activities);var e=c()(t.activities),s=this.$lodash.findIndex(e,function(t){return"orientation"===t.type});return console.log("orientation",e[s]),e[s].startDate},getPayments:function(t){console.log("p",t)},newSeasonStart:function(){return new Date(this.newSeason.seasonStart)},clearActivityModal:function(){},saveActivity:function(){var t=this,e=this.$lodash.findIndex(this.newSeasonActivities,function(e){return e.id===t.activity.originalEvent.id});if(this.newSeasonActivities[e].dueDate=this.activity.originalEvent.dueDate,""===this.activity.originalEvent.dueDate&&"undefined"===typeof this.activity.originalEvent.dueDate||(this.newSeasonActivities[e].endDate=this.activity.originalEvent.dueDate),this.newSeasonActivities[e].details=this.activity.originalEvent.details,this.newSeasonActivities[e].location=this.activity.originalEvent.location,this.newSeasonActivities[e].time=this.activity.originalEvent.time,"open"===this.getSeasonStatus&&(this.newSeasonActivities[e].updated=!0),""!==this.activity.originalEvent.time&&"undefined"!==typeof this.activity.originalEvent.time){console.log("with time"),this.newSeasonActivities[e].startDate=new Date(this.activity.originalEvent.startDate),this.newSeasonActivities[e].endDate=new Date(this.activity.originalEvent.startDate);var s=new Date(this.activity.originalEvent.time).getHours(),i=new Date(this.activity.originalEvent.time).getMinutes();this.newSeasonActivities[e].endDate.setHours(s,i),this.newSeasonActivities[e].startDate.setHours(s,i)}else""!==this.activity.originalEvent.dueDate&&"payment"!==this.activity.originalEvent.type?(this.newSeasonActivities[e].startDate=new Date(this.activity.originalEvent.startDate),this.newSeasonActivities[e].endDate=new Date(this.activity.originalEvent.dueDate),console.log("act",this.newSeasonActivities[e])):(this.newSeasonActivities[e].startDate=new Date(this.activity.originalEvent.startDate),this.newSeasonActivities[e].endDate=new Date(this.activity.originalEvent.startDate));this.activity.endDate=this.newSeasonActivities[e].endDate,console.log("real",this.activity),this.activityModal=!1,this.$forceUpdate()},saveSeasonActivities:function(){var t=this;console.log("saving activities"),this.showRight=!1,this.$q.dialog({title:"Confirm Batch",message:"Do you want to save?",ok:"Yes",cancel:"No"}).then(function(){if(t.$store.state.users.isNewSeasonActivities)console.log("new seaon saving"),console.log("season",t.$store.state.users.newSeason),console.log("season activities",t.$store.state.users.newSeasonActivities),t.$store.dispatch("users/addNewSeason").then(function(){t.editMode=!1});else if(t.editMode)console.log("editMode saving"),t.confirmEditBatch();else{console.log("new batch saving");var e=o()({},t.newBatch),s=t.getSeasonBatches.length;++s,e.batchNumber=s,delete e.startDate;for(var i=0;i<e.activities.length;i++)e.activities[i].batch=s,e.activities[i].startDate=e.activities[i].startDate.toString(),e.activities[i].endDate=e.activities[i].endDate.toString(),e.activities[i].dueDate=e.activities[i].dueDate?e.activities[i].dueDate.toString():"",e.activities[i].updated=!1;e.batchStart=e.activities[0].startDate,console.log("batch to save",e),t.$store.dispatch("users/addNewBatch",e).then(function(){t.isNewBatch=!1,t.$bindAsArray("schedules2",t.$database.ref("event_schedules"));var e=t.$lodash.filter(t.schedules2,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===parseInt(t.seasonNumber)});t.getSeasonBatches[0].activities=e[0].activities}),t.$forceUpdate()}}).catch(function(){})},cancel:function(){var t=this;if(this.$store.state.users.isNewSeasonActivities)this.$router.push("/eventseason/".concat(this.eventKey));else if(this.editMode){this.editMode=!this.editMode,this.$bindAsArray("schedules2",this.$database.ref("event_schedules")),this.batches=this.$lodash.filter(this.schedules2,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===parseInt(t.seasonNumber)}),this.getSeasonBatches=this.batches,this.newBatch={},console.log("new batch refresh",this.newBatch),this.$bindAsArray("schedules2",this.$database.ref("event_schedules"));var e=this.$lodash.filter(this.schedules2,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===parseInt(t.seasonNumber)});this.getSeasonBatches[0].activities=e[0].activities,this.$store.state.users.showRight=!1,this.$store.state.startUp.schedules=this.schedules2,this.viewMode="batchMode"}else{this.$store.state.users.newSeasonActivities=[],this.$store.state.users.isNewSeasonActivities=!1,this.isNewBatch=!1,this.$bindAsArray("schedules2",this.$database.ref("event_schedules")),this.batches=this.$lodash.filter(this.schedules2,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===parseInt(t.seasonNumber)}),this.getSeasonBatches=this.batches,this.newBatch={},console.log("new batch refresh",this.newBatch),this.$bindAsArray("schedules2",this.$database.ref("event_schedules"));var s=this.$lodash.filter(this.schedules2,function(e){return e.eventKey===t.eventKey&&e.seasonNumber===parseInt(t.seasonNumber)});this.viewAllBatches=!1,this.$store.state.startUp.schedules=this.schedules2,this.getSeasonBatches[0].activities=s[0].activities,this.$store.state.users.showRight=!1}},clickDate:function(t){},clickEvent:function(t){console.log("e",t),this.activity=this.$store.getters["startUp/getPlainValue"](t),console.log("this.activity",this.activity),this.activityModal=!0},dropOnDate:function(t,e){if(this.editMode||this.isNewBatch){var s=this.$mathMixin.dayDiff(t.startDate,e),i=0;i=this.$store.state.users.isNewSeasonActivities?this.$mathMixin.dayDiff(new Date(this.newSeason.seasonStart),e):this.$mathMixin.dayDiff(new Date(this.getBatchNewOrientation.startDate),e),console.log("elength2",i),console.log("elength",s),console.log("e",t),i>=1&&"orientation"!==t.originalEvent.type&&t.originalEvent.type!==this.getBatchFinalEvent.type&&(t.originalEvent.startDate=this.$mathMixin.addDays(new Date(t.startDate),s),t.originalEvent.endDate=this.$mathMixin.addDays(new Date(t.endDate),s))}},setShowDate:function(t){this.showDate=t},confirmNewBatch:function(){console.log("this new bach",this.newBatch),this.batch=new Array,this.batch0=o()({},this.getSeasonBatches[0]);for(var t=this.$store.getters["startUp/getPlainValue"](this.getLastBatch),e=this.getSeasonBatches.length,s=0;s<t.activities.length;s++)t.activities[s].startDate=t.activities[s].startDate.toString(),t.activities[s].endDate=t.activities[s].endDate.toString();++e;var i=this.$lodash.findIndex(t.activities,function(t){return"orientation"===t.type});t.activities[i].startDate=new Date(this.newBatchStartDate),t.activities[i].endDate=new Date(this.newBatchStartDate),t.activities[i].startDate.setHours(0,0,0,0),t.activities[i].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_orientation"),t.activities[i].title="Batch(".concat(e,")_orientation");for(var a=this.$store.getters["users/convertToDays"]({dateType:this.getPaymentCourseActivity.dayAfter.dateType,dateNumber:this.getPaymentCourseActivity.dayAfter.dateNumber}),n=this.$lodash.filter(t.activities,function(t){return"payment"===t.type}),r=0;r<n.length;r++)0===r?(n[r].startDate=this.$mathMixin.addDays(new Date(this.newBatchStartDate),3),n[r].endDate=this.$mathMixin.addDays(new Date(this.newBatchStartDate),3),n[r].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_payment(").concat(r+1,")"),n[r].title="Batch(".concat(e,")_payment(").concat(r+1,")"),n[r].startDate.setHours(0,0,0,0),n[r].endDate.setHours(0,0,0,0)):(n[r].startDate=this.$mathMixin.addDays(new Date(n[r-1].startDate),a),n[r].endDate=this.$mathMixin.addDays(new Date(n[r-1].startDate),a),n[r].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_payment(").concat(r+1,")"),n[r].title="Batch(".concat(e,")_payment(").concat(r+1,")"),n[r].startDate.setHours(0,0,0,0),n[r].endDate.setHours(0,0,0,0));var h=this.$store.getters["users/convertToDays"]({dateType:this.getPhotoshootCourseActivity.dayAfter.dateType,dateNumber:this.getPhotoshootCourseActivity.dayAfter.dateNumber}),l=this.$lodash.findIndex(t.activities,function(t){return"photoshoot"===t.type});t.activities[l].startDate=this.$mathMixin.addDays(new Date(n[0].startDate),h),t.activities[l].endDate=this.$mathMixin.addDays(new Date(n[0].startDate),h),t.activities[l].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_photoshoot"),t.activities[l].title="Batch(".concat(e,")_photoshoot");this.$store.getters["users/convertToDays"]({dateType:this.getPhotolikingCourseActivity.dayAfter.dateType,dateNumber:this.getPhotolikingCourseActivity.dayAfter.dateNumber});var d=this.$lodash.findIndex(t.activities,function(t){return"photoliking"===t.type});t.activities[d].startDate=this.$mathMixin.addDays(new Date(n[1].startDate),h),t.activities[d].endDate=this.$mathMixin.addDays(new Date(n[1].startDate),14),t.activities[d].dueDate=this.$mathMixin.addDays(new Date(n[1].startDate),14),t.activities[d].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_photoliking"),t.activities[d].title="Batch(".concat(e,")_photoliking"),t.activities[d].startDate.setHours(0,0,0,0),t.activities[d].endDate.setHours(0,0,0,0);for(var v=0,u=0;u<t.activities.length;u++)"orientation"!==t.activities[u].type&&"payment"!==t.activities[u].type&&"photoshoot"!==t.activities[u].type&&"photoliking"!==t.activities[u].type&&(t.activities[u].startDate=new Date(t.activities[u].startDate),t.activities[u].endDate=new Date(t.activities[u].endDate),t.activities[u].time=t.activities[u].time?new Date(t.activities[u].time):"",t.activities[u].dueDate=t.activities[u].dueDate?new Date(t.activities[u].dueDate):"",t.activities[u].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_").concat(t.activities[u].type),t.activities[u].title="Batch(".concat(e,")_").concat(t.activities[u].type),"workshop"===t.activities[u].type&&(v++,console.log("found workshop",v),t.activities[u].startDate=new Date(t.activities[u].startDate),t.activities[u].endDate=new Date(t.activities[u].endDate),t.activities[u].time=new Date(t.activities[u].startDate),t.activities[u].id="".concat(this.$store.getters["startUp/getEvent"](this.eventKey).eventCode,"(").concat(this.seasonNumber,")_batch(").concat(e,")_").concat(t.activities[u].type,"(").concat(v,")"),t.activities[u].title="Batch(".concat(e,")_").concat(t.activities[u].type,"(").concat(v,")")));if(this.is4BatchMax){console.log("workshop is 4batchMax");for(var g=this.$lodash.filter(t.activities,function(t){return"workshop"===t.type}),y=0;y<g.length;y++){g[y].startDate=new Date(this.workshops.startDate[y]),g[y].endDate=new Date(this.workshops.startDate[y]),g[y].time=new Date(this.workshops.time[y]),g[y].location=this.workshops.location[y]?this.workshops.location[y]:"",g[y].details=this.workshops.details[y]?this.workshops.details[y]:"";var p=new Date(g[y].time).getHours(),f=new Date(g[y].time).getMinutes();g[y].startDate.setHours(p,f),g[y].endDate.setHours(p,f),delete g[y].dueDate}}console.log("batch",t),this.newBatch=o()({},t),this.$store.state.users.newSeasonActivities=c()(t.activities),this.setShowDate(new Date(this.newBatch.activities[0].startDate)),this.generateBatchNodes,this.isNewBatch=!0,this.newBatchModal=!1},confirmEditBatch:function(){console.log("confirmEditBatch",this.getSeasonBatches);for(var t=0;t<this.getSeasonBatches.length;t++){for(var e=this.getSeasonBatches[t][".key"],s=this.getSeasonBatches[t].activities,i=0;i<s.length;i++)s[i].startDate=s[i].startDate.toString(),s[i].endDate=s[i].endDate.toString(),s[i].dueDate=s[i].dueDate?s[i].dueDate.toString():"",s[i].time=s[i].time?s[i].time.toString():"";console.log("act",s),this.$database.ref("event_schedules/".concat(e,"/activities")).set(s).then(function(){console.log("success")}).catch(function(t){console.log("error",t)})}this.$bindAsArray("schedules2",this.$database.ref("event_schedules")),this.$store.state.startUp.schedules=this.schedules2,this.viewMode="batchMode",this.editMode=!1},isAbleToRemove:function(t){if(!(t.row.__index>=this.customBatches.length-1))return!1;var e=t.row.__index;if("standby"===this.getSeasonStatus){if("standby"===this.getSeasonStatus||0===e)return!0;e++;var s=this.$lodash.findIndex(this.getSeasonBatches,function(t){return t.batchNumber===e}),i=this.getSeasonBatches[s],a=(i[".key"],this.$mathMixin.dayDiff(new Date,new Date(t.row.orientation)));if(a>0)return!0}},removeBatch:function(t){var e=this;this.$q.dialog({title:"Confirm",message:"Are you sure you want to delete this batch?",ok:"Yes",cancel:"No"}).then(function(){console.log("props",t),console.log("getSeasonBatches",e.getSeasonBatches);var s=t.row.__index;if(s++,s<=1){var i=e.$lodash.findIndex(e.getSeasonBatches,function(t){return t.batchNumber===s});console.log("bIndex",e.getSeasonBatches[i]);var a=e.getSeasonBatches[i],n=a[".key"],o=e;e.$database.ref("event_schedules").child(n).remove().then(function(){e.eventKey,e.seasonNumber;e.$database.ref("events/".concat(e.eventKey,"/seasons/").concat(e.seasonNumber-1)).remove().then(function(){o.$q.notify({message:"".concat(a.eventName," Season ").concat(a.seasonNumber," has been removed"),type:"info",color:"info",textColor:"white",icon:"info"}),o.$router.push("/eventseason/".concat(e.eventKey))}).catch(function(t){console.log("an error occur",t)})})}else{i=e.$lodash.findIndex(e.getSeasonBatches,function(t){return t.batchNumber===s});console.log("bIndex",e.getSeasonBatches[i]);var r=e.getSeasonBatches[i];n=r[".key"];e.$database.ref("event_schedules").child(n).remove().then(function(){e.$q.notify({message:"".concat(r.eventName," Season ").concat(r.seasonNumber," has been removed"),type:"info",color:"info",textColor:"white",icon:"info"})})}}).catch(function(){})},checkIfCompleteDetails:function(){console.log("batches",this.getSeasonBatches);var t=this.getSeasonBatches[0].activities;console.log("b",t);for(var e=!1,s=0;s<t.length;s++)t[s].dueDate||t[s].amount||"orientation"===t[s].type||""!==t[s].location&&""!==t[s].details||(t[s],e=!0,s=t.length);e?this.$q.dialog({title:"Failed to Launch",message:"Please complete the details of Batch ".concat(this.getSeasonBatches[0].batchNumber)}):this.isCanAddAnotherBatch?(this.generateNewBatchDate(),this.newBatchModal=!this.newBatchModal):this.$q.dialog({title:"Add New Batch",message:"Batch Exceed to limit"}),console.log("is complete?",e)},getNumOfSignedModels:function(t){console.log("contractSigned",t);var e=t.__index;++e,console.log("b number",e);var s=this.$lodash.findIndex(this.getSeasonBatches,function(t){return t.batchNumber===e}),i=this.getSeasonBatches[s];console.log("batch",i),console.log("batchkey",i[".key"]);var a=this.$lodash.filter(this.seasonBatchContractSigned,function(t){return console.log("sbcs",t.batchKey),t.batchKey===i[".key"]});return console.log("signedbatchmodels",a.length),a.length},generateNewBatchDate:function(){for(var t=this.getLastBatch.activities[0],e=this.$store.getters["startUp/getUpcomingWeekEnds"]({startDate:new Date(t.startDate),weekEnd:"sundays"}),s=new Array,i=0;i<e.length;i++){var a=this.$mathMixin.dayDiff(new Date(t.startDate),new Date(e[i]));a>0&&s.push(e[i])}this.newBatchStartDate=s[0]},generateWorkshopScheds:function(){for(var t=this,e=this.$lodash.filter(this.getLastBatch.activities,function(t){return"payment"===t.type})[2],s=this.$lodash.filter(this.getLastBatch.activities,function(e){return e.type===t.getOtherActivities[0].label})[0],i=this.$store.getters["startUp/getUpcomingWeekEnds"]({startDate:new Date(e.startDate),weekEnd:"sundays"}),a=new Array,n=0;n<i.length;n++){var o=this.$mathMixin.dayDiff(new Date(e.startDate),new Date(i[n]));o>0&&a.push(i[n])}a.splice(0,this.getWorkshopActivity.length);var r=new Array;for(n=0;n<a.length;n++){var c=this.$mathMixin.dayDiff(new Date(s.startDate),new Date(a[n]));c<0&&r.push(a[n])}console.log("filterSun2",r),console.log("getWorkshopActivity",this.getWorkshopActivity);for(n=0;n<this.getWorkshopActivity.length;n++){this.workshops.startDate[n]=new Date(r[n]),this.workshops.endDate[n]=new Date(r[n]),this.workshops.location[n]=this.getWorkshopActivity[n].location,this.workshops.details[n]=this.getWorkshopActivity[n].details;var h=new Date(this.getWorkshopActivity[n].startDate).getHours(),l=new Date(this.getWorkshopActivity[n].startDate).getMinutes();this.workshops.startDate[n].setHours(h,l,0,0),this.workshops.endDate[n].setHours(h,l,0,0),this.workshops.time[n]=new Date(this.getWorkshopActivity[n].startDate)}console.log("workshops",this.workshops)},test:function(){console.log("")}}},g=u,y=s("KHd+"),p=Object(y["a"])(g,i,a,!1,null,null,null);e["default"]=p.exports}}]);