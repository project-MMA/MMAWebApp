(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{"F/b9":function(e,t,a){"use strict";var o=a("mToQ"),s=a.n(o);s.a},UadM:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-toolbar",{attrs:{color:"faded"}},[a("q-toolbar-title",[e._v("\n\t\t\t\tContract Signing\n\t\t\t\t")])],1),a("div",{staticClass:"q-pa-md"},[a("q-table",{attrs:{selection:"multiple",selected:e.selected,dense:e.dense,data:e.getShowUps,loading:e.tableLoading,columns:e.columns,filter:e.filter,pagination:e.pagination,"row-key":".key"},on:{"update:selected":function(t){e.selected=t},"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"top-left",fn:function(t){return[a("q-select",{staticClass:"noprint",attrs:{filter:"",color:"secondary",options:e.eventOpt,"hide-underline":""},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})]}},{key:"top-right",fn:function(t){return[a("q-search",{staticClass:"col-10 q-ma-sm noprint",staticStyle:{width:"180px"},attrs:{inverted:"",color:"dark",after:[{icon:"close",content:!0,handler:function(){e.filter=""}}]},model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}}),a("div",{staticClass:"noprint"},[a("q-btn",{staticClass:"noprint q-mr-md q-ma-sm float-right cardsButtonsDesktop",attrs:{label:"View Selected("+e.getSelectedRowCount+")",color:"primary"},on:{click:e.showModal}}),a("q-btn",{staticClass:"noprint q-mr-md q-ma-sm float-right cardsButtonsMobile",attrs:{label:"View Selected("+e.getSelectedRowCount+")",color:"primary",size:""},on:{click:e.showModal}})],1)]}},{key:"body-cell-batch",fn:function(t){return a("q-td",{attrs:{props:t}},[a("p",[e._v(e._s(e.getBatch(t.row)))])])}},{key:"body-cell-actions",fn:function(t){return a("q-td",{attrs:{props:t}},[a("q-btn",{staticClass:"noprint",attrs:{color:"secondary",icon:"edit",label:"Signed"},on:{click:function(a){e.viewInfo(t.row)}}})],1)}}])})],1),a("q-modal",{attrs:{"content-css":{minWidth:"50vw",minHeight:"95vh"}},on:{hide:e.clearModal},model:{value:e.signedModal,callback:function(t){e.signedModal=t},expression:"signedModal"}},[a("q-modal-layout",[a("q-toolbar",{attrs:{slot:"header",color:"faded"},slot:"header"},[a("q-toolbar-title",[e._v("\n\t\t\t\t\t\tConfirm Contract Sign\n\t\t\t\t\t")]),a("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:function(t){e.signedModal=!1}}})],1),a("div",{staticClass:"container cardsButtonsDesktop q-pa-sm"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-6-md col-6"},[a("div",{staticClass:"q-ma-md",style:"border-radius:15px; width: 300px;height:215px;background-position: center;background-image: url("+e.model.photo+");background-repeat: no-repeat;background-size: cover;border: 2px solid black;"}),a("div",{staticClass:"q-ma-md",style:"border-radius:15px; width: 300px;height:215px;background-position: center;background-image: url("+e.model.photo2+");background-repeat: no-repeat;background-size: cover;border: 2px solid black;"})]),a("div",{staticClass:"col-6-md col-6"},[a("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",type:"text","stack-label":"Account Number"},model:{value:e.model.accountNumber,callback:function(t){e.$set(e.model,"accountNumber",t)},expression:"model.accountNumber"}}),a("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",type:"text","stack-label":"Event"},model:{value:e.model.eventName,callback:function(t){e.$set(e.model,"eventName",t)},expression:"model.eventName"}}),a("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",type:"text","stack-label":"Last Name"},model:{value:e.model.lastName,callback:function(t){e.$set(e.model,"lastName",t)},expression:"model.lastName"}}),a("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",type:"text","stack-label":"First Name"},model:{value:e.model.firstName,callback:function(t){e.$set(e.model,"firstName",t)},expression:"model.firstName"}}),a("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",type:"text","stack-label":"Age"},model:{value:e.model.age,callback:function(t){e.$set(e.model,"age",t)},expression:"model.age"}}),a("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",type:"text","stack-label":"Gender"},model:{value:e.model.gender,callback:function(t){e.$set(e.model,"gender",t)},expression:"model.gender"}}),a("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",type:"text","stack-label":"Mobile Number"},model:{value:e.model.mobileNumber,callback:function(t){e.$set(e.model,"mobileNumber",t)},expression:"model.mobileNumber"}}),a("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",type:"text","stack-label":"FB Link"},model:{value:e.model.email,callback:function(t){e.$set(e.model,"email",t)},expression:"model.email"}})],1)])]),a("div",{staticClass:"container flex-center q-ma-sm cardsButtonsMobile"},[a("div",{staticClass:"col-6-md col-6"},[a("q-carousel",{staticClass:"full-width"},[a("q-carousel-slide",[a("div",{style:"border-radius:15px; width: 320px;height:225px;background-position: center;background-image: url("+e.model.photo+");background-repeat: no-repeat;background-size: cover;border: 2px solid black;"})]),a("q-carousel-slide",[a("div",{style:"border-radius:15px; width: 320px;height:225px;background-position: center;background-image: url("+e.model.photo2+");background-repeat: no-repeat;background-size: cover;border: 2px solid black;"})])],1)],1),a("div",{staticClass:"col-6-md col-6"},[a("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",type:"text","stack-label":"Account Number"},model:{value:e.model.accountNumber,callback:function(t){e.$set(e.model,"accountNumber",t)},expression:"model.accountNumber"}}),a("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",type:"text","stack-label":"Event"},model:{value:e.model.eventName,callback:function(t){e.$set(e.model,"eventName",t)},expression:"model.eventName"}}),a("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",type:"text","stack-label":"Last Name"},model:{value:e.model.lastName,callback:function(t){e.$set(e.model,"lastName",t)},expression:"model.lastName"}}),a("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",type:"text","stack-label":"First Name"},model:{value:e.model.firstName,callback:function(t){e.$set(e.model,"firstName",t)},expression:"model.firstName"}}),a("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",type:"text","stack-label":"Age"},model:{value:e.model.age,callback:function(t){e.$set(e.model,"age",t)},expression:"model.age"}}),a("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",type:"text","stack-label":"Gender"},model:{value:e.model.gender,callback:function(t){e.$set(e.model,"gender",t)},expression:"model.gender"}}),a("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",type:"text","stack-label":"Mobile Number"},model:{value:e.model.mobileNumber,callback:function(t){e.$set(e.model,"mobileNumber",t)},expression:"model.mobileNumber"}}),a("q-input",{staticClass:"q-ma-md",attrs:{readonly:"",type:"text","stack-label":"FB Link"},model:{value:e.model.email,callback:function(t){e.$set(e.model,"email",t)},expression:"model.email"}})],1)]),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("q-btn",{staticClass:"full-width",attrs:{color:"secondary"},on:{click:e.markAsSigned}},[e._v("Signed")])],1),a("q-inner-loading",{attrs:{visible:e.signedLoading}},[a("q-spinner-gears",{attrs:{size:"50px",color:"primary"}})],1)],1)],1),e.attendanceModal?a("q-modal",{attrs:{"content-css":{minWidth:"35vw",minHeight:"95vh"}},model:{value:e.attendanceModal,callback:function(t){e.attendanceModal=t},expression:"attendanceModal"}},[a("q-modal-layout",[a("q-toolbar",{staticClass:"bg-dark"},[a("q-toolbar-title",[e._v("\n              For Contract Signing\n            ")])],1),a("q-scroll-area",{staticStyle:{width:"100%",height:"85vh"}},e._l(this.selected,function(t){return a("q-list",{key:t[".key"],attrs:{link:"",dense:""}},[a("q-item",[a("q-item-side",{attrs:{icon:"label",color:"faded"}}),a("q-item-main",{staticClass:"capitalize q-body-1"},[e._v(e._s(t.firstName)+" "+e._s(t.middleInitial)+". "+e._s(t.lastName))]),a("q-item-side",[a("q-btn",{attrs:{icon:"close",outline:"",color:"red",push:"",rounded:"",size:"sm"},on:{click:function(a){e.UnSelect(t)}}})],1)],1)],1)})),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("q-btn",{staticClass:"full-width q-pa-sm",attrs:{color:"primary",icon:"border_color",size:"lg",label:"Contract Signed("+e.getSelectedRowCount+")"},on:{click:e.setContractSigned}})],1)],1)],1):e._e()],1)},s=[],n=(a("a1Th"),a("MVZn")),l=a.n(n),i=(a("INYr"),a("vDqi")),r=a.n(i),c=a("lwme"),d={mounted:function(){this.$bindAsArray("events",this.$database.ref("events")),this.$bindAsArray("models",this.$database.ref("showUpModels")),this.$bindAsArray("schedules",this.$database.ref("event_schedules")),this.$bindAsArray("contractsigned",this.$database.ref("contractSigned"))},created:function(){this.filter=this.$route.params.id},computed:{eventOpt:function(){var e=this.$lodash.map(this.events,function(e){return{label:e.eventName,value:e.eventName}});return e.push({label:"All",value:""}),e},filterModels:function(){var e=this;if("all"==this.selectEvent)return this.models;var t=this.$lodash.filter(this.models,function(t){return t.eventKey==e.selectEvent});return console.log("fil",t),t},getShowUps:function(){var e=this.$lodash.orderBy(this.models,"dateAdded","desc");return e},getSelectedRowCount:function(){return console.log("selectedL",this.selected.length),console.log("selectedL",this.selected),this.selected.length}},data:function(){return{attendanceModal:!1,events:[],models:[],model:{},schedules:[],selected:[],signedModal:!1,signedLoading:!1,filter:"",tableLoading:!1,dense:!0,selectEvent:"all",columns:[{name:"lastName",required:!0,label:"Last Name",align:"left",field:"lastName",sortable:!0},{name:"firstName",required:!0,label:"First Name",align:"left",field:"firstName",sortable:!0},{name:"eventName",required:!0,label:"Event Name",align:"left",field:"eventName",sortable:!0},{name:"season",required:!0,label:"Season",align:"left",field:"seasonName",sortable:!0},{name:"batch",required:!0,label:"Batch Number",align:"left",sortable:!0},{name:"actions",required:!0,label:"Actions",align:"center",field:"name",sortable:!1}],pagination:{sortBy:null,descending:!1,page:1,rowsPerPage:10}}},methods:{clearModal:function(){this.signedModal=!1,this.model={}},viewInfo:function(e){this.model=e;var t=this.UsernameGenerator(),a=c(5),o=this.UsernameChecker(t);this.model.accountNumber=o,this.model.password=a,this.signedModal=!0},markAsSigned:function(){var e=this;this.$q.dialog({title:"Save",message:"Do you want to confirm?",ok:"Yes",cancel:"No"}).then(function(){var t=e.$lodash.findIndex(e.schedules,function(t){return t[".key"]==e.model.batchKey}),a=l()({},e.schedules[t]),o=[];for(t=0;t<a.activities.length;t++)"payment"===a.activities[t].type&&(a.activities[t].paidStatus=!1,o.push(a.activities[t]));var s={photoshoot:0,runway:0,commercial:0};e.model.paymentDueDate=o,e.model.ratings=s,e.model.regFee=a.discount,e.markModelContract(e.model),e.posting(e.model.mobileNumber,e.model.accountNumber,e.model.password,e.model.firstName)}).catch(function(){})},getBatch:function(e){try{var t=this.$lodash.findIndex(this.schedules,function(t){return t[".key"]===e.batchKey});return this.schedules[t].batchNumber}catch(e){}},markModelContract:function(e){var t=this,a=e,o=a[".key"],s=this;delete a.__index,a.dateSigned=(new Date).toString(),delete a[".key"],console.log("model selected",a),this.$database.ref("contractSigned").child(o).set(a).then(function(){console.log("status updated"),s.$database.ref("showUpModels").child(o).remove().then(function(){t.$bindAsArray("models",t.$database.ref("showUpModels")),s.$forceUpdate()}).catch(function(){console.log("err on remove")})}).catch(function(e){console.log(e)})},setContractSigned:function(){var e=this;this.$q.dialog({title:"Save",message:"Do you want to confirm?",ok:"Yes",cancel:"No"}).then(function(){for(var t=function(){var t=e.selected[a],s=e.UsernameGenerator(),n=c(5),i=e.UsernameChecker(s);t.accountNumber=i,t.password=n,delete t.__index,o=e.$lodash.findIndex(e.schedules,function(e){return e[".key"]==t.batchKey});var r=l()({},e.schedules[o]),d=[];for(o=0;o<r.activities.length;o++)"payment"===r.activities[o].type&&(r.activities[o].paidStatus=!1,d.push(r.activities[o]));var m={photoshoot:0,runway:0,commercial:0};t.paymentDueDate=d,t.ratings=m,t.regFee=r.discount,e.markModelContract(t),e.posting(t.mobileNumber,t.accountNumber,t.password,t.firstName)},a=0;a<e.selected.length;a++){var o;t()}e.attendanceModal=!1,e.selected=[]}).catch(function(){})},posting:function(e,t,a,o){var s=this,n={mobile_number:"0"+e};console.log("sms",n);var l="Hi "+o+", Your account number is ".concat(t," with a temporary password of ").concat(a,".")+"Use these login details to access your model account. Thank you. -Maleficent Models Academy",i="mobile_number="+n.mobile_number+"&"+"message=".concat(l);console.log(i),r.a.post("https://maleficent-sms.000webhostapp.com/contractsign.php",i).then(function(e){console.log("response",e),s.signedModal=!1}).catch(function(e){console.log(e.response),s.signedModal=!1}),this.signedModal=!1},showModal:function(){this.attendanceModal=!0},UnSelect:function(e){var t=e,a=this.$lodash.filter(this.selected,function(e){if(e[".key"]!==t[".key"])return e});this.selected=a},UsernameGenerator:function(){var e=this.$moment().format("YYYY"),t=c(2),a="";a=this.$lodash.uniqueId().toString();var o="";if(a.length>4)o=a.slice(-4);else{var s="0000";o=s+a,o=o.slice(-4)}var n="M-"+e+o+"-"+t;return console.log("username",n),n},UsernameChecker:function(e){try{for(var t=e,a=0;a<this.contractsigned.length;a++){if(t===this.contractsigned[a].accountNumber){var o=this.UsernameGenerator();return o}return t}}catch(e){console.log(e)}},printPdf:function(){window.print()}}},m=d,u=(a("F/b9"),a("KHd+")),b=Object(u["a"])(m,o,s,!1,null,null,null);t["default"]=b.exports},lwme:function(e,t,a){"use strict";var o=function(e){0!==e&&(e=Math.abs(e)||10);var t=s();if(0===e)throw new Error("Lenght need to be an integer different than 0.");if(e>10){var a=~~(e/10);while(a--)t+=s()}return t.substr(0,e)},s=function(){return Math.random().toString(36).slice(2).toUpperCase()};e.exports=o},mToQ:function(e,t,a){}}]);