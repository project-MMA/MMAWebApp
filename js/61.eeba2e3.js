(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[61],{"1Z4v":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-toolbar",{attrs:{color:"faded"}},[a("q-toolbar-title",[e._v("\n        SMS List  \n      ")]),a("q-btn",{staticClass:"q-ml-sm q-ma-sm float-right",attrs:{icon:"edit",label:"Edit Schedule Details",color:"secondary"},on:{click:function(t){e.editScheduleDetails()}}}),a("q-btn",{staticClass:"q-ml-sm q-ma-sm float-right",attrs:{loading:e.loading,icon:"send",label:"Send Messages ("+e.getMessagesLength+")",color:"primary",disabled:e.disabled},on:{click:e.sendMessages}})],1),a("div",{staticClass:"container row flex"},[a("div",{staticClass:"col-4 q-px-lg"},[a("q-field",{staticClass:"q-ma-lg",attrs:{icon:"textsms",label:"Template","error-label":"We need a valid email",count:300,"label-width":"12"}},[a("q-input",{attrs:{type:"textarea","float-label":"SMS Template","max-height":1e3,rows:"10"},model:{value:e.area,callback:function(t){e.area=t},expression:"area"}})],1),a("q-btn",{staticClass:" full-width",attrs:{color:"secondary",rounded:"",size:"md",label:"Generate SMS"},on:{click:e.generateSMS}}),a("q-field",{staticClass:"q-ma-lg",attrs:{icon:"playlist_add",label:"Add Data to Template","label-width":"12"}},[a("q-btn",{staticClass:"q-ma-xs",attrs:{color:"dark",outline:"",rounded:"",size:"sm",label:"First Name"},on:{click:function(t){e.addToTemplate("fname")}}}),a("q-btn",{staticClass:"q-ma-xs",attrs:{color:"dark",outline:"",rounded:"",size:"sm",label:"Last Name"},on:{click:function(t){e.addToTemplate("lname")}}}),a("q-btn",{staticClass:"q-ma-xs",attrs:{color:"dark",outline:"",rounded:"",size:"sm",label:"Activity Date"},on:{click:function(t){e.addToTemplate("date")}}}),a("q-btn",{staticClass:"q-ma-xs",attrs:{color:"dark",outline:"",rounded:"",size:"sm",label:"Activity Time"},on:{click:function(t){e.addToTemplate("time")}}}),a("q-btn",{staticClass:"q-ma-xs",attrs:{color:"dark",outline:"",rounded:"",size:"sm",label:"Event Name"},on:{click:function(t){e.addToTemplate("event")}}}),a("q-btn",{staticClass:"q-ma-xs",attrs:{color:"dark",outline:"",rounded:"",size:"sm",label:"Activity Location"},on:{click:function(t){e.addToTemplate("location")}}}),a("q-btn",{staticClass:"q-ma-xs",attrs:{color:"dark",outline:"",rounded:"",size:"sm",label:"Activity Details"},on:{click:function(t){e.addToTemplate("details")}}})],1)],1),a("div",{staticClass:"col-8 q-mt-sm q-pa-md"},[a("q-field",{attrs:{icon:"email",label:"Select SMS Template","error-label":"We need a valid email","label-width":"6"}},[a("q-select",{staticClass:"text-white q-mb-md",staticStyle:{"min-width":"170px"},attrs:{inverted:"",color:"dark",options:e.mapTemplates,"stack-label":"SMS Templates",clearable:!0},on:{input:e.getTemplate,clear:e.clearArea},model:{value:e.selectedTemplate,callback:function(t){e.selectedTemplate=t},expression:"selectedTemplate"}})],1),a("q-progress",{staticClass:"q-mb-md",attrs:{percentage:e.progress,stripe:"",animate:"",height:"45px"}}),a("q-table",{attrs:{data:e.messageList,loading:e.tableLoading,columns:e.Modelcolumns,pagination:e.Modelpagination,separator:"cell",selected:e.selected,"no-data-label":"No Models","row-key":".key",filter:e.filter},on:{"update:pagination":function(t){e.Modelpagination=t},"update:selected":function(t){e.selected=t}},scopedSlots:e._u([{key:"body-cell-mobilenumber",fn:function(t){return a("q-td",{attrs:{props:t}},[e._v("\n          "+e._s(t.row.mobileNumber))])}}])})],1)]),e.attendanceModal?a("q-modal",{attrs:{"content-css":{minWidth:"35vw",minHeight:"95vh"}},model:{value:e.attendanceModal,callback:function(t){e.attendanceModal=t},expression:"attendanceModal"}},[a("q-modal-layout",[a("q-toolbar",{staticClass:"bg-dark full-width"},[a("q-toolbar-title",[e._v("\n              "+e._s(e.activityTitle)+"\n            ")])],1),a("q-search",{staticClass:"text-white",attrs:{icon:"search",inverted:"",color:"faded",clearable:"",placeholder:"Search name"},model:{value:e.selectSearch,callback:function(t){e.selectSearch=t},expression:"selectSearch"}}),a("q-scroll-area",{staticStyle:{width:"100%",height:"85vh"}},[e._l(e.filteredSelect,function(t){return a("q-list",{key:t[".key"],attrs:{link:"",dense:""}},[a("q-item",[a("q-item-side",{attrs:{icon:"label",color:"faded"}}),a("q-item-main",{staticClass:"capitalize q-body-1"},[e._v(e._s(t.firstName)+" "+e._s(t.middleInitial)+". "+e._s(t.lastName))]),a("q-item-side",[a("q-btn",{attrs:{icon:"close",outline:"",color:"red",push:"",rounded:"",size:"sm"},on:{click:function(a){e.UnSelect(t)}}})],1)],1)],1)}),0===e.getSelectedRowCount?a("div",{staticClass:"text-center text-faded q-display-1 fixed-center"},[e._v("No Models Listed")]):e._e()],2),a("div",{attrs:{slot:"footer"},slot:"footer"},[e.ifOrientation?a("q-btn",{staticClass:"q-pa-sm full-width",attrs:{color:"primary",icon:"check",size:"lg",label:"Confirm Attendance("+e.getSelectedRowCount+")"},on:{click:e.setSelectedPresent}}):e._e(),e.ifNotOrientation?a("q-btn",{staticClass:"q-pa-sm full-width",attrs:{color:"primary",icon:"check_box",size:"lg",label:"Confirm Attendance("+e.getSelectedRowCount+")"},on:{click:e.setActivityAttendance}}):e._e()],1)],1)],1):e._e(),e.showUpsModal?a("q-modal",{attrs:{"content-css":{minWidth:"35vw",minHeight:"95vh"}},model:{value:e.showUpsModal,callback:function(t){e.showUpsModal=t},expression:"showUpsModal"}},[a("q-modal-layout",[a("q-toolbar",{staticClass:"bg-dark full-width"},[a("q-toolbar-title",[e._v("\n              "+e._s(e.activityTitle)+"\n            ")])],1),a("q-search",{staticClass:"text-white",attrs:{icon:"search",inverted:"",color:"faded",clearable:"",placeholder:"Search name"},model:{value:e.showUpSearch,callback:function(t){e.showUpSearch=t},expression:"showUpSearch"}}),a("q-scroll-area",{staticStyle:{width:"100%",height:"85vh"}},[e._l(e.filteredShowUp,function(t){return a("q-list",{key:t[".key"],attrs:{link:"",dense:""}},[a("q-item",[a("q-item-side",{attrs:{icon:"label",color:"faded"}}),a("q-item-main",{staticClass:"capitalize q-body-1"},[e._v(e._s(t.firstName)+" "+e._s(t.middleInitial)+". "+e._s(t.lastName))]),a("q-item-side",[a("q-btn",{attrs:{icon:"close",outline:"",color:"red",push:"",rounded:"",size:"sm"},on:{click:function(a){e.Back2Models(t)}}})],1)],1)],1)}),0===e.getShowupCount?a("div",{staticClass:"text-center text-faded q-display-1 fixed-center"},[e._v("No Models Listed")]):e._e()],2)],1)],1):e._e(),e.confirmedAttendanceModal?a("q-modal",{attrs:{"content-css":{minWidth:"35vw",minHeight:"95vh"}},model:{value:e.confirmedAttendanceModal,callback:function(t){e.confirmedAttendanceModal=t},expression:"confirmedAttendanceModal"}},[a("q-modal-layout",[a("q-toolbar",{staticClass:"bg-dark full-width"},[a("q-toolbar-title",[e._v("\n              "+e._s(e.activityTitle)+"\n            ")])],1),a("q-search",{staticClass:"text-white",attrs:{icon:"search",inverted:"",color:"faded",clearable:"",placeholder:"Search name"},model:{value:e.nameSearch,callback:function(t){e.nameSearch=t},expression:"nameSearch"}}),a("q-scroll-area",{staticStyle:{width:"100%",height:"85vh"}},e._l(e.filteredConfirm,function(t){return a("q-list",{key:t[".key"],attrs:{link:"",dense:""}},[a("q-item",[a("q-item-side",{attrs:{icon:"check_box",color:"faded"}}),a("q-item-main",{staticClass:"capitalize q-body-1"},[e._v(e._s(t.firstName)+" "+e._s(t.middleInitial)+". "+e._s(t.lastName))]),a("q-item-side",[a("q-btn",{attrs:{icon:"close",outline:"",color:"red",push:"",rounded:"",size:"sm"},on:{click:function(a){e.getConfirmationBack(t)}}})],1)],1)],1)}))],1)],1):e._e(),a("q-modal",{attrs:{"content-css":{minWidth:"50vw",minHeight:"50vh"}},model:{value:e.editDetailsModal,callback:function(t){e.editDetailsModal=t},expression:"editDetailsModal"}},[a("q-modal-layout",[a("q-toolbar",{attrs:{slot:"header"},slot:"header"},[a("q-btn",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],attrs:{flat:"",round:"",dense:"",icon:"keyboard_arrow_left"}}),a("q-toolbar-title",[e._v("\n            Edit Details\n          ")])],1),a("div",{staticClass:"row",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"col"},[a("q-btn",{staticClass:"full-width",attrs:{label:"save",color:"positive"},on:{click:e.saveEditDetails}})],1),a("div",{staticClass:"col"},[a("q-btn",{directives:[{name:"close-overlay",rawName:"v-close-overlay"}],staticClass:"full-width",attrs:{label:"cancel",color:"negative"}})],1)]),a("div",{staticClass:"q-pa-md"},[a("q-input",{attrs:{type:"textarea","float-label":"Location","max-height":100,rows:"7"},model:{value:e.editSchedLocation,callback:function(t){e.editSchedLocation=t},expression:"editSchedLocation"}}),a("q-input",{attrs:{type:"textarea","float-label":"Details","max-height":100,rows:"7"},model:{value:e.editSchedDetails,callback:function(t){e.editSchedDetails=t},expression:"editSchedDetails"}})],1)],1)],1)],1)},s=[],o=a("BTVW"),n=o["a"],l=(a("RSWO"),a("KHd+")),r=Object(l["a"])(n,i,s,!1,null,null,null);t["default"]=r.exports},BTVW:function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("rGqo"),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_0__),_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("MVZn"),_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es6_array_find_index__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("INYr"),core_js_modules_es6_array_find_index__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es6_array_find_index__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es6_array_find__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("dRSK"),core_js_modules_es6_array_find__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es6_array_find__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("a1Th"),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_4__),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("SRfc"),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_5__),core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("Oyvg"),core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_6__),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("f3/d"),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_7__),_router__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("oYx3"),axios__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("vDqi"),axios__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_9__);__webpack_exports__["a"]={name:"SMSList",components:{},created:function(){this.batchKey=this.$route.params.id,this.activityTitle=this.$route.params.title,this.activityType=this.$route.params.type},mounted:function(){this.$bindAsArray("event_schedules",this.$database.ref("event_schedules")),this.$bindAsArray("model_list",this.$database.ref("models")),this.$bindAsArray("showUpList",this.$database.ref("showUpModels")),this.$bindAsArray("contractsigned",this.$database.ref("contractSigned")),this.$bindAsArray("attendanceList",this.$database.ref("attendance/"+this.$route.params.id+"/"+this.$route.params.title+"/models")),this.$bindAsArray("confirmedList",this.$database.ref("attendance/"+this.$route.params.id+"/"+this.$route.params.title+"/present")),this.$bindAsArray("SMStemplates",this.$database.ref("SMStemplates")),this.$bindAsArray("payment_transactions",this.$database.ref("payment_transactions")),this.$bindAsArray("attendance",this.$database.ref("attendance"))},computed:{mapTemplates:function(){try{var e=[];return e=this.$lodash.map(this.SMStemplates,function(e){return{label:e.name,value:e[".key"]}}),e}catch(e){return console.log(e),[]}},filteredShowUp:function(){var e=this;return this.getShowUps.filter(function(t){var a=new RegExp(e.showUpSearch,"i"),i=t.firstName+" "+t.lastName;return i.match(a)})},filteredSelect:function(){var e=this;return this.selected.filter(function(t){var a=new RegExp(e.selectSearch,"i"),i=t.firstName+" "+t.lastName;return i.match(a)})},filteredConfirm:function(){var e=this;return this.confirmedList.filter(function(t){var a=new RegExp(e.nameSearch,"i"),i=t.firstName+" "+t.lastName;return i.match(a)})},getActivities:function(){return console.log("activities",this.$store.getters["schedules/getSeeAllSchedules"]),this.$store.getters["schedules/getSeeAllSchedules"]},getActivityForSms:function(){try{var e=this.$route.params.id,t=this.$route.params.title,a=(this.$route.params.type,this.returnBatchActivity(e)),i=this.$lodash.filter(a,function(e){return e.id===t});return console.log(i),i[0]}catch(e){return console.log(e),[]}},getModels:function(){var e=this;try{if("orientation"!==this.$route.params.type&&"payment"!==this.$route.params.type){console.log("activity models",this.attendanceList);var t=this.$lodash.filter(this.attendanceList,function(t){return t.activityDate=e.getActivityForSms.startDate,t.activityType=e.getActivityForSms.type,t.activityDetails=e.getActivityForSms.details,t.activityLocation=e.getActivityForSms.location,t});return console.log("modellist not orientation not payment",t),t}if("payment"===this.$route.params.type){console.log("payment");var a=this.$lodash.filter(this.contractsigned,function(t){t.activityDate=e.getActivityForSms.startDate,t.activityType=e.getActivityForSms.type,t.activityAmount=e.getActivityForSms.amount,t.payNum=e.getActivityForSms.id.toString().slice(-10),t.d1=e.getDuePayments(t[".key"])[0].amount,t.d2=e.getDuePayments(t[".key"])[1].amount,t.d3=e.getDuePayments(t[".key"])[2].amount,t.totalPaid=e.getModelsPaymentTransactions(t[".key"]);var a=e.getActivityForSms.id.toString().slice(-10),i=e.getModelsPaymentTransactions(t[".key"]),s=e.getDuePayments(t[".key"])[0].amount,o=e.getDuePayments(t[".key"])[1].amount,n=e.getDuePayments(t[".key"])[2].amount;if(0===t.balance);else if("payment(1)"===a){if(i<s)return t.batchKey===e.$route.params.id}else if("payment(2)"===a){if(i<s+o){return t.batchKey===e.$route.params.id}}else if("payment(3)"===a&&i<s+o+n){var l=s+o+n;return console.log("needed to pay",i+" / "+l),t.batchKey===e.$route.params.id}});return console.log("modellist payment",a),a}var i=this.$lodash.filter(this.model_list,function(t){return t.activityDate=e.getActivityForSms.startDate,t.activityType=e.getActivityForSms.type,t.activityDetails=e.getActivityForSms.details,t.activityLocation=e.getActivityForSms.location,t.batchKey===e.$route.params.id});return console.log("modellist orientation",i),i}catch(e){return[]}},getShowUps:function(){var e=this,t=this.$lodash.filter(this.showUpList,function(t){return t.batchKey===e.batchKey});return t},getMessagesLength:function(){return 0!==this.messageList.length&&(this.disabled=!1),this.messageList.length},getShowupCount:function(){var e=this,t=this.$lodash.filter(this.showUpList,function(t){return t.batchKey===e.batchKey});return console.log("length",t.length),t.length},getSeasonName:function(){var e=this;try{console.log("eventS",this.event_schedules);var t=this.$lodash.filter(this.event_schedules,function(t){if(t[".key"]===e.batchKey)return t});return console.log("seasonGet",t[0].seasonName),t[0].seasonName}catch(e){return""}},ifNotOrientation:function(){return"orientation"!==this.$route.params.type},ifOrientation:function(){return"orientation"===this.$route.params.type}},data:function(){return{editSchedLocation:"",editSchedDetails:"",editDetailsModal:!1,disabled:!0,payment_transactions:[],selectedTemplate:"",SMStemplates:[],area:"",loading:!1,messageList:[],attendanceList:[],attendanceModal:!1,showUpsModal:!1,confirmedAttendanceModal:!1,filter:"",selected:[],activityType:"",activityTitle:"",batchKey:"",nameSearch:"",selectSearch:"",showUpSearch:"",contractsigned:[],event_schedules:[],model_list:[],showUpList:[],progress:0,sent:0,unsent:0,tableLoading:!1,Modelcolumns:[{name:"mobilenumber",required:!0,label:"Mobile Number",align:"left",field:"mobileNumber",sortable:!0},{name:"msgs",required:!0,label:"SMS Message",align:"left",field:"msgs",sortable:!0}],pagination:{sortBy:null,descending:!1,page:1,rowsPerPage:10},Modelpagination:{sortBy:null,descending:!1,page:1,rowsPerPage:5}}},methods:{clearEditDetails:function(){},saveEditDetails:function(){var e=this,t=this;this.$q.dialog({title:"Confirm Save",message:"Do you want to Save ?",ok:"OK",cancel:"Cancel"}).then(function(){var a=e.$lodash.find(e.event_schedules,function(t){return t[".key"]===e.batchKey}),i=e.$lodash.findIndex(a.activities,function(t){return t.type===e.activityType}),s=e.$lodash.find(a.activities,function(t){return t.type===e.activityType});s.location=e.editSchedLocation,s.details=e.editSchedDetails,console.log("event_schedules/".concat(e.batchKey,"/activities/").concat(i)),console.log("act",s),e.$database.ref("event_schedules/".concat(e.batchKey,"/activities/").concat(i)).update(s).then(function(){t.$q.notify({message:"Successfully Saved",type:"positive",color:"positive",textColor:"white",icon:"info"}),t.editDetailsModal=!1,console.log("updated")}).catch(function(e){t.$q.notify({message:"Opps.. Error",type:"negative",color:"negative",textColor:"white",icon:"info"}),console.log("err",e)})}).catch(function(){})},getLocationDetails:function(){var e=this,t=this.$lodash.find(this.event_schedules,function(t){return t[".key"]===e.batchKey}),a=this.$lodash.find(t.activities,function(t){return t.type===e.activityType});this.editSchedLocation=a.location,this.editSchedDetails=a.details},editScheduleDetails:function(){this.getLocationDetails(),this.editDetailsModal=!0},showSeason:function(e){console.log("show season",e)},test:function(){},showModal:function(){this.attendanceModal=!0},showShowUpModal:function(){this.showUpsModal=!0},showConfirmed:function(){this.confirmedAttendanceModal=!0},isPresent:function(e){var t=this,a=this.$lodash.findIndex(e.activitiesAttended,function(e){return e.type===t.activityType});if(-1!=a)return e.activitiesAttended[a].status},present:function(e){var t=this;console.log("m",e);var a=_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_1___default()({},e),i=a[".key"],s=this.$lodash.findIndex(a.activitiesAttended,function(e){return e.type===t.activityType});-1!=s&&(e.activitiesAttended[s].status=!0,delete a[".key"],console.log("model",a),this.$database.ref("showUpModels").child(i).set(a).then(function(){console.log("status updated")}).catch(function(e){console.log(e)})),this.$forceUpdate()},notSet:function(e){var t=this;console.log("not set",e);var a=e[".key"],i=this.$lodash.findIndex(e.activitiesAttended,function(e){return e.type===t.activityType});-1!=i&&(e.activitiesAttended[i].status=!1,this.$database.ref("showUpModels").child(a).remove().then(function(){console.log("model remove in showup")}).catch(function(e){console.log("err",e)}))},setSelectedPresent:function(){var e=this;this.$q.dialog({title:"Confirm Model/s Attendance?",message:"",ok:"Yes",cancel:"No"}).then(function(){for(var t=function(){var t=e.selected[a],s=t[".key"],o=e;e.selected[a].dateAdded=(new Date).toString(),i=e.$lodash.findIndex(t.activitiesAttended,function(t){return t.type===e.activityType}),-1!=i&&(t.activitiesAttended[i].status=!0,delete t[".key"],console.log("model selected",t),e.$database.ref("showUpModels").child(s).set(t).then(function(){console.log("status updated"),o.$database.ref("models").child(s).remove().then(function(){e.selected=[],o.$bindAsArray("model_list",o.$database.ref("models")),o.$forceUpdate(),e.attendanceModal=!1}).catch(function(){console.log("err on remove")})}).catch(function(e){console.log(e)}))},a=0;a<e.selected.length;a++){var i;t()}e.$q.notify({message:"Model/s Attendance Confirm",type:"positive",color:"positive",textColor:"white",icon:"info"})}).catch(function(){})},UnSelect:function(e){var t=e,a=this.$lodash.filter(this.selected,function(e){if(e[".key"]!==t[".key"])return e});this.selected=a},Back2Models:function(e){var t=this;console.log("not set",e);var a=e[".key"],i=e,s=this.$lodash.findIndex(e.activitiesAttended,function(e){return e.type===t.activityType});-1!=s&&(e.activitiesAttended[s].status=!1,delete i[".key"],this.$database.ref("models").child(a).set(i).then(function(){t.$database.ref("showUpModels").child(a).remove().then(function(){console.log("model remove in showup"),t.$bindAsArray("showUpList",t.$database.ref("showUpModels")),t.$forceUpdate()}).catch(function(e){console.log("err",e)})}))},setActivityAttendance:function(){var e=this;this.$q.dialog({title:"Confirm Model/s Attendance?",message:"",ok:"Yes",cancel:"No"}).then(function(){for(var t=function(){var t=_babel_runtime_helpers_objectSpread__WEBPACK_IMPORTED_MODULE_1___default()({},e.selected[a]);t.activityID=e.activityTitle;var s=t[".key"],o=e;i=e.$lodash.findIndex(t.activitiesAttended,function(t){return t.id===e.activityTitle}),console.log("index_activity",i),-1!=i&&(t.activitiesAttended[i].status=!0,delete t[".key"],console.log("model selected",t),e.$database.ref("attendance/"+e.$route.params.id+"/"+e.$route.params.title+"/present").child(s).set(t).then(function(){console.log("status updated"),o.$database.ref("attendance/"+e.$route.params.id+"/"+e.$route.params.title+"/models").child(s).remove().then(function(){e.selected=[],o.$bindAsArray("attendanceList",o.$database.ref("attendance/"+e.$route.params.id+"/"+e.$route.params.title+"/models")),o.$forceUpdate(),e.attendanceModal=!1}).catch(function(){console.log("err on remove")})}).catch(function(e){console.log(e)}))},a=0;a<e.selected.length;a++){var i;t()}e.$q.notify({message:"Model/s Attendance Confirm",type:"positive",color:"positive",textColor:"white",icon:"info"})}).catch(function(){})},getConfirmationBack:function(e){var t=this;console.log("not set",e);var a=e[".key"],i=e,s=this,o=this.$lodash.findIndex(e.activitiesAttended,function(e){return e.type===t.activityType});-1!=o&&(i.activitiesAttended[o].status=!1,delete i[".key"],console.log("model selected",i),this.$database.ref("contractSigned/"+a+"/activitiesAttended/"+o+"/status").set(!1).then(function(){t.$database.ref("attendance/"+t.$route.params.id+"/"+t.$route.params.title+"/models").child(a).set(i).then(function(){console.log("status updated"),s.$database.ref("attendance/"+t.$route.params.id+"/"+t.$route.params.title+"/present").child(a).remove().then(function(){t.selected=[],s.$bindAsArray("confirmedList",s.$database.ref("attendance/"+t.$route.params.id+"/"+t.$route.params.title+"/present")),s.$forceUpdate(),t.confirmedAttendanceModal=!1}).catch(function(){console.log("err on remove")})})}).catch(function(e){console.log(e)}))},addToTemplate:function(e){var t=e,a=this.area;a=a+"${"+t+"}",this.area=a},generateSMS:function generateSMS(){if(""===this.area)this.$q.notify({message:"SMS Template is blank.",position:"center",type:"negative",color:"negative",textColor:"white",icon:"warning"});else{this.sent=0,this.unsent=0,this.messageList=[];for(var models=this.getModels,i=0;i<models.length;i++){var SMS={mobile_number:"0"+models[i].mobileNumber},fname=this.$lodash.capitalize(models[i].firstName),lname=this.$lodash.capitalize(models[i].lastName),location=models[i].activityLocation,activityType=this.$lodash.capitalize(this.activityType),newActivityLocation=models[i].activityLocation,newActivityDate=this.$moment(models[i].activityDate).format("ll"),event=models[i].eventName,date=this.$moment(models[i].activityDate).format("ll"),time=this.$moment(models[i].activityDate).format("LT"),details=models[i].activityDetails,template=eval("`"+this.area+"`"),data="mobile_number="+SMS.mobile_number+"&message="+template;console.log(data);var messageTo={mobileNumber:models[i].mobileNumber,msgs:template};this.messageList.push(messageTo)}console.log(this.messageList)}},getModelsPaymentTransactions:function(e){try{console.log("key",e);for(var t=this.$lodash.filter(this.payment_transactions,function(t){return t.modelKey===e}),a=t,i=0,s=0;s<a.length;s++)i+=parseInt(a[s].transaction_amount);return i}catch(e){return console.log("error",e),[]}},getDuePayments:function(e){try{for(var t=this.$lodash.filter(this.contractsigned,function(t){return t[".key"]===e}),a=[],i=t[0].paymentDueDate,s=0;s<i.length;s++)a.push(i[s]);return a}catch(e){return[]}},posting:function(e,t){var a=this,i={mobile_number:"0"+e},s=this.getModels.length;console.log("sms",i);var o=t,n="mobile_number="+i.mobile_number+"&"+"message=".concat(o);console.log(n),axios__WEBPACK_IMPORTED_MODULE_9___default.a.post("https://maleficent-sms.000webhostapp.com/contractsign.php",n).then(function(e){console.log("response",e);var t=e.data.toString();"Error"===t.slice(0,5)?(console.log("Error Po",e),a.unsent=a.unsent+1,a.$q.notify({message:a.unsent+"/"+s+"Not Messages Sent",position:"bottom-right",type:"negative",color:"negative",textColor:"white",icon:"warning"})):(console.log("Success"),a.sent=a.sent+1,a.progress=a.sent/s*100,a.$q.notify({message:a.sent+"/"+s+" Messages Sent",position:"bottom-right",type:"info",color:"info",textColor:"white",icon:"info"}))}).catch(function(e){console.log(e.response)})},sendMessages:function(){var e=this;try{this.loading=!0;this.getModels.length;for(var t=this.messageList,a=function(){var a=t[i].msgs,s=t[i].mobileNumber;setTimeout(function(){e.posting(s,a)},1e3)},i=0;i<t.length;i++)a();setTimeout(function(){e.loading=!1,e.disabled=!0,e.area=""},3e3),this.sent=0,this.messageList=[]}catch(e){console.log(e)}},getTemplate:function(){try{var e=this.selectedTemplate,t=this.$lodash.filter(this.SMStemplates,function(t){return t[".key"]===e});this.area=t[0].template,console.log("templates",t)}catch(e){return[]}},clearArea:function(){this.area=""},returnBatchActivity:function(e){var t=[];this.$lodash.forEach(this.event_schedules,function(a){a[".key"]===e&&t.push(a)});var a=[];return this.$lodash.forEach(t,function(e){a.push(e.activities)}),console.log("found",t),console.log("activities",a),a[0]}}}},RSWO:function(e,t,a){"use strict";var i=a("oyYp"),s=a.n(i);s.a},oyYp:function(e,t,a){}}]);