(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{M9Gd:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flex flex-center textLogin",staticStyle:{"background-image":"url('./assets/skyscraper-login.jpg')",height:"100vh"}},[s("div",{staticStyle:{width:"420px","max-width":"95vw"}},[s("div",{staticClass:"flex flex-center container row text-center q-pa-lg q-pa-xs",staticStyle:{"background-color":"rgba(255, 255, 255, 0.8)","border-radius":"50px","max-height":"700px",height:"auto"}},[s("div",{staticClass:"col-12"}),s("div",{staticClass:"col-12 flex flex-center"},[s("q-card",{staticClass:"q-ma-xs bg-white flex",staticStyle:{"max-height":"700px",height:"auto",width:"95vw","border-radius":"20px"},attrs:{inline:""}},[s("q-card-media",{staticClass:"relative"},[s("q-parallax",{attrs:{src:"./statics/unsplash.jpg",height:230}},[s("div",{attrs:{slot:"loading"},slot:"loading"},[t._v("Loading...")]),s("div",{staticClass:"image bg-white bgSignin",staticStyle:{width:"140px",height:"140px","border-radius":"10px"}},[s("img",{staticClass:"logoMemp",staticStyle:{width:"130px",height:"130px",margin:"5px"},attrs:{src:"/statics/MMALogo.jpg"}})])])],1),s("q-card-title",[s("b",{staticClass:"text-dark"},[t._v("Great "+t._s(t.getDayOfWeek)+"! "),t.getUsersName?s("span",[t._v("Hi, "),s("span",{staticClass:"text-info"},[t._v(" "+t._s(t.getUsersName.firstName)+" ")]),s("q-icon",{attrs:{name:"mood"}})],1):t._e()])]),s("q-card-separator"),s("q-card-actions",[s("div",{staticClass:"container flex flex-center"},[s("div",{staticClass:"col-12 full-width q-pa-sm text-left"},[s("q-input",{attrs:{inverted:"",type:"email","float-label":"Username",color:"dark",before:[{icon:"account_box",handler:function(){}}]},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.login(e):null}},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1),s("div",{staticClass:"col-12 full-width q-pa-sm text-left"},[s("q-input",{attrs:{value:"",inverted:"",type:"password",clearable:"","float-label":"Password",color:"dark",before:[{icon:"vpn_key",handler:function(){}}]},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.login(e):null}},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1),s("div",{staticClass:"col-12 full-width q-pa-sm"},[s("q-btn",{attrs:{color:"dark",size:"lg",label:"SIGN IN",rounded:"",outline:"","icon-right":"send"},on:{click:t.login}})],1)])])],1),s("q-inner-loading",{attrs:{visible:t.spinner}},[s("q-spinner-tail",{attrs:{size:"50px",color:"primary"}})],1)],1)])])])},i=[],r=(s("rGqo"),s("+diE"),{name:"login",created:function(){this.$q.localStorage.has("user")?this.$router.push("/dashboard"):this.$router.push("/")},computed:{getDayOfWeek:function(){var t=new Date;return this.$moment(t).format("dddd")},getUsersName:function(){var t=this;try{if(""===this.email)return 0;var e=this.$lodash.filter(this.users2,function(e){return e.email===t.email});return e[0]}catch(t){return console.log(t),0}}},mounted:function(){var t=this;this.$bindAsArray("users2",this.$database.ref("users")),this.$bindAsArray("schedules",this.$database.ref("event_schedules")),setTimeout(function(){t.notifyUsers()},3e3)},data:function(){return{schedules:[],users2:[],email:"",password:"",spinner:!1,user:[]}},methods:{notifyUsers:function(){var t=this,e=new Array,s=this.schedules;this.$lodash.forEach(s,function(s){t.$lodash.forEach(s.activities,function(t){e.push(t)})});for(var a=this.$lodash.orderBy(e,function(t){return new Date(t.startDate)},"asc"),i=new Array,r=0;r<a.length;r++){var n=this.$mathMixin.dayDiff(new Date,new Date(a[r].startDate));n>=0&&"payment"!==a[r].type&&(i.push(a[r]),5===i.length&&(r=a.length))}this.$lodash.forEach(i,function(t){t.seen=!1}),this.$lodash.forEach(this.users2,function(e){var s=e[".key"];t.$database.ref("users/".concat(s,"/notification")).child("upcomingActivities").set(i).then(function(){console.log("done")}).catch(function(t){console.log("err",t)})})},login:function(){var t=this;this.spinner=!0;var e=this,s=this.email;this.$auth.signInWithEmailAndPassword(s,this.password).then(function(s){console.log("click"),setTimeout(function(){console.log("processing");var a=s.user.uid;e.$bindAsArray("user",t.$database.ref("users").orderByKey().equalTo(a)),console.log("user",t.user),e.$store.state.user=t.user,e.$q.localStorage.set("user",a),e.spinner=!1,console.log("userlogin",t.user),"undefined"!==typeof t.user[0]&&!0===t.user[0].activated?e.$router.push("/dashboard"):(t.logout(),t.$q.notify("Incorrect Email and Password"),e.$router.push("/"))},5e3)}).catch(function(e){t.$q.dialog({title:"Error",message:"Error Occured"}),t.spinner=!1})},logout:function(){var t=this;this.$auth.signOut().then(function(){console.log("Logout Successfull"),t.$store.state.userType="",t.$router.push("/"),t.$q.localStorage.remove("user")})}}}),n=r,o=(s("fggj"),s("KHd+")),l=Object(o["a"])(n,a,i,!1,null,null,null);e["default"]=l.exports},fggj:function(t,e,s){"use strict";var a=s("sIUm"),i=s.n(a);i.a},sIUm:function(t,e,s){}}]);