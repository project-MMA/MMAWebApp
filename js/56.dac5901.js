(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[56],{GQTy:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("q-toolbar",{attrs:{color:"faded"}},[t("q-toolbar-title",[e._v("\n\t\t\t\tUsers\n\t\t\t\t")])],1),t("div",{staticClass:"layout-padding"},[t("q-table",{attrs:{grid:"",data:e.getUsers,loading:e.tableLoading,columns:e.columns,filter:e.filter,pagination:e.pagination,"row-key":"code"},on:{"update:pagination":function(s){e.pagination=s}},scopedSlots:e._u([{key:"top-right",fn:function(s){return[t("q-search",{staticClass:"col-10",attrs:{color:"secondary"},model:{value:e.filter,callback:function(s){e.filter=s},expression:"filter"}})]}},{key:"body-cell-userAccess",fn:function(s){return t("q-td",{attrs:{props:s}},e._l(s.row.userAccess,function(s,a){return t("ul",{key:a},[s?t("li",[e._v(e._s(a))]):e._e()])}))}},{key:"body-cell-activated",fn:function(s){return t("q-td",{attrs:{props:s}},["admin"!=s.row.role?t("q-toggle",{attrs:{color:"teal-8"},on:{input:function(t){e.activate(s.row)}},model:{value:s.row.activated,callback:function(t){e.$set(s.row,"activated",t)},expression:"props2.row.activated"}}):e._e()],1)}},{key:"body-cell-actions",fn:function(s){return t("q-td",{attrs:{props:s}},["admin"!=s.row.role?t("q-btn",{attrs:{icon:"edit",size:"sm",color:"secondary",label:"edit"},on:{click:function(t){e.editUser(s.row)}}}):e._e(),"admin"!=s.row.role?t("q-btn",{attrs:{color:"negative",size:"sm",label:"remove",icon:"delete"},on:{click:function(t){e.removeUser(s)}}}):e._e()],1)}}])})],1),t("q-page-sticky",{attrs:{position:"bottom-right",offset:[60,18]}},[t("q-btn",{attrs:{round:"",size:"lg",color:"primary",icon:"perm_identity"},on:{click:function(s){e.newUserModal=!0}}})],1),t("q-modal",{attrs:{"content-css":{maxWidth:"50vw",maxHeight:"95vh"}},on:{hide:e.clearUserModal},model:{value:e.newUserModal,callback:function(s){e.newUserModal=s},expression:"newUserModal"}},[t("q-modal-layout",{attrs:{"content-style":"{fontSize: '20px', fontWeight: 'bold'}","content-class":"bg-white"}},[t("q-toolbar",{attrs:{slot:"header"},slot:"header"},[t("q-toolbar-title",[e._v("\n\t\t\t\t\t\t\t"+e._s(e.isEdit?"Edit User":"Add New User")+"\n\t\t\t\t\t\t")])],1),t("div",{staticClass:"q-pa-md q-pa-xm"},[t("q-input",{staticClass:"q-my-md",attrs:{"stack-label":"First Name"},model:{value:e.newUser.firstName,callback:function(s){e.$set(e.newUser,"firstName",s)},expression:"newUser.firstName"}}),t("q-input",{staticClass:"q-my-md",attrs:{"stack-label":"Last Name"},model:{value:e.newUser.lastName,callback:function(s){e.$set(e.newUser,"lastName",s)},expression:"newUser.lastName"}}),t("q-select",{staticClass:"fields",attrs:{"float-label":"Role",radio:"",options:e.roleOptions},model:{value:e.newUser.role,callback:function(s){e.$set(e.newUser,"role",s)},expression:"newUser.role"}}),t("q-input",{staticClass:"q-my-md",attrs:{disable:e.isEdit,type:"email","stack-label":"Username"},model:{value:e.newUser.username,callback:function(s){e.$set(e.newUser,"username",s)},expression:"newUser.username"}}),t("q-input",{directives:[{name:"show",rawName:"v-show",value:!e.isEdit,expression:"!isEdit"}],staticClass:"q-my-md",attrs:{type:"password","stack-label":"Password"},model:{value:e.newUser.password,callback:function(s){e.$set(e.newUser,"password",s)},expression:"newUser.password"}}),t("q-input",{directives:[{name:"show",rawName:"v-show",value:!e.isEdit,expression:"!isEdit"}],staticClass:"q-my-md",attrs:{type:"password","stack-label":"Confirm Password"},model:{value:e.confirmPassword,callback:function(s){e.confirmPassword=s},expression:"confirmPassword"}}),t("q-field",{attrs:{label:"User Access",helper:"Select User accessibility",icon:"accessibility"}},[t("q-checkbox",{staticClass:"q-ma-md",attrs:{label:"Walk in"},model:{value:e.newUser.userAccess.walkin,callback:function(s){e.$set(e.newUser.userAccess,"walkin",s)},expression:"newUser.userAccess.walkin"}}),t("q-checkbox",{staticClass:"q-ma-md",attrs:{label:"Events"},model:{value:e.newUser.userAccess.events,callback:function(s){e.$set(e.newUser.userAccess,"events",s)},expression:"newUser.userAccess.events"}}),t("q-checkbox",{staticClass:"q-ma-md",attrs:{label:"Attendance"},model:{value:e.newUser.userAccess.attendance,callback:function(s){e.$set(e.newUser.userAccess,"attendance",s)},expression:"newUser.userAccess.attendance"}}),t("q-checkbox",{staticClass:"q-ma-md",attrs:{label:"Contract Signed"},model:{value:e.newUser.userAccess.contractSigned,callback:function(s){e.$set(e.newUser.userAccess,"contractSigned",s)},expression:"newUser.userAccess.contractSigned"}}),t("q-checkbox",{staticClass:"q-ma-md",attrs:{label:"Reschedule"},model:{value:e.newUser.userAccess.resched,callback:function(s){e.$set(e.newUser.userAccess,"resched",s)},expression:"newUser.userAccess.resched"}}),t("q-checkbox",{staticClass:"q-ma-md",attrs:{label:"Models"},model:{value:e.newUser.userAccess.models,callback:function(s){e.$set(e.newUser.userAccess,"models",s)},expression:"newUser.userAccess.models"}}),t("q-checkbox",{staticClass:"q-ma-md",attrs:{label:"All Schedules"},model:{value:e.newUser.userAccess.allSchedule,callback:function(s){e.$set(e.newUser.userAccess,"allSchedule",s)},expression:"newUser.userAccess.allSchedule"}}),t("q-checkbox",{staticClass:"q-ma-md",attrs:{label:"Payment Records"},model:{value:e.newUser.userAccess.paymentRecords,callback:function(s){e.$set(e.newUser.userAccess,"paymentRecords",s)},expression:"newUser.userAccess.paymentRecords"}}),t("q-checkbox",{staticClass:"q-ma-md",attrs:{label:"SMS Notifier"},model:{value:e.newUser.userAccess.smsNotifier,callback:function(s){e.$set(e.newUser.userAccess,"smsNotifier",s)},expression:"newUser.userAccess.smsNotifier"}}),t("q-checkbox",{staticClass:"q-ma-md",attrs:{label:"Reports"},model:{value:e.newUser.userAccess.reports,callback:function(s){e.$set(e.newUser.userAccess,"reports",s)},expression:"newUser.userAccess.reports"}}),t("q-checkbox",{staticClass:"q-ma-md",attrs:{label:"Model Showcasing"},model:{value:e.newUser.userAccess.showcasing,callback:function(s){e.$set(e.newUser.userAccess,"showcasing",s)},expression:"newUser.userAccess.showcasing"}}),t("q-checkbox",{staticClass:"q-ma-md",attrs:{label:"Messages"},model:{value:e.newUser.userAccess.messages,callback:function(s){e.$set(e.newUser.userAccess,"messages",s)},expression:"newUser.userAccess.messages"}}),t("q-checkbox",{staticClass:"q-ma-md",attrs:{label:"Settings"},model:{value:e.newUser.userAccess.settings,callback:function(s){e.$set(e.newUser.userAccess,"settings",s)},expression:"newUser.userAccess.settings"}})],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[e.isEdit?e._e():t("q-btn",{staticClass:"full-width textbox",attrs:{color:"primary",label:"Save"},on:{click:e.addNewUser}}),e.isEdit?t("q-btn",{staticClass:"full-width",attrs:{color:"info",label:"Update"},on:{click:e.updateUser}}):e._e()],1),t("q-inner-loading",{attrs:{visible:e.loading}},[t("q-spinner-gears",{attrs:{size:"50px",color:"primary"}})],1)],1)],1),t("q-page-container",[t("router-view")],1)],1)},n=[],r=t("MVZn"),o=t.n(r),c=(t("91GP"),t("rGqo"),t("yt8O"),t("RW0V"),{mounted:function(){this.$bindAsArray("users",this.$database.ref("users"))},computed:{getUsers:function(){try{var e=this.$lodash.filter(this.users,function(e){return!e.deletedAccount&&"admin"!==e.role});return e}catch(e){return[]}},getActivated:{get:function(){}}},data:function(){return{users:[],newUserModal:!1,newUser:{firstName:"",lastName:"",role:"",username:"",email:"",password:"",activated:!1,userAccess:{walkin:!1,showcasing:!1,events:!1,attendance:!1,contractSigned:!1,resched:!1,models:!1,allSchedule:!1,paymentRecords:!1,smsNotifier:!1,reports:!1,messages:!1,settings:!1}},roleOptions:[{label:"Secretary",value:"secretary"},{label:"Staff",value:"staff"}],confirmPassword:"",isEdit:!1,filter:"",loading:!1,tableLoading:!1,columns:[{name:"lastName",required:!0,label:"Last Name",align:"center",field:"lastName",sortable:!1},{name:"firstName",required:!0,label:"First Name",align:"center",field:"firstName",sortable:!1},{name:"email",required:!0,label:"Username",align:"center",field:"username",sortable:!1},{name:"role",required:!0,label:"Role",align:"center",field:"role",sortable:!1},{name:"userAccess",required:!0,label:"User Access",align:"left",sortable:!1},{name:"activated",required:!0,label:"Activated",align:"center",sortable:!1},{name:"actions",required:!0,label:"Actions",align:"center",field:"name",sortable:!1}],pagination:{sortBy:null,descending:!1,page:1,rowsPerPage:10}}},methods:{removeUser:function(e){var s=this;console.log("p",e);var t=e.row.lastName,a=e.row[".key"];this.$database.ref("users").child(a).remove().then(function(){s.$q.notify({message:"".concat(t," has been deleted"),type:"info",color:"info",textColor:"white",icon:"info"}),s.$forceUpdate()}).catch(function(e){s.$q.notify({message:"An error occur ".concat(e),type:"negative",color:"negative",textColor:"white",icon:"info"})})},activate:function(e){var s=this;console.log(e);var t=e[".key"],a=e.activated;this.$database.ref("users/".concat(t,"/activated")).set(a).then(function(){s.$q.notify({message:"".concat(e.lastName,a?" has been activated":" has been deactivated"),type:"positive",color:"positive",textColor:"white",icon:"info"})}).catch(function(e){s.$q.notify({message:"An error occured",type:"negative",color:"negative",textColor:"white",icon:"warning"}),console.log(e)})},listUserAccess:function(e){var s=Object.keys(e);return s},clearUserModal:function(){this.isEdit=!1,this.newUser.firstName="",this.newUser.lastName="",this.newUser.role="",this.newUser.username="",this.newUser.email="",this.newUser.password="",this.confirmPassword="",this.newUser.events=!1,this.newUser.attendance=!1,this.newUser.contractSigned=!1,this.newUser.resched=!1,this.newUser.models=!1,this.newUser.allSchedule=!1,this.newUser.paymentRecords=!1,this.newUser.smsNotifier=!1,this.newUser.reports=!1,this.newUser.portfolio=!1},addNewUser:function(){var e=this;this.$q.dialog({title:"Confirm",message:"Do you want to save user?",ok:"Save",cancel:"Cancel"}).then(function(){e.newUser.email=e.newUser.username+"@maleficent.com";var s=e.newUser,t=e;e.loading=!0,console.log("create data",s),t.$auth2.createUserWithEmailAndPassword(s.email,s.password).then(function(a){setTimeout(function(){var n=Object.assign({},a.user);console.log("user",n.uid),delete s["confirmPassword"],delete s["password"],t.$database.ref("users").child(n.uid).set(s).then(function(s){e.$q.notify({message:"User has been successfully added",type:"positive",color:"positive",textColor:"white",icon:"info"}),e.newUserModal=!1,e.loading=!1}).catch(function(s){e.$q.notify({message:"An error occured in adding to database".concat(s),type:"negative",color:"negative",textColor:"white",icon:"warning"}),e.loading=!1})},3e3)}).catch(function(s){console.log("error",s.message),e.$q.notify({title:"Error Occured",message:"".concat(s.message),type:"negative",color:"negative",textColor:"white",icon:"warning"}),e.loading=!1})}).catch(function(){})},editUser:function(e){var s=o()({},e);this.newUser=s,this.newUserModal=!0,this.isEdit=!0},updateUser:function(){var e=this;this.$q.dialog({title:"Confirm",message:"Do you want to update user?",ok:"Update",cancel:"Cancel"}).then(function(){}).catch(function(){});var s=o()({},this.newUser),t=s[".key"];delete s.__index,delete s[".key"],console.log("user",s),this.$database.ref("users/".concat(t)).update(s).then(function(){e.$q.notify({message:"".concat(s.lastName," has been updated"),type:"positive",color:"positive",textColor:"white",icon:"info"})}).catch(function(s){e.$q.notify({message:"An error occured",type:"negative",color:"negative",textColor:"white",icon:"warning"}),console.log(s)}),this.newUserModal=!1,this.isEdit=!1},test:function(){console.log("getUsers",this.getUsers)}}}),i=c,l=(t("UT7B"),t("KHd+")),d=Object(l["a"])(i,a,n,!1,null,null,null);s["default"]=d.exports},UT7B:function(e,s,t){"use strict";var a=t("x8Pq"),n=t.n(a);n.a},x8Pq:function(e,s,t){}}]);