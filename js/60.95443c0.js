(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[60],{IFPA:function(t,e,n){"use strict";var a=n("vG03"),i=n.n(a);i.a},vG03:function(t,e,n){},"yVH/":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("q-toolbar",{attrs:{color:"faded"}},[n("q-toolbar-title",[t._v("\r\n        Manage SMS Notifier")])],1),t.byBatchShow?n("div",{staticClass:"col-3 q-ma-md"},[n("q-table",{attrs:{title:"",data:t.ByBatchTableData,loading:t.tableLoading,columns:t.columns,pagination:t.pagination,separator:"cell","no-data-label":"Empty Activities","row-key":"id",filter:t.filter},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"top-right",fn:function(e){return[n("q-select",{staticClass:"text-white",staticStyle:{"min-width":"150px"},attrs:{inverted:"",color:"dark",options:t.mapActivities,"stack-label":"Activities"},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})]}},{key:"top-left",fn:function(e){return[n("h4",{staticClass:"q-mr-lg"},[t._v("Upcoming Schedule")]),n("q-toggle",{attrs:{label:"See All Schedules","checked-icon":"visibility","unchecked-icon":"visibility_off"},model:{value:t.seeAll,callback:function(e){t.seeAll=e},expression:"seeAll"}})]}},{key:"body-cell-activity",fn:function(e){return n("q-td",{attrs:{props:e}},[t._v("\r\n            "+t._s(e.row.upcomingAct)+"\r\n        ")])}},{key:"body-cell-date",fn:function(e){return n("q-td",{attrs:{props:e}},[t._v("\r\n            "+t._s(t.$moment(e.row.date).format("ll"))+"\r\n            ")])}},{key:"body-cell-time",fn:function(e){return n("q-td",{attrs:{props:e}},[t._v("\r\n            "+t._s(t.$moment(e.row.forSort).format("LT"))+"\r\n            ")])}},{key:"body-cell-action",fn:function(e){return n("q-td",{attrs:{props:e}},[n("q-btn",{attrs:{color:"primary","icon-right":"mail_outline",to:{name:"SMSList",params:{id:e.row.key,title:e.row.id,type:e.row.upcomingAct}}}},[t._v("\r\n              Manage SMS\r\n            ")])],1)}}])})],1):t._e(),t.fullDayShow?n("div",{staticClass:"col-3 q-ma-md"},[n("q-table",{attrs:{data:t.getFullDayTableData,loading:t.tableLoading,columns:t.fullDayColumns,pagination:t.pagination,separator:"cell","no-data-label":"Empty Activities","row-key":".key",filter:t.filter},on:{"update:pagination":function(e){t.pagination=e}},scopedSlots:t._u([{key:"top-right",fn:function(e){return[n("q-select",{staticClass:"text-white",staticStyle:{"min-width":"150px"},attrs:{inverted:"",color:"dark",options:t.mapActivities,"stack-label":"Activities"},model:{value:t.filter,callback:function(e){t.filter=e},expression:"filter"}})]}},{key:"top-left",fn:function(e){return[n("h4",{staticClass:"q-mr-lg"},[t._v("Upcoming Schedule"),n("span",{staticClass:"text-secondary text-weight-bold"},[t._v(" Day View")])]),n("q-toggle",{attrs:{label:"See All Schedules","checked-icon":"visibility","unchecked-icon":"visibility_off"},model:{value:t.seeAllFullDay,callback:function(e){t.seeAllFullDay=e},expression:"seeAllFullDay"}})]}},{key:"body-cell-date",fn:function(e){return n("q-td",{attrs:{props:e}},[t._v("\r\n            "+t._s(t.$moment(e.row.date).format("ll"))+"\r\n            ")])}},{key:"body-cell-batches",fn:function(e){return n("q-td",{attrs:{props:e}},t._l(e.row.batchTitles,function(e){return n("q-list",{key:e,staticClass:"no-border",attrs:{dense:""}},[n("q-item",{staticClass:"q-caption align-center"},[t._v(t._s(e))])],1)}))}},{key:"body-cell-action",fn:function(e){return n("q-td",{attrs:{props:e}},[n("q-btn",{attrs:{color:"primary",icon:"mail_outline",to:{name:"SMSListFullDay",params:{id:e.row.routerParam,date:e.row.date,type:e.row.type}}}},[t._v("\r\n              Manage SMS\r\n            ")])],1)}}])})],1):t._e()],1)},i=[],r=n("J4zp"),l=n.n(r),s=(n("f3/d"),n("dRSK"),n("Vd3H"),n("KKXr"),n("rGqo"),n("RIqP")),o=n.n(s),c={mounted:function(){this.$bindAsArray("event_schedules",this.$database.ref("event_schedules")),this.$bindAsArray("model_list",this.$database.ref("models")),this.$bindAsArray("events",this.$database.ref("events")),this.$bindAsArray("courses",this.$database.ref("settings/courses")),this.$bindAsArray("attendance",this.$database.ref("attendance")),this.$bindAsArray("batch",this.$database.ref("event_schedules")),this.$store.state.schedules.allActivities=this.event_schedules},computed:{getActivities:function(){var t=this,e=new Array,n=o()(this.event_schedules);return this.$lodash.forEach(n,function(n){t.$lodash.forEach(n.activities,function(t){t.batchKey=n[".key"],e.push(t)})}),e},getEvents:function(){return this.events},getStartDate:function(t){new Date(t.row.startDate)},mapActivities:function(){for(var t=this,e=this.$lodash.filter(this.courses,function(t){return t}),n=[],a=0;a<e.length;a++)for(var i=e[a].activities,r=0;r<i.length;r++){var l=i[r].label;n.push(l)}var s=this.$lodash.uniq(n),o=this.$lodash.map(s,function(e){return{label:e,value:t.$lodash.lowerCase(e)}}),c=[],u={label:"All",value:""};c.push(u);for(var h=0;h<o.length;h++){var d=o[h];c.push(d)}return this.filter="",this.mapEventActivities,c},mapEventActivities:function(){return console.log("getActivities",this.getActivities),this.getActivities},getMapActivities:function(){var t=this,e=this.$lodash.map(this.event_schedules,function(e){return{key:e[".key"],eventName:e.eventName,seasonName:e.seasonName,batchNumber:e.batchNumber,id:t.upcomingActivity(e.activities).id,upcomingAct:t.upcomingActivity(e.activities).type,date:t.$moment(t.upcomingActivity(e.activities).startDate).format("ll"),forSort:new Date(t.upcomingActivity(e.activities).startDate),time:t.$moment(t.upcomingActivity(e.activities).startDate).format("LT")}});return console.log("reconst",e),e},getAllAttendance:function(){try{var t=this.getActivities;console.log("getAllAttendance"),console.log(t);var e=this.OpenSeasonOnly;console.log(e),console.log(this.batch);for(var n=this.batch,a=[],i=[],r=0;r<n.length;r++)for(var l=0;l<e.length;l++)n[r].seasonName===e[l].seasonName?a.push(n[r]):i.push(n[r]);for(var s=[],o=[],c=0;c<t.length;c++)for(var u=0;u<a.length;u++)if(t[c].batchKey===a[u][".key"]){var h={key:a[u][".key"],upcomingAct:t[c].type,forSort:new Date(t[c].startDate),eventName:a[u].eventName,seasonName:a[u].seasonName,batchNumber:a[u].batchNumber,id:t[c].id,date:this.$moment(t[c].startDate).format("ll"),time:this.$moment(t[c].startDate).format("LT")};s.push(h)}else o.push(t[c]);console.log(s);var d=this.$lodash.orderBy(s,"forSort","asc");return console.log("getAllAttendance",d),d}catch(t){return console.log("err",t),[]}},getFilteredActivities:function(){if(!0===this.seeAllFullDay){var t=this.$lodash.groupBy(this.getAllAttendance,function(t){return t.date+t.upcomingAct}),e=this.$lodash.filter(t,function(t,e,n){return t[".key"]=e,n});return console.log("filteredUNIQ",e),e}var n=this.$lodash.groupBy(this.FilterActivitiesOpenSeason,function(t){return t.date+t.upcomingAct}),a=this.$lodash.filter(n,function(t,e,n){return t[".key"]=e,n});return a},getFullDayTableData:function(){for(var t=[],e=0;e<this.getFilteredActivities.length;e++){var n=this.getFilteredActivities[e];t.push({date:this.getDateForTable(n),type:this.getTypeForTable(n),batchKeys:this.getBatchesPerDate(n),batchTitles:this.getBatchNameForTable(n),routerParam:this.getRouterLink(n),sortDate:this.getSortableDate(n)})}return t},OpenSeasonOnly:function(){try{for(var t=this.events,e=[],n=[],a=this.$lodash.filter(t,function(t){return t.seasons}),i=0;i<a.length;i++)for(var r=0;r<a[i].seasons.length;r++)"open"===a[i].seasons[r].status?e.push(a[i].seasons[r]):n.push(a[i].seasons[r]);return e}catch(t){return console.log(t),[]}},FilterActivitiesOpenSeason:function(){try{for(var t=this.getMapActivities,e=this.OpenSeasonOnly,n=[],a=[],i=0;i<t.length;i++)for(var r=0;r<e.length;r++)t[i].seasonName===e[r].seasonName?n.push(t[i]):a.push(t[i]);return n}catch(t){return console.log(t),[]}},ByBatchTableData:function(){try{var t=this.getAllAttendance,e=this.FilterActivitiesOpenSeason;return!0===this.seeAll?(console.log("all",t),t):(console.log("upcoming",e),e)}catch(t){return console.log("err",t),[]}},getModels:function(){try{var t=this.selectedAttendance.key,e=this.selectedAttendance.id,n=this.selectedAttendance.upcomingAct;if("orientation"!==n){this.$bindAsArray("attendanceList2",this.$database.ref("attendance/"+t+"/"+e+"/models"));var a=this.returnAttendanceList(t,e);return console.log("activity models",a),this.attendanceList2}var i=this.$lodash.filter(this.model_list,function(e){return e.batchKey===t});return console.log("modellist",i),i}catch(t){return[]}}},data:function(){return{attendanceList2:[],RowsPage:[0],selectedAttendance:{},selectedFull:{},showPrintModal:!1,showFullPrintModal:!1,seeAll:!1,seeAllFullDay:!1,fullDayShow:!1,byBatchShow:!0,filter:"",activities:[],selectActivity:"",events:[],event_schedules:[],model_list:[],tableLoading:!1,columns:[{name:"eventName",required:!0,label:"Event Name",align:"left",field:"eventName",sortable:!0},{name:"season",required:!0,label:"Season",align:"left",field:"seasonName",sortable:!0},{name:"batch",required:!0,label:"Batch",align:"left",field:"batchNumber",sortable:!0},{name:"activity",required:!0,label:"Upcoming Activity",align:"left",sortable:!0,field:"upcomingAct"},{name:"date",required:!0,label:"Date",align:"left",sortable:!0,field:"forSort"},{name:"time",required:!0,label:"Time",align:"left",sortable:!0,field:"forSort"},{name:"action",required:!0,label:"Action",align:"center",sortable:!0}],fullDayColumns:[{name:"date",required:!0,label:"Date",align:"left",sortable:!0,field:"sortDate"},{name:"type",required:!0,label:"Activity Type",align:"left",sortable:!0,field:"type"},{name:"batches",required:!0,label:"Batches",align:"left"},{name:"action",required:!0,label:"Action",align:"center",sortable:!0}],eventOpt:[{label:"test",value:"test"}],Modelcolumns:[{name:"fullname",required:!0,label:"Full Name",align:"left"},{name:"signature",required:!0,label:"Signature",align:"left"}],ModelFullcolumns:[{name:"fullname",required:!0,label:"Full Name",align:"left"},{name:"event",required:!0,label:"Event",align:"left"},{name:"time",required:!0,label:"Time",align:"left"},{name:"signature",required:!0,label:"Signature",align:"left"}],pagination:{sortBy:null,descending:!1,page:1,rowsPerPage:10},Modelpagination:{sortBy:null,descending:!1,page:1,rowsPerPage:0}}},methods:{getBatchesPerDate:function(t){for(var e=t,n=[],a=0;a<e.length;a++){var i=e[a].key;n.push(i)}var r=this.$lodash.join(n,"$"),l=this.$lodash.split(r,"$");return l},getRouterLink:function(t){for(var e=t,n=[],a=0;a<e.length;a++){var i=e[a].key;n.push(i)}var r=this.$lodash.join(n,"$");this.$lodash.split(r,"$");return r},getBatchNameForTable:function(t){for(var e=t,n=[],a=0;a<e.length;a++){var i=e[a].id,r=e[a].seasonName,l=this.$moment(e[a].forSort).format("LT"),s=this.$lodash.join([r,i,l]," / ");n.push(s)}var o=this.$lodash.join(n,"$"),c=this.$lodash.split(o,"$");return c},getDateForTable:function(t){var e=t[0].date;return e},getSortableDate:function(t){var e=t[0].forSort;return e},getTypeForTable:function(t){var e=t[0].upcomingAct;return e},showByBatch:function(){this.fullDayShow=!1,this.byBatchShow=!0},showFullDay:function(){this.fullDayShow=!0,this.byBatchShow=!1},upcomingActivity:function(t){for(var e=t,n=new Date,a=[],i=0;i<e.length;i++){var r=this.$mathMixin.dayDiff(n,new Date(e[i].startDate));r>=0&&"payment"!=e[i].type&&a.push(e[i])}var l=a.sort(function(t,e){var n=new Date(t.startDate),a=new Date(e.startDate);return n-a});return l[0]},showSeason:function(t){console.log("show season",t)},getTitle:function(t){var e=t.row.activities;this.$lodash.map(e,function(t){return t.title})},mySort:function(t,e,n){var a=this.computedCols.find(function(t){return t.name===e});if(null===a||void 0===a.field)return t;var i=n?-1:1,r="function"===typeof a.field?function(t){return a.field(t)}:function(t){return t[a.field]};return t.sort(function(t,e){var n=r(t),s=r(e);if(null===n||void 0===n)return-1*i;if(null===s||void 0===s)return 1*i;if(a.sort)return a.sort(n,s)*i;if(isNumber(n)&&isNumber(s))return(n-s)*i;if(isDate(n)&&isDate(s))return sortDate(n,s)*i;if("boolean"===typeof n&&"boolean"===typeof s)return(t-e)*i;var o=[n,s].map(function(t){return(t+"").toLowerCase()}),c=l()(o,2);return n=c[0],s=c[1],n<s?-1*i:n===s?0:i})},selectedAttendancePrint:function(t){this.selectedAttendance=t,console.log("for print",t),this.showPrintModal=!0},printPdf:function(){window.print()},selectedFullAttendancePrint:function(t){this.selectedFull=t,console.log("for print",t),this.showFullPrintModal=!0},returnBatchActivity:function(t){var e=[];this.$lodash.forEach(this.event_schedules,function(n){n[".key"]===t&&e.push(n)});var n=[];return this.$lodash.forEach(e,function(t){n.push(t.activities)}),console.log("found",e),console.log("activities",n),n[0]},returnAttendanceList:function(t,e){var n=[];this.$lodash.forEach(this.attendance,function(e){e[".key"]===t&&n.push(e)});var a=n[e].models;return console.log("keyfound",a),a}}},u=c,h=(n("IFPA"),n("KHd+")),d=Object(h["a"])(u,a,i,!1,null,null,null);e["default"]=d.exports}}]);